(function(a,b){function c(a){return")]}'\n"==a.slice(0,5)?b.parseJSON(a.substring(5)):a}window.version_mismatch_has_occurred=!0;a.version=function(){return version};a.cacheVersion=function(){return cacheVersion};a.getHashConvertedUrl=function(a){var b=window.location.pathname;window.location.hash&&(b+="/"+window.location.hash.slice(1));a&&(a=window.location.search,a=a.replace(/([?&])mp-r-id=[^&]*&?/,"$1").replace(/&$/,""),"?"==a&&(a=""),b+=a);return b};a.fetchTemplates=function(a,c){b.ajax({dataType:"html",
type:"GET",url:a,success:function(a){b("head").append(a);b('script[type="text/x-handlebars"]').each(function(a,d){d=b(d);Ember.TEMPLATES[d.attr("data-template-name")]=Ember.Handlebars.compile(d.html());d.remove()});c&&c()},error:function(){alert("Request for template file "+a+" failed.")}})};a.ajaxREST=function(a,e,f,g){(new Date).getTime();request_seq=a.split(" ");method=request_seq[0];path=request_seq[1];headers={};headers["X-XSRF-Token"]=document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2];
a={type:method,dataType:"text",url:"/api"+path,headers:headers,dataFilter:c,success:function(a,b,d){f&&f(a,d)},error:function(a,b,d){if(g)g(c(a.responseText,"text"),a);else{if(!d||"OK"==d)d=c(a.responseText,"text").error;alert(""+b+" "+a.status+": "+d)}}};b.isEmptyObject(e)||b.extend(a,{contentType:"GET"==method?"application/x-www-form-urlencoded":"application/json; charset=utf-8",data:"GET"==method?{json:JSON.stringify(e)}:JSON.stringify(e),cache:!e.fresh});b.ajax(a)};a.pushTrackingEvent=function(a,
b,c,g){a=["_trackEvent",a,b];void 0!==c&&a.push(c);void 0!==g&&a.push(g);_gaq&&_gaq.push(a)};a.getScriptCached=function(a,c){return b.ajax({dataType:"script",cache:!0,url:a,success:c})};a.getUrlQueryParams=function(){var a={},c=window.location.search;c&&b.each(c.substr(1).split("&"),function(b,c){var e=c.split("=");a[e[0].toString()]=e[1].toString()});return a};a.getDecodedURIComponent=function(b){return(b=a.getUrlQueryParams()[b])?decodeURIComponent(b):b}})(window.UY=window.UY||{},jQuery);angular.module("udacity.core",["services","controllers","directives","filters","meta"]);angular.module("services","services.utility services.reviews services.blogFeed services.forum services.user services.auth services.content services.dummyData".split(" "));angular.module("controllers",["controllers.courseCatalog","controllers.lesson","controllers.reviews","controllers.editor","controllers.myCourses"]);
angular.module("directives",["directives.user","directives.utility","directives.reviews","directives.forum","directives.myCourses"]);angular.module("filters",["filters.dates"]);angular.module("meta",["meta.configuration"]);angular.module("services.lesson",[]);angular.module("directives.lesson",[]);angular.module("controllers.lesson",[]);angular.module("controllers.settings",[]);angular.module("directives.location",[]);angular.module("controllers.courseCatalog",[]);
angular.module("controllers.myCourses",[]);angular.module("directives.myCourses",[]);angular.module("services.utility",[]);angular.module("directives.utility",[]);angular.module("directives.reviews",[]);angular.module("services.reviews",[]);angular.module("controllers.reviews",[]);angular.module("services.blogFeed",[]);angular.module("directives.forum",[]);angular.module("services.forum",[]);angular.module("filters.dates",[]);angular.module("services.editor",[]);
angular.module("directives.editor",[]);angular.module("controllers.editor",[]);angular.module("meta.configuration",[]);angular.module("services.content",[]);angular.module("services.user",[]);angular.module("directives.user",[]);angular.module("services.auth",[]);angular.module("services.dummyData",[]);angular.module("youtube",[]);angular.module("udacity",["udacity.core"]);angular.module("udacity.viewer",["udacity.core","youtube","services.lesson","directives.lesson","controllers.lesson"]);
angular.module("udacity.overview",["udacity.core","youtube"]);angular.module("udacity.courseCatalog",["udacity.core"]);angular.module("udacity.editor",["udacity.core","services.editor","directives.editor","controllers.editor"]);angular.module("udacity.settings",["udacity.core","controllers.settings","directives.location"]);angular.module("udacity.core").config(["$locationProvider",function(a){a.html5Mode(!1);a.hashPrefix("!")}]);angular.module("filters.dates").filter("dateRelative",["$filter",function(a){return function(b){var c=((new Date).getTime()-b)/1E3;return 60>c?"just now":3600>c?""+Math.floor(c/60)+"m ago":86400>c?""+Math.floor(c/3600)+"h ago":691200>c?""+Math.floor(c/86400)+"d ago":isNaN(b)?"not available":a("date")(b,"MMM d")}}]).filter("stringDate",["$filter",function(){var a=function(a){if(!a)return a;var c=a.lastIndexOf(".");if(-1===c)return a;var d=c+7;if(d>a.length)return a;for(var e=c+1;e<d;++e)if("0">a[e]||
"9"<a[e])return a;return a.substring(0,c)+a.substring(d,a.length)};return function(b){return Date.parse(a(b))}}]);angular.module("filters").filter("imageCropSize",["$filter",function(){return function(a,b){if(a)return a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)?a=a.replace(/\=s\d+(-c)?/,"=s"+b+"-c"):a.match(/\/\/robohash\.org\//)&&(a=a+"?size="+b+"x"+b),a}}]).filter("imageSize",["$filter",function(){return function(a,b,c){c=0===c?void 0:c;b=0===b?void 0:b;if("number"!==typeof b&&"number"!==typeof c)return a;var d=Math.max(c,b)||c||b;if(a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)){var e=
/#[\w=_\-&]*w=(\d+)&h=(\d+)/.exec(a);e&&(d=1*e[1],e=1*e[2],b=Math.min(c/e,b/d)||c/e||b/d,b=[d*b,e*b],a=a.replace(/\=s\d+(-c)?/,"=s"+Math.round(Math.max(b[0],b[1]))))}else a.match(/\/\/robohash\.org\//)&&d&&(a=a+"?size="+d+"x"+d);return a}}]);angular.module("directives.lesson").directive("cacheBuster",["codeMirror","executor",function(a,b){return{restrict:"A",link:function(c){c.bustCache=!0;c.toggleCacheBusting=function(){c.bustCache=!c.bustCache};c.submitCode=function(){var d=a.getContents(),e=a.getActiveLanguage();c.bustCache&&("cuda"===e||"c"===e)?d+="\n/* cache busting: "+(new Date).getTime()+" */":c.bustCache&&"python"===e&&(d+="\n''' cache busting: "+(new Date).getTime()+" '''");b.submitCode(d,a.getActiveLanguage())}}}}]);angular.module("directives.user").directive("signUp",["user","auth","validator",function(a,b,c){return{restrict:"A",controller:["$scope",function(){}],link:function(d){d.signUp=b.signUserUp;d.isLoggedIn=a.userIsLoggedIn;d.user=a.getUser;d.firstName="";d.lastName="";d.email="";d.password="";d.passwordConfirm="";d.acceptTos=!1;d.signUpErrors=[];d.signUpErrorFields=[];d.signUp=function(a,f,g,h,j,l,k){d.buttonDisabled=!0;d.signUpErrors=[];d.signUpErrorFields=[];var m={firstName:{pretty:"first name",value:a,
validators:[{type:"required"}]},lastName:{pretty:"last name",value:f,validators:[{type:"required"}]},email:{pretty:"email address",value:g,validators:[{type:"required",chained:[{type:"email"}]}]},acceptTos:{pretty:"terms of service (TOS)",value:l,validators:[{type:"required"}]}};k&&(m.password={pretty:"password",value:h,validators:[{type:"required",chained:[{type:"strLen",args:[6,void 0]}]}]},m.passwordConfirm={pretty:"confirmed password",value:j,validators:[{type:"required",chained:[{type:"equal",
args:[h,"password"]}]}]});k=c.check(m);if(k.valid)if(b.getGoogleTokenCode())UYSocial.getGoogleToken(!0,function(d){b.signUserUp(a,f,g,null,null,null,d.code,l)});else{var n=b.getFacebookSignedRequest();b.signUserUp(a,f,g,h,j,n,null,l)}else{h=[];for(n in k.errorText)k.errorText.hasOwnProperty(n)&&(d.signUpErrorFields.push(n),h=h.concat(k.errorText[n]));d.signUpErrors=h;d.buttonDisabled=!1}};d.signUpFacebook=function(){UYSocial.getFacebookAuthResponse(function(a){b.logUserInSocial(a.signedRequest,null,
function(){b.socialAccountNotFoundRedirect(a.signedRequest,null,"signup")})})};d.signUpGoogle=function(){UYSocial.getGoogleToken(!1,function(a){b.logUserInSocial(null,a.code,function(){b.socialAccountNotFoundRedirect(null,a.code,"signup")})})};b.getFacebookSignedRequest()&&UYSocial.getFacebookMeResponse(function(a){d.email||(d.email=a.email);d.firstName||(d.firstName=a.first_name);d.lastName||(d.lastName=a.last_name);d.acceptTos=!0;d.$apply()});b.getGoogleTokenCode()&&UYSocial.getGoogleMeResponse(function(a){d.email||
(d.email=a.email);d.firstName||(d.firstName=a.given_name);d.lastName||(d.lastName=a.family_name);d.$apply()});b.addEventListener("signUp",function(){d.signUpErrors=[]});b.addEventListener("signUpSuccess",function(){b.loggedInAction()});b.addEventListener("signUpFailure",function(a){console.warn(a);d.signUpErrors=-1!==a.data.error.search(/address_lower already registered/)?["That email address is already registered at Udacity!"]:[a.data.error];d.buttonDisabled=!1})}}}]).directive("signIn",["user",
"auth","validator",function(a,b,c){return{restrict:"A",link:function(d,e){d.isLoggedIn=a.userIsLoggedIn;d.user=a.getUser;d.baseUser=a.getBaseUser;d.email="";d.password="";d.signIn=function(a,g){d.email||(a=e.find("#signInEmail").val());d.password||(g=e.find("#signInPass").val());d.buttonDisabled=!0;d.signInErrors=[];d.signInErrorFields=[];var h=c.check({email:{pretty:"email address",value:a,validators:[{type:"required",chained:[{type:"email"}]}]},password:{pretty:"password",value:g,validators:[{type:"required"}]}});
if(h.valid){var j=b.getFacebookSignedRequest();b.getGoogleTokenCode()?UYSocial.getGoogleToken(!0,function(d){b.logInAndConnect(a,g,j,d.code)}):b.logInAndConnect(a,g,j,null)}else{var l=[],k;for(k in h.errorText)h.errorText.hasOwnProperty(k)&&(d.signInErrorFields.push(k),l=l.concat(h.errorText[k]));d.signInErrors=l;d.buttonDisabled=!1}};d.signInFacebook=function(){UYSocial.getFacebookAuthResponse(function(a){b.logUserInSocial(a.signedRequest,null,function(){b.socialAccountNotFoundRedirect(a.signedRequest,
null,"signin")})})};d.signInGoogle=function(){UYSocial.getGoogleToken(!1,function(a){b.logUserInSocial(null,a.code,function(){b.socialAccountNotFoundRedirect(null,a.code,"signin")})})};b.addEventListener("logIn",function(){d.signUpErrors=[]});b.addEventListener("logInSuccess",function(){b.loggedInAction()});b.addEventListener("logInFailure",function(a){switch(a.status){case 403:d.signInErrors=["We couldn't find that user, or the password you entered was incorrect."];break;case 400:d.signInErrors=
[a.data.error];break;case 500:d.signInErrors=["Oh man, that's probably our bad. The server returned a 500 error! Try logging in again. If this doesn't work, please report this in the tech support forum."];break;default:d.signInErrors=["Oh dear. The server returned an unidentified error. Try logging in again and if it doesn't work, report this failure in the forum."]}d.buttonDisabled=!1})}}}]).directive("userMenu",["user","auth",function(a,b){return{restrict:"A",controller:["$scope",function(){}],
link:function(c){c.isLoggedIn=a.userIsLoggedIn;c.user=a.getUser;c.logOut=b.logUserOut;b.addEventListener("logOutSuccess",function(){window.location.href="/"})}}}]).directive("switchEnrollment",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!1;b.getActionText=function(){return a.isEnrolledIn(b.courseKey)?"Leave Class":"Join Class"}}],link:function(b,c){c.on("click",function(){b.disabled=!0;b.$apply();a.addEventListener("changeEnrollmentComplete",
function(){b.disabled=!1},{removeAfterFired:!0});a.userIsLoggedIn()?a.changeEnrollment(b.courseKey,!a.isEnrolledIn(b.courseKey)):window.location="/account/signin?next="+encodeURIComponent(window.location)})}}}]).directive("enrollResume",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!0;b.actionText="Loading...";a.addEventListener("userSet",function(){b.disabled=!1;b.actionText=a.isEnrolledIn(b.courseKey)?"Resume the Class":"Take the Class"},
{replayLast:!0})}],link:function(b,c){c.on("click",function(){b.disabled=!0;b.$apply();var d="/course/viewer#!/c-"+b.courseKey;a.userIsLoggedIn()?a.isEnrolledIn(b.courseKey)?window.location=d:(a.addEventListener("changeEnrollmentComplete",function(a){"enroll"===a.action&&(window.location=d)}),a.changeEnrollment(b.courseKey,!a.isEnrolledIn(b.courseKey))):window.location.href="/account/signin?"+$.param({next:d,enroll:b.courseKey})})}}}]).directive("switchCourseEmailSubscription",["user",function(a){return{restrict:"A",
scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!1;b.show=function(){return a.isEnrolledIn(b.courseKey)};b.getActionText=function(){return a.isCourseEmailSubscribed(b.courseKey)?"Unsubscribe from course emails":"Subscribe to course emails"}}],link:function(b,c){c.on("click",function(){b.disabled=!0;b.$apply();a.addEventListener("changeEnrollmentSettingsComplete",function(){b.disabled=!1});a.changeEnrollmentSettings(b.courseKey,{email_ok:!a.isCourseEmailSubscribed(b.courseKey)})})}}}]).directive("requestPasswordReset",
["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(c){c.email="";c.requestPasswordReset=function(d){c.buttonDisabled=!0;c.submitErrors=[];c.submitErrorFields=[];var e=b.check({email:{pretty:"email address",value:d,validators:[{type:"required",chained:[{type:"email"}]}]}});if(e.valid)a.requestPasswordReset(d);else{var d=[],f;for(f in e.errorText)e.errorText.hasOwnProperty(f)&&(c.submitErrorFields.push(f),d=d.concat(e.errorText[f]));c.submitErrors=
d;c.buttonDisabled=!1}};a.addEventListener("requestPasswordResetSuccess",function(){c.submitErrors=[];c.submitSuccess=!0});a.addEventListener("requestPasswordResetFailure",function(a){c.submitErrors=[a.data.error];c.buttonDisabled=!1})}}}]).directive("requestUnsubscribe",["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(c){c.email="";c.requestUnsubscribe=function(d){c.buttonDisabled=!0;c.submitErrors=[];c.submitErrorFields=[];var e=b.check({email:{pretty:"email address",
value:d,validators:[{type:"required",chained:[{type:"email"}]}]}});if(e.valid)a.requestUnsubscribe(d);else{var d=[],f;for(f in e.errorText)e.errorText.hasOwnProperty(f)&&(c.submitErrorFields.push(f),d=d.concat(e.errorText[f]));c.submitErrors=d;c.buttonDisabled=!1}};a.addEventListener("requestUnsubscribeSuccess",function(){c.submitErrors=[];c.submitSuccess=!0});a.addEventListener("requestUnsubscribeFailure",function(a){c.submitErrors=[a.data.error];c.buttonDisabled=!1})}}}]).directive("enrollUnreleasedCourse",
["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!0;b.actionText="Loading...";a.addEventListener("userSet",function(){b.disabled=!1;b.actionText=a.isEnrolledIn(b.courseKey)?"Go to My Courses":"Add to My Courses"})}],link:function(b,c){c.on("click",function(){b.disabled=!0;b.$apply();a.userIsLoggedIn()?a.isEnrolledIn(b.courseKey)?window.location="/my_courses":(a.addEventListener("changeEnrollmentComplete",function(a){"enroll"===a.action&&
(window.location="/my_courses#!/?newclass=true")}),a.changeEnrollment(b.courseKey,!a.isEnrolledIn(b.courseKey))):window.location.href="/account/signin?"+$.param({next:"/my_courses",enroll:b.courseKey})})}}}]).directive("resetPassword",["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(c){c.resetPassword=function(d,e,f,g){c.buttonDisabled=!0;c.submitErrors=[];c.submitErrorFields=[];e=b.check({password:{pretty:"password",value:d,validators:[{type:"required",
chained:[{type:"strLen",args:[6,void 0]}]}]},passwordConfirm:{pretty:"confirmed password",value:e,validators:[{type:"required",chained:[{type:"equal",args:[d,"password"]}]}]}});if(e.valid)a.resetPassword(d,f,g);else{var d=[],h;for(h in e.errorText)e.errorText.hasOwnProperty(h)&&(c.submitErrorFields.push(h),d=d.concat(e.errorText[h]));c.submitErrors=d;c.buttonDisabled=!1}};a.addEventListener("resetPasswordSuccess",function(){c.submitErrors=[];c.submitSuccess=!0});a.addEventListener("resetPasswordFailure",
function(a){c.submitErrors=[a.data.error];c.buttonDisabled=!1})}}}]).directive("checkEnrollment",["user",function(a){return{restrict:"A",link:function(b,c,d){a.addEventListener("userSet",function(){b.userIsEnrolled=a.isEnrolledIn(d.courseId.replace(/'/g,""))})}}}]);angular.module("directives.lesson").directive("programmingQuizPlayer",["codeMirror","lesson","$routeParams","programmingQuiz",function(a,b,c,d){return{restrict:"A",link:function(c){d.addEventListener("ready",function(){c.loadingComplete()},{removeOnDestructionOf:c});a.addEventListener("attached",function(){b.addEventListener("morselChange",function(a){"ProgrammingQuiz"===a.model&&(c.loading=!0,a=$.extend({},a),d.init(a))},{replayLast:!0,removeOnDestructionOf:c})},{replayLast:!0,removeOnDestructionOf:c,
removeAfterFired:!0})}}}]);angular.module("directives.lesson").directive("playbackRateSelector",["youtubeVideoPlayer",function(a){return{restrict:"A",link:function(b){a.addEventListener("playbackRateChange",function(){b.$apply()},{replayLast:!0});a.addEventListener("ready",function(){b.playbackRates=a.getAvailablePlaybackRates().slice(1,-1);b.getCurrentPlayBackRate=function(){return a.getCurrentPlaybackRate()||1};b.setPlaybackRate=function(b){a.setPlaybackRate(b)};b.$apply()},{replayLast:!0})}}}]);angular.module("directives.lesson").directive("bsDropdownCloser",function(){return{restrict:"A",link:function(a,b){b.on("click",function(){$(b).closest(".dropdown").removeClass("open")})}}});angular.module("directives.lesson").directive("imageQuizPlayer",["lesson","$routeParams","imageQuiz",function(a,b,c){return{restrict:"A",link:function(b){c.addEventListener("ready",function(){b.loadingComplete(!0)},{removeOnDestructionOf:b});a.addEventListener("morselChange",function(a){"ImageFormQuiz"===a.model&&(a=$.extend({},a),b.progressLoaded=!1,c.setQuiz(a),b.getQuiz=c.getQuiz,b.answers=c.answers,b.radioGroupAnswers=c.radioGroupAnswers)},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.lesson").directive("examNanny",["examMode","$http","$timeout","$routeParams",function(a,b,c,d){return{restrict:"A",controller:["$scope",function(c){function f(){d.lessonKey&&b.get("/api/users/me/time_remaining?exam_key="+d.lessonKey).success(function(a){a=a.time_remaining;900>a&&(840<a&&!g)&&(alert("You have 15 minutes remaining."),g=!0);300>a&&(240<a&&!h)&&(alert("You have 5 minutes remaining."),h=!0);0>=a&&(alert("Time is up! You will now be directed to the home page."),
window.location.href="/")}).error(function(a){403===a.status?(alert("You do not have permission to view this exam! You will now be directed to the home page."),window.location.href="/"):404===a.status&&(alert("You are not registered for this exam. Redirecting to the registration page"),window.location.href="/proctored_exam")})}var g=!1,h=!1;a&&(setInterval(f,15E3),c.$on("$routeChangeSuccess",function(){f()}))}]}}]);angular.module("directives.lesson").directive("documentTitleUpdater",["lesson","$routeParams",function(a){return{restrict:"A",link:function(b){var c=null,d=null,e=null,f=function(){document.title=(c?c+" - ":"")+(d||"Untitled Lesson")+" - "+(e||"Untitled Course")+" - Udacity"};a.addEventListener("morselChange",function(a){c=a.title;f()},{replayLast:!0,removeOnDestructionOf:b}).addEventListener("courseChange",function(a){e=a.course.title;f()},{replayLast:!0,removeOnDestructionOf:b}).addEventListener("lessonChange",
function(a){d=a.lesson.title;f()},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.lesson").directive("examDoneButton",[function(){return{restrict:"A",link:function(a){a.leaveExam=function(){alert("Your exam is done. You will be redirected to the home page.");window.location.href="/"}}}}]);angular.module("directives.lesson").directive("quizWidget",function(){return{restrict:"A",link:function(a,b){var c=!0;a.$watch("widget",function(a,e){c&&e&&(b.css({top:100*e.placement.y+"%",left:100*e.placement.x+"%"}),"TextInputWidget"===e.model||"NumericInputWidget"===e.model?(b.width(100*e.placement.width+"%"),b.height(100*e.placement.height+"%")):"MathInputWidget"===e.model&&b.css({"min-width":100*e.placement.width+"%","min-height":100*e.placement.height+"%"}),c=!1)})}}});angular.module("directives.lesson").directive("sketchPlayer",["sketch","lesson","$routeParams",function(a,b){return{restrict:"A",link:function(c,d){var e,f=d.find("#slider"),g=null;e={start:function(){g||(g=setInterval(function(){f.slider("value",1E3*a.currentPosition())},100))},stop:function(){clearInterval(g);g=null}};b.addEventListener("pendingMorselChange",function(){a.pause();e.stop()},{removeOnDestructionOf:c});d.find("#slider").slider({animate:!0,stop:function(){e.stop();a.jumpPercent($("#slider").slider("value")/
1E3);e.start()},max:1E3,min:0,start:function(){e.stop()}});d.find("#dialog_link, ul#icons li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});a.addEventListener("ready",function(){a.play();e.start()},{replayLast:!0,removeOnDestructionOf:c});b.addEventListener("morselChange",function(b){b=$.extend({},b);if(b._strokes){var c={container:d.find("#canvasroom-container").get(0),backgroundCanvas:d.find("#canvasroom-background").get(0),canvas:d.find("#canvasroom").get(0),
audioEl:d.find("#canvasroom-audio").get(0)};a.attach(b,c)}else console.error("Passed invalid sketch data, ignoring")},{replayLast:!0,removeOnDestructionOf:c});c.restart=function(){a.pause();e.stop();a.jump(0)};c.play=function(){a.play();e.start()};c.pause=function(){a.pause();e.stop()}}}}]);angular.module("directives.lesson").directive("viewerErrorMessage",["lessonActivityTracker",function(a){return{restrict:"A",template:'<span data-ng-bind-html-unsafe="errorMessageText"></span><div class="dismiss"><a ng-click="errorMessageText = null">x</a></div>',controller:["$scope",function(b){b.errorMessageText=null;a.addEventListener("quizActivityLogFailure",function(a){console.log(a);a=_.reduce(a.context,function(a,b){return a+"/"+b.tag+b.node_key},"/course/viewer#!");b.errorMessageText='Oh no! We were unable to save the last submission, please resubmit again <a href="'+
a+'">here.</a>'})}]}}]);angular.module("directives.lesson").directive("iframeCommander",["iframeEvaluator","isTrustedDomain","lesson",function(a,b,c){return{restrict:"A",link:function(d,e){function f(){var a;window.location.origin||(a=window.location,a=a.protocol+"//"+a.hostname+(a.port?":"+a.port:""));return window.location.origin||a}d.isEmbeddingIframe=!1;var g=e.find(".output-iframe-container");a.addEventListener("newEvaluation",function(a){a=a.iframeUrl?a.iframeUrl:"/content/frame/grade?node=Node."+a.nodeId;g.empty();
g.append($("<iframe />",{src:a,"class":"output-iframe"}));d.isEmbeddingIframe=!0},{removeOnDestructionOf:d});a.addEventListener("postMessageRequest",function(a){if(b(f())){var c=a.iframeUrl?a.iframeUrl:f();g.find(".output-iframe").get(0).contentWindow.postMessage(JSON.stringify({parts:a.submission.parts,operation:a.submission.operation,messageType:"evaluate"}),c);d.isEmbeddingIframe=!0}},{removeOnDestructionOf:d});c.addEventListener("pendingMorselChange",function(){g.empty();d.isEmbeddingIframe=!1},
{removeOnDestructionOf:d})}}}]);angular.module("directives.lesson").directive("playerLoadingOverlay",function(){return{restrict:"A",template:'<div class="player-loading-overlay-message"><img src="/media/img/site/icons/udacity/quiz_loading.gif"></div>'}});angular.module("directives.lesson").directive("mathquillTextfield",["imageQuiz","libraryLoader",function(a,b){return{restrict:"A",link:function(c,d){b.loadLibraries(["mathquill"]).then(function(){d.mathquill("editable");d.focusout(function(){a.answers[c.widget.marker]=d.mathquill("latex")});c.$watch(function(){if(c.widget)return a.answers[c.widget.marker]},function(a){d.mathquill("latex",a)})})}}}]);angular.module("directives.lesson").directive("iosNavReplacement",["lesson",function(){return{restrict:"A",template:'<select data-ng-model="iosLesson" data-ng-options="l.key as l.title for l in lessons" data-ng-change="goToLesson(iosLesson)"></select><select data-ng-model="iosMorsel" data-ng-options="m as m.title for m in morsels" data-ng-change="goToMorsel(iosMorsel)"></select>',controller:["$scope","lesson",function(a,b){a.iosLesson=null;a.iosMorsel=null;b.addEventListener("lessonChange",function(){a.iosLesson=
a.lesson.key},{replayLast:!0}).addEventListener("morselChange",function(b){a.iosMorsel="undefined"!==typeof b.containingExercise?b.containingExercise:b},{replayLast:!0})}]}}]);angular.module("directives.lesson").directive("iframePlayer",["lesson",function(a){return{restrict:"A",link:function(b,c){a.addEventListener("morselChange",function(a){"EmbeddedFrame"===a.model&&(b.iframeSourceUrl=a.external_uri,$(c.get(0).contentWindow).ready(function(){b.loadingComplete(!0)}))},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.lesson").directive("lessonVideoPlayer",["lesson","$routeParams","youtubeVideoPlayer","viewerSettings","user",function(a,b,c,d,e){return{restrict:"A",link:function(b,g){var h=!1,j=null,l=function(){h&&c.pauseVideo()},k=function(){h&&c.destroyVideo()};c.addEventListener("apiReady",function(){a.addEventListener("pendingMorselChange",l,{removeOnDestructionOf:b}).addEventListener("pendingLessonChange",k,{removeOnDestructionOf:b}).addEventListener("pendingCourseChange",k,{removeOnDestructionOf:b});
a.addEventListener("morselChange",function(a){j=a;a._video&&(h?c.loadVideo(a._video.youtube_id,0):(c.attach(g.get(0),a._video.youtube_id,{autoPlay:d.get("autoPlay")?1:0}),h=!0))},{replayLast:!0,removeOnDestructionOf:b});d.addEventListener("change",function(a){"autoPlay"===a.name&&(!1===a.oldValue&&!0===a.newValue&&h)&&c.playVideo()});c.addEventListener("ready",function(){b.loadingComplete(!0)},{removeOnDestructionOf:b});c.addEventListener("videoPlay",function(){b.loadingComplete(!0)},{removeOnDestructionOf:b});
c.addEventListener("videoEnd",function(){if(!e.getUserProp("sitePreferences")||e.getUserProp("sitePreferences").autoAdvance)j.containingExercise&&j.containingExercise.quiz_ref&&j.containingExercise.lecture_ref.key===j.key?b.goToMorsel(j.containingExercise.quiz_ref):b.goToNextMorsel()},{removeOnDestructionOf:b})},{replayLast:!0,removeOnDestructionOf:b,removeAfterFired:!0})}}}]);angular.module("directives.lesson").directive("editorFileTabs",["codeEditor",function(a){return{restrict:"A",link:function(b){b.files=null;b.currentFilename=null;a.addEventListener("filesLoaded",function(a){b.files=a.files},{removeOnDestructionOf:b});a.addEventListener("activeFileChanged",function(a){b.currentFilename=a.newActiveFile.name},{removeOnDestructionOf:b});b.switchToFile=function(c){b.currentFilename=c;a.switchToFile(c)}}}}]);angular.module("directives.reviews").directive("reviewsList",["reviews",function(a){return{restrict:"A",scope:{entityKey:"=",numReviews:"=",numPerPage:"="},controller:["$scope",function(b){var c="recency";b.reviewsStartIndex=0;b.reviewsEndIndex=0;var d=function(d,e,h){return a.getReviews(d,e,h,c,b.cursorMap).success(function(a){b.reviews=a.reviews.slice(0,h);b.reviewsStartIndex=1+e*h;b.reviewsEndIndex=b.reviews.length+e*h;for(var d=0;d<b.reviews.length;++d)b.reviews[d].account=a.accounts[d];b.cursorMap=
a.cursor_map})},e=function(){function a(f){if(e)return d(b.entityKey,f,c),!1;e=!0}var c=b.numPerPage,e=!1;d(b.entityKey,0,c).then(function(){var d={items_per_page:c,num_display_entries:4,num_edge_entries:1,callback:a};$("#Pagination").pagination(b.numReviews,d)})};b.$watch("entityKey",function(a){a&&e()});b.setSortOrder=function(a){c=a;e()}}]}}]);angular.module("directives.reviews").directive("voteWidget",["reviews","user",function(a,b){return{restrict:"A",scope:{rating:"=",entityKey:"="},controller:["$scope",function(c){c.thumbs_u=function(){var a=c.rating&&c.rating.thumbs_u||0;return"u"===c.voteState?a+1:a};c.thumbs_d=function(){var a=c.rating&&c.rating.thumbs_d||0;return"d"===c.voteState?a+1:a};var d=function(d){b.userIsLoggedIn()?(a.vote(c.entityKey,d),c.voteState=d):window.location.href="/account/signin?"+$.param({next:window.location.href})};
c.voteUp=function(){d("u")};c.voteDown=function(){d("d")}}]}}]);angular.module("directives.lesson").directive("codeMirrorEditor",["codeMirror","codeEditor",function(a,b){return{restrict:"A",template:'<div ng-transclude></div><div class="code-mirror-holder"></div>',transclude:!0,link:function(c,d,e){a.attach(d.find(".code-mirror-holder").get(0),{language:e.language,theme:e.theme,autofocus:!0});c.fileCount=null;b.addEventListener("filesLoaded",function(a){c.fileCount=a.files.length},{removeOnDestructionOf:c});c.getActiveLanguage=function(){return a.getActiveLanguage()};
c.getAvailableLanguages=function(){return a.getAvailableLanguages()};c.setActiveLanguage=function(b){a.setActiveLanguage(b)};c.$on("$destroy",function(){a.detach()})}}}]);angular.module("directives.forum").directive("lessonForumDirective",["forumService","lesson",function(a,b){return{restrict:"A",controller:["$scope","$attrs",function(c,d){c.postsStartIndex=0;c.postsEndIndex=0;var e=d.numPerPage,f=function(a,b){a&&b&&(c.seeAllCoursePostsUrl="https://forums.udacity.com/tags/"+a.key+"/#"+a.key,c.askAQuestionUrl="https://forums.udacity.com/questions/ask/?tag="+(b.containingExercise?b.containingExercise.key:b.key)+"#"+a.key)};b.addEventListener("morselChange",function(b){c.morsel=
b;c.posts=void 0;a.getPosts(b.containingExercise?b.containingExercise.key:b.key,0,e).then(function(a){c.posts=a;c.postsStartIndex=1+0*e;c.postsEndIndex=c.posts.length+0*e});f(c.course,c.morsel)});b.addEventListener("courseChange",function(a){c.course=a.course;f(c.course,c.morsel)})}]}}]);angular.module("directives.myCourses").directive("courseSummary",["cacheVersion","content","user","canEatDogFood","dummyData",function(a,b,c,d){return{restrict:"A",replace:!1,templateUrl:"/templates/course_summary.html?"+a,scope:{courseKey:"=courseKey",initExpand:"=initExpand"},controller:["$scope",function(a){a.HIGHEST_MASTERY=4;a.MASTERY_LEVELS=[0,1,2,3,4];a.expanded=!1;a.loadingLessons=!1;a.masteryDescription={"0":"In Progress",1:"Proficiency",2:"Accomplishment",3:"High Distinction",4:"Highest Distinction"};
a.isCertificateReady=function(a){return!_.contains([],a)};a.getNodeProperty=b.getNodeProperty;a.getChildrenKeys=b.getChildrenKeys;a.getDifficultyLevel=b.getDifficultyLevel;a.getLevelMasteryPoints=b.getLevelMasteryPoints;a.getNotAvailableMessage=b.getNotAvailableMessage;a.getPositionNumber=b.getPositionNumber;a.hasBehavior=b.hasBehavior;a.isAvailable=b.isAvailable;a.isEnrolledIn=c.isEnrolledIn;a.getMasteryPoints=function(a,d){return b.getMasteryPoints(a,"me",d)};a.getEarnedMasteryPercentage=function(a){var d=
b.getMasteryPoints(a,"me","points_earned"),a=b.getMasteryPoints(a,"me","points_possible");return 0===a||!_.isNumber(d/a)?0:Math.round(100*(d/a))};a.getHighestMasteryBadge=function(a){try{var b=c.getUserProp("badges");return _.find(b,function(b){return"Course Mastery"===b.name&&b.target_ref.key===a})}catch(d){}};a.getHighestMasteryBadgeUrl=function(b){try{return a.getHighestMasteryBadge(b).highest_level_icon_url}catch(d){return"/media/img/site/icons/badge/CourseMastery_beginner_0.png"}};a.hasCertificate=
function(b){try{return 0<a.getHighestMasteryBadge(b).highest_level}catch(d){return!1}};a.getLastChild=function(a){return b.getLastChild(a,"me")};a.getMasteryLevel=function(a){return b.getMasteryLevel(a,"me")};a.getProgress=function(a){return b.getProgress(a,"me")};a.getRemainingDuration=function(a){return b.getRemainingDuration(a,"me")};a.getRemainingEvaluables=function(a){return b.getRemainingEvaluables(a,"me")};a.getRemainingMasteryPoints=function(d,c){var h=b.getLevelMasteryPoints(d,c),j=a.getMasteryPoints(d,
"points_earned"),h=h-j;0>h&&(h=0);return h};a.isOldClass=function(a){return _.contains(["cs101-old","cs373-old","cs271-old"],a)};a.pointText=function(a){return 1===a?"point":"points"};a.hasPermission=function(){return d}}],link:function(a,d){function c(){if(!a.expanded&&(a.loadingLessons=!0,a.$apply(),b.addEventListener("loadNodesComplete",function(b){$(k).slideDown("fast");a.loadingLessons=!1;a.expanded=!0;b.nohttp&&a.$apply()},{removeAfterFired:!0}),a.hasOwnProperty("courseKey"))){var d=b.getChildrenKeys(a.courseKey);
b.loadNodes(d,["me"],a.courseKey)}$(l).off("click")}function h(){$(l).on("click",c);$(l).find(".resume").on("click",function(a){a.stopPropagation()});$(l.find(".course-title span")).on("click",j)}function j(){$(l.find(".course-title span")).off("click");$(k.slideUp("fast",function(){h()}));a.expanded=!1;a.$apply()}var l=d,k=d.find(".details");$(l.find(".tab")).on("click",j);a.initExpand?a.expanded=!0:(h(),$(k).slideToggle("fast"))}}}]);angular.module("directives").directive("headerMiniNav",["cacheVersion",function(a){return{restrict:"A",scope:{courseId:"="},templateUrl:"/templates/angular/header_mini_nav.html?"+a,link:function(a,c,d){a.hovered=d.currentLocation;a.currentLocation=d.currentLocation;a.getCourseKey=function(){return a.courseId}}}}]);angular.module("directives.location").directive("location",["$http",function(){return{restrict:"A",scope:{userLocation:"=",locElClass:"="},template:'<input class="loc-widget {{locElClass}}" data-ng-model="userLocation.displayPlace" type="text" data-ng-change="locSelect(this)" data-uy-event="{focus: \'locEditStart()\', blur: \'locEditEnd()\'}">',controller:["$scope",function(a){a.locEditStart=function(){};a.locEditEnd=function(){};a.locSelect=function(){a.userLocation={displayPlace:a.userLocation.displayPlace}}}],
link:function(a,b){a.googleLoc=null;a.googleLocEl=b.find(".loc-widget");a.$watch("userLocation.displayPlace",function(b){"undefined"!==b&&null===a.googleLoc&&(a.googleLoc=new google.maps.places.Autocomplete(a.googleLocEl.get(0),{types:["(cities)"]}),google.maps.event.addListener(a.googleLoc,"place_changed",function(){var b=a.googleLoc.getPlace();b.geometry&&setTimeout(function(){a.place=b;var c=b.formatted_address,f=b.address_components,g="country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality postal_code".split(" "),
h;h="short_name";for(var j=[],l=0;l<f.length;l++)for(var k=0;k<f[l].types.length;k++)if(-1!==$.inArray(f[l].types[k],g)){j.push(f[l][h]);break}a.locObj={displayPlace:c,places:j,coordinates:""+b.geometry.location.lat()+","+b.geometry.location.lng()};a.userLocation=a.locObj;a.$apply()},1)}))});b.keydown(function(a){if(13===a.keyCode){a.preventDefault();var d=b.find("input"),a=d.closest("form").find(":input").not("[type=hidden]"),d=a.index(d);-1<d&&d+1<a.length&&a.eq(d+1).focus();return!1}})}}}]);angular.module("directives.utility").directive("uyAssign",function(){return{restrict:"A",link:function(a,b,c){a.$eval(c.uyAssign)}}});angular.module("directives.utility").directive("clickFade",function(){return{restrict:"A",link:function(a,b){$(document).on("click",function(){$(b).fadeOut("slow")})}}});angular.module("directives.utility").directive("uyEvent",["$parse",function(a){return function(b,c,d){d=b.$eval(d.uyEvent);angular.forEach(d,function(d,f){var g=a(d);c.on(f,function(a){var d=Array.prototype.slice.call(arguments),d=d.splice(1);b.$apply(function(){g(b,{$event:a,$params:d})})})})}}]);angular.module("directives.utility").directive("animatedToggle",function(){return{restrict:"A",link:function(a,b,c){c.toggleTarget||console.error("You must provide a toggle-target with a selector for the child element to toggle");c.toggler||console.error("You must provide an element to trigger the toggle");var d=b.find(c.toggleTarget),a=b.find(c.toggler);d||console.error("Element to toggle ("+c.toggleTarget+") not found!");a||console.error("Element to trigger toggle ("+c.toggler+") not found!");$(a).on("click",
function(){$(d).toggle("fast")});$(d).hide()}}});angular.module("directives.utility").directive("uyBlur",function(){return function(a,b,c){b.on("blur",function(){console.log(c);a.$apply(c.uyBlur)})}});angular.module("directives.utility").directive("autofocusOnClick",["$timeout",function(a){return{restrict:"A",link:function(b,c){c.click(function(){a(function(){$("input[autofocus]").focus()},0,!1)})}}}]).directive("autofocusOnInit",["$timeout",function(a){return{restrict:"A",link:function(b,c){a(function(){c.find("input[autofocus]").focus()},0,!1)}}}]);angular.module("directives.utility").directive("enforceBrowser",["techDetect",function(a){return{restrict:"A",link:function(){var b={Chrome:11,Firefox:10,Safari:4,Explorer:9,Opera:12},c=a.browserStats();b.hasOwnProperty(c.browser)&&("number"===typeof c.version&&c.version<b[c.browser])&&(window.location="/upgrade")}}}]).directive("warnBrowser",["techDetect","$cookieJar",function(a,b){return{restrict:"A",link:function(){},controller:["$scope",function(c){var d={Chrome:18,Firefox:16,Safari:5,Explorer:9,
UIWebView:1},e="dismissed"===b.get("udacityBrowserWarning"),f=a.browserStats();c.warnBrowserTech=function(){return!d.hasOwnProperty(f.browser)||"number"!==typeof f.version||f.version<d[f.browser]};c.warnBrowserDismiss=function(a){a=a||3600;a=new Date((new Date).getTime()+1E3*a);b.set("udacityBrowserWarning","dismissed",{expires:a});e=!0};c.warnBrowserDismissed=function(){return e}}]}}]);angular.module("services.utility").directive("dropdownMenu",[function(){return{restrict:"A",link:function(a,b,c){var d=b.find(c.dropdownMenu);$("body").on("click",function(){d.hide()});if(c.opener)b.on("click",""+c.opener,function(){d.show()});if(c.closer)b.on("click",""+c.closer,function(){d.hide()});if(c.toggler)b.on("click",""+c.toggler,function(){d.toggle()});b.on("click",function(a){a.stopPropagation();a.preventDefault()})}}}]);angular.module("directives.utility").directive("uyAnimatedShow",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.uyAnimatedShow,function(a){a&&"none"===b.css("display")?c.fadeIn?b.fadeIn(parseInt(c.fadeIn,10)):c.slideDown?b.slideDown(parseInt(c.slideDown,10)):b.show():!a&&"none"!==b.css("display")&&(c.fadeOut?b.fadeOut(parseInt(c.fadeOut,10)):c.slideUp?b.slideUp(parseInt(c.slideUp,10)):b.hide())})}}});angular.module("directives.utility").directive("markdown",["markdownConverter",function(a){return{restrict:"A",scope:{markdown:"="},template:'<span ng-bind-html-unsafe="compiledOutput"></span>',link:function(b,c,d){b.$watch("markdown",function(c){c?b.compiledOutput=a.makeHtml(c):c||(b.compiledOutput=d.placeholder||"")})}}}]);angular.module("directives.utility").directive("videoPlayer",["youtubeVideoPlayer",function(a){return{restrict:"A",link:function(b,c,d){a.addEventListener("apiReady",function(){a.attach(c.get(0),d.videoId,{autoPlay:d.autoPlay||0})},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.editor").directive("quizWidget",["cacheVersion",function(a){return{restrict:"E",controller:"WidgetCtrl",templateUrl:"/templates/angular/editor/widgets/widget.html?"+a,replace:!0,link:function(a,c){$(c).parent().width();$(c).parent().height();$(c).css({top:100*a.widget.placement.y+"%",left:100*a.widget.placement.x+"%"});$(c).draggable({handle:"img",stop:function(d,e){var f=$(c).parent().width(),g=$(c).parent().height();a.updateWidgetPosition(a.widget.marker,e.position.left/
f,e.position.top/g)||$(c).css({top:100*a.widget.placement.y+"%",left:100*a.widget.placement.x+"%"})}});if("NumericInputWidget"===a.widget.model||"TextInputWidget"===a.widget.model||"MathInputWidget"===a.widget.model)$(c).css({width:100*a.widget.placement.width+"%",height:100*a.widget.placement.height+"%"}),$(c).resizable({stop:function(d,e){var f=$(c).parent().width(),g=$(c).parent().height();a.widget.placement.width=e.size.width/f;a.widget.placement.height=e.size.height/g}})}}}]).directive("radioButtonWidget",
function(){return{restrict:"E",replace:!0,template:'<input type="radio" ng-model="groupSelected[widget[\'group\']]" value="{{widget.marker}}"/>'}}).directive("checkboxWidget",function(){return{restrict:"E",replace:!0,template:"<input type=\"checkbox\" ng-model=\"evaluatorForMarker(widget['marker'])['answer']\" ng-model-instant/>"}}).directive("textInputWidget",["cacheVersion",function(a){return{restrict:"E",replace:!0,templateUrl:"/templates/angular/editor/widgets/text_input.html?"+a}}]).directive("numericInputWidget",
["cacheVersion",function(a){return{restrict:"E",replace:!0,templateUrl:"/templates/angular/editor/widgets/numeric_input.html?"+a}}]).directive("videoNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"VideoCtrl",templateUrl:"/templates/angular/editor/nodes/video.html?"+a,link:function(a){if(window.YT)var c=new YT.Player("youtube-player",{height:"200",width:"320",playerVars:{autoplay:0,controls:1},events:{onReady:function(){a.$apply(function(a){a.ytPlayer=c})}}});
else{var d=document.createElement("script");d.src="//www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e)}window.onYouTubeIframeAPIReady=function(){console.log("youtube api ready");a.$apply(function(a){var b=new YT.Player("youtube-player",{height:"200",width:"",playerVars:{autoplay:0,controls:1},events:{onReady:function(){a.$apply(function(a){a.ytPlayer=b})}}})})}}}}]).directive("quizNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},
controller:"QuizCtrl",templateUrl:"/templates/angular/editor/nodes/image_form_quiz.html?"+a}}]).directive("codeMirrorEditor",["libraryLoader",function(a){return{restrict:"E",scope:{text:"=text",filename:"=filename"},template:'<div class="code-mirror-editor">EDITOR</div>',link:function(b,c){a.loadLibraries(["codemirror"]).then(function(){var a=c.get(0),e=window.CodeMirror(function(b){a.parentNode.replaceChild(b,a);b.classList.add("code-mirror-editor")},{value:b.text,mode:"python",theme:"codacity",
lineNumbers:!0,matchBrackets:!0,indentUnit:4,extraKeys:{Tab:"indentMore"}});e.on("change",function(a){var d=a.getValue();"$digest"===b.$root.$$phase?b.text=d:b.$apply(function(a){a.text=d})});b.$watch("text",function(){b.text!==e.getValue()&&e.setValue(b.text)});b.$watch("filename",function(){if(b.filename){var a=b.filename.split(".");2>a.length||(a=a[a.length-1].toLowerCase(),"py"===a?(e.setOption("mode","python"),e.setOption("indentUnit",4)):"js"===a?(e.setOption("mode","javascript"),e.setOption("indentUnit",
2)):"html"===a&&(e.setOption("mode",{name:"xml",htmlMode:!0}),e.setOption("indentUnit",2)))}})})}}}]).directive("frameNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},templateUrl:"/templates/angular/editor/nodes/frame.html?"+a}}]).directive("programmingNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"ProgrammingCtrl",templateUrl:"/templates/angular/editor/nodes/programming.html?"+a}}]).directive("programmingGrading",["cacheVersion",function(a){return{restrict:"E",
scope:{evaluator:"=evaluator"},controller:"ProgrammingGradingCtrl",templateUrl:"/templates/angular/editor/nodes/programming_grading.html?"+a}}]).directive("iframeGrading",["cacheVersion",function(a){return{restrict:"E",scope:{evaluator:"=evaluator"},controller:"IFrameGradingCtrl",templateUrl:"/templates/angular/editor/nodes/iframe_grading.html?"+a}}]).directive("exerciseNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"ExerciseCtrl",templateUrl:"/templates/angular/editor/nodes/exercise.html?"+
a}}]).directive("sketchNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"SketchCtrl",templateUrl:"/templates/angular/editor/nodes/sketch.html?"+a}}]);angular.module("directives.editor").directive("editorListItem",["cacheVersion",function(a){return{restrict:"E",scope:{nodeRef:"=nodeRef"},controller:"LessonListCtrl",templateUrl:"/templates/angular/editor/list_item.html?"+a,replace:!0,link:function(a,c){c=c.get(0);c.addEventListener("dragstart",function(d){c.classList.add("dragging");d.dataTransfer.setData("text/plain",a.node.key)});c.addEventListener("dragend",function(){c.classList.remove("dragging")});c.addEventListener("dragenter",function(){this.classList.add("hovered")});
c.addEventListener("dragleave",function(a){var b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=a.clientY+document.body.scrollTop+document.documentElement.scrollTop,f=c.getBoundingClientRect();(b<f.left||b>f.right||a<f.top||a>=f.bottom)&&this.classList.remove("hovered")});c.addEventListener("dragover",function(a){a.preventDefault();a.dataTransfer.dropEffect="move";return!1});c.addEventListener("drop",function(d){this.classList.remove("hovered");d.stopPropagation();var c=
d.dataTransfer.getData("text/plain");a.$apply(function(a){a.$emit("droppedNode",{droppedKey:c,droppedOn:a.node,where:a.parentNode,type:a.nodeType})});return!1})}}}]).directive("microUserInfo",["cacheVersion",function(a){return{restrict:"E",replace:!0,scope:{userRef:"=userRef"},controller:"MicroUserInfoCtrl",templateUrl:"/templates/angular/editor/micro_user_info.html?"+a}}]);angular.module("controllers.settings").controller("siteSettings",["$scope","api","user","validator",function(a,b,c){a.videoQualities=[{label:"Automatic",value:"default"},{label:"360p",value:"medium"},{label:"480p",value:"large"},{label:"720p",value:"hd720"},{label:"1080p",value:"hd1080"}];a.playbackRates=[{label:"0.25x",value:0.25},{label:"0.5x",value:0.5},{label:"Normal",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}];c.addEventListener("userChanged",function(){var b=c.getUserProp("sitePreferences");
a.settings=b?{useHtml5Player:b.useHtml5Player,autoAdvance:b.autoAdvance,playbackRate:_.find(a.playbackRates,function(a){return a.value===b.playbackRate}),videoQuality:_.find(a.videoQualities,function(a){return a.value===b.videoQuality})}:{useHtml5Player:!0,autoAdvance:!0,playbackRate:a.playbackRates[2],videoQuality:a.videoQualities[0]}},{replayLast:!0});a.saveClassroomSettings=function(){b.post("/users/me",{site_preferences:{use_html5_player:a.settings.useHtml5Player,auto_advance:a.settings.autoAdvance,
playback_rate:a.settings.playbackRate.value,video_quality:a.settings.videoQuality.value}}).success(function(b){c.setUser(c.translateUserFromApi(b.user));a.submitStatus="success"}).error(function(){a.submitStatus="error"})}}]);angular.module("udacity.courseCatalog").config(["$routeProvider",function(a){a.when("/:keyword")}]);
angular.module("controllers.courseCatalog").controller("courseCatalog",["$scope","$routeParams",function(a,b){a.categoryTypeOptions=[{value:"all",name:"All Categories"},{value:"biz",name:"Business"},{value:"cs",name:"Computer Science"},{value:"math",name:"Mathematics"},{value:"ph",name:"Physics"}];a.levelTypeOptions=[{value:"all",name:"All Levels"},{value:"beginner",name:"Beginner"},{value:"intermediate",name:"Intermediate"},{value:"advanced",name:"Advanced"}];a.form={categoryType:a.categoryTypeOptions[0].value,
levelType:a.levelTypeOptions[0].value};a.courseData={cs101:{level:"beginner",category:"cs"},ph100:{level:"beginner",category:"ph"},st101:{level:"beginner",category:"math"},ma006:{level:"beginner",category:"math"},ma008:{level:"beginner",category:"math"},st095:{level:"beginner",category:"math"},cs215:{level:"intermediate",category:"cs"},cs222:{level:"intermediate",category:"cs"},cs253:{level:"intermediate",category:"cs"},cs255:{level:"intermediate",category:"cs"},cs258:{level:"intermediate",category:"cs"},
cs259:{level:"intermediate",category:"cs"},cs262:{level:"intermediate",category:"cs"},cs271:{level:"intermediate",category:"cs"},cs291:{level:"intermediate",category:"cs"},cs313:{level:"intermediate",category:"cs"},ep245:{level:"intermediate",category:"biz"},cs212:{level:"advanced",category:"cs"},cs344:{level:"advanced",category:"cs"},cs348:{level:"advanced",category:"cs"},cs373:{level:"advanced",category:"cs"},cs387:{level:"advanced",category:"cs"}};a.routeCategoryMappings={"computer-science":"cs",
business:"biz",mathematics:"math",physics:"ph"};a.routeLevelMappings={beginner:"beginner",intermediate:"intermediate",advanced:"advanced"};a.$on("$routeChangeSuccess",function(){var c=b.keyword;null!==c&&(a.routeCategoryMappings.hasOwnProperty(c)?a.form.categoryType=a.routeCategoryMappings[c]:a.routeLevelMappings.hasOwnProperty(c)&&(a.form.levelType=a.routeLevelMappings[c]))});a.isNoMatch=!1;a.$watch("form.categoryType + form.levelType",function(){var b=0;angular.forEach(a.courseData,function(d){a.matchesFilter(d.category,
d.level)&&b++});a.isNoMatch=0===b});a.isCourseShown=function(b){var d=a.courseData[b],b=d.category,d=d.level;return a.matchesFilter(b,d)||a.softlyMatchesFilter(b,d)};a.matchesFilter=function(b,d){var e=a.form.categoryType,f=a.form.levelType;return("all"===f||f===d)&&("all"===e||e===b)};a.softlyMatchesFilter=function(b){var d=a.form.categoryType;return a.isNoMatch&&d===b}}]);angular.module("controllers.reviews").controller("reviewForm",["$scope","api","$window","user","nodeKey","nodeUrl",function(a,b,c,d,e,f){a.buttonDisabled=!1;a.countWords=function(a){return a?a.split(" ").length:0};var g=null,h=null;a.getAuthor=function(){return d.getUser()};a.setPotentialRating=function(a){g=a};a.getPotentialRating=function(){return g};a.getRating=function(){return h};a.setRating=function(a){1<=a&&5>=a&&(g=null,h=a)};a.setupReviewText=function(b){a.reviewText=decodeURIComponent(b)};
a.submitReview=function(){a.serverError=!1;if(h&&20<=a.countWords(a.reviewText)){var d={user_key:"me",score_type:"stars5",score_str:h.toString(),text:a.reviewText,fresh:!0};a.buttonDisabled=!0;b.post("/users/me/reviews/"+encodeURIComponent(e),d).success(function(){c.location.href=f}).error(function(b){a.serverError=b.error||"Somthing went wrong on our end, please try again!";a.buttonDisabled=!1})}else a.submitAttempted=!0}}]);angular.module("controllers.myCourses").controller("myCourses",["$scope","content","auth","user","$location","dummyData",function(a,b,c,d,e){a.userKey="me";a.nodesLoaded=!1;a.getEnrollmentKeys=function(a){var c=d.getUserProp("enrollments");if(null===c)return[];c=_.filter(c,function(b){return b.is_enrolled===a});c=_.map(c,function(a){return a.node_key});c.sort(function(a,d){return b.getLastInteractionDate(d,"me")-b.getLastInteractionDate(a,"me")});return c};$(".tool-tip").tooltip();a.allKeys=_.map(d.getBaseUser().enrollments,
function(a){return a.node_key});c=e.search();a.newClass=c.newClass;c=c.expand;a.expand=_.contains(a.allKeys,c)?c:void 0;a.firstName=d.getBaseUser().firstName;b.addEventListener("loadNodesComplete",function(){_.each(a.allKeys,function(a){b.setMasteryPoints(a,"me")});if(a.expand){var d=b.getChildrenKeys(a.expand);b.addEventListener("loadNodesComplete",function(){a.nodesLoaded=!0});b.loadNodes(d,["me"],a.expand)}else a.nodesLoaded=!0},{removeAfterFired:!0});b.loadNodes(a.allKeys,["me"])}]);angular.module("controllers.settings").config(["$routeProvider","cacheVersion",function(a,b){a.when("/profile",{templateUrl:"/templates/angular/settings/profile.html?"+b,controller:"userSettings"}).when("/settings",{templateUrl:"/templates/angular/settings/site_settings.html?"+b,controller:"siteSettings"}).otherwise({templateUrl:"/templates/angular/settings/account.html?"+b,controller:"userSettings"})}]).controller("userSettings",["$scope","api","user","validator",function(a,b,c,d){function e(a,b){b.usr=
angular.copy(a);b.accountErrors={};b.profileErrors={};b.profileErrorsFlat=[];b.usr.currentPassword="";b.usr.newPassword="";b.usr.newPasswordRept="";b.usr.locCache="undefined"!==typeof b.usr.location&&null!==b.usr.location?angular.copy(b.usr.location):{};b.submitSuccess=!1;$("[rel=tooltip]").length&&$("[rel=tooltip]").tooltip()}function f(a,b,d,c){d="function"===typeof d?d:function(a,b){console.log("it made it!");console.log({data:a,e:b})};c="function"===typeof c?c:function(a,b){console.warn("it failed!");
console.warn({data:b,e:a})};$(a).fileupload({dataType:"json",type:"POST",forceIframeTransport:!0,done:d,fail:c});$(a).fileupload("add",{fileInput:$(a),url:b})}function g(b){c.setUser(c.translateUserFromApi(b.user));a.submitSuccess=!0;$("body").animate({scrollTop:0},300,function(){$("#account-success").animate({backgroundColor:"#76D576"},100).animate({backgroundColor:"#FFFFFF"},300)})}function h(b,d){400===d?a.accountErrors.linkedAccounts=[b.error]:a.accountErrors.settingsGeneralError=[b.error]}c.addEventListener("userChanged",
function(b){e(b.user,a)},{removeOnDestructionOf:a});e(c.getUser(),a);a.saveProfileSettings=function(e){a.profileErrors={};a.profileErrorsFlat=[];a.submitSuccess=!1;if(null===e.location||"undefined"===typeof e.location.places)if(angular.equals(a.usr.locCache,{})&&(null===e.location||""===e.location.displayPlace))a.usr.location=null;else{a.usr.location=a.usr.locCache;a.profileErrorsFlat=["Please select a city from one of the suggested locations in the drop-down list."];return}var f=d.check({});if(f.valid)f=
{occupation:e.occupation,bio:e.bio,linkedin_url:e.linkedinUrl,website_url:e.websiteUrl,nickname:e.nickname,employer_sharing:e.employerSharing},e.location&&(f.location={display_place:e.location.displayPlace,places:e.location.places,coordinates:e.location.coordinates}),b.post("/users/me",f).success(function(b){c.setUser(c.translateUserFromApi(b.user));a.submitSuccess=!0;$("body").animate({scrollTop:0},300,function(){$("#profile-success").animate({backgroundColor:"#76D576"},100).animate({backgroundColor:"#FFFFFF"},
300)})}).error(function(){});else{for(var k in f.errorText)if(f.errorText.hasOwnProperty(k))for(e=0;e<f.errorText[k].length;e++)a.profileErrorsFlat.push(f.errorText[k][e]);setTimeout(function(){$("body").animate({scrollTop:$("#profile-errors").offset().top-40},300)},1)}};a.resumeUpload=function(d){$(d).val()&&b.get("/users/me/resume/upload_url").success(function(b){f(d,b.url,function(){a.$apply(function(){a.usr.resume={url:"/api/users/me/resume?"+Math.random()};a.setsChangeResume=!1})});return!1}).error(function(b,
d,c,e){a.profileErrorsFlat=["Oops! Something happened when we tried to upload yourfile. Please refresh the page and try again."];console.warn("Getting upload URL failed!");console.warn({data:b,status:d,headers:c,config:e})});return!1};a.avatarUpload=function(d){$(d).val()&&b.get("/users/me/image/upload_url").success(function(b){f(d,b.url,function(b,d){a.$apply(function(){try{a.usr.imageUrl=d.result.media.serving_url}catch(b){}})})}).error(function(b,d,c,e){a.profileErrorsFlat=["Oops! Something happened when we tried to upload yourfile. Please refresh the page and try again."];
console.warn("Getting upload URL failed!");console.warn({data:b,status:d,headers:c,config:e})});return!1};a.saveAccountSettings=function(e){a.submitSuccess=!1;a.accountErrors={};var f={setsFirstName:{pretty:"first name",value:e.firstName,validators:[{type:"required"}]},setsLastName:{pretty:"last name",value:e.lastName,validators:[{type:"required"}]},setsEmail:{pretty:"email address",value:e.email.address,validators:[{type:"required",chained:[{type:"email"}]}]},setsCurrPass:{pretty:"password",value:e.currentPassword,
validators:[{type:"required",failMsg:"The current password is required when changing the account password.",disabled:!c.getUser().hasPassword||""===e.newPassword&&""===e.newPasswordRept}]},setsNewPass:{pretty:"new password",value:e.newPassword,validators:[{type:"strLen",args:[6,void 0],disabled:""===e.newPassword}]},setsNewPassRept:{pretty:"new password confirmation",value:e.newPasswordRept,validators:[{type:"required",failMsg:"A password confirmation is required when changing the account password.",
disabled:""===e.newPassword,chained:[{type:"equal",args:[e.newPassword,"password"]}]}]}},f=d.check(f);if(f.valid){var k={first_name:e.firstName,last_name:e.lastName,email_preferences:{master_ok:e.emailPreferences.masterOK}};e.email.address!==c.getUser().email.address&&(k.email_address=e.email.address);""!==e.newPassword&&(k.password=e.newPassword,k.existing_password=e.currentPassword);b.post("/users/me",k).success(g).error(function(b,d){403===d?a.accountErrors.setsCurrPass=[b.error]:a.accountErrors.settingsGeneralError=
[b.error];var c=Number.POSITIVE_INFINITY,e;for(e in a.accountErrors)a.accountErrors.hasOwnProperty(e)&&(e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),$("#"+e).offset().top<c&&(c=$("#"+e).offset().top));$("body").animate({scrollTop:c-50},300)})}else{a.accountErrors=f.errorText;e=Number.POSITIVE_INFINITY;for(k in f.errorText)f.errorText.hasOwnProperty(k)&&(k=k.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),$("#"+k).offset().top<e&&(e=$("#"+k).offset().top));$("body").animate({scrollTop:e-50},
300)}};a.removeFacebookId=function(){b.post("/users/me",{remove_facebook_id:!0}).success(g).error(h)};a.removeGoogleId=function(){b.post("/users/me",{remove_google_id:!0}).success(g).error(h)};a.proFormComplete=function(){var b=a.usr,b=0+("string"===typeof b.nickname&&0<b.nickname.length)+("string"===typeof b.websiteUrl&&0<b.websiteUrl.length)+("string"===typeof b.linkedinUrl&&0<b.linkedinUrl.length)+(typeof("object"===b.location)&&b.location&&"string"===typeof b.location.displayPlace&&0<b.location.displayPlace.length)+
("string"===typeof b.occupation&&0<b.occupation.length)+("string"===typeof b.bio&&0<b.bio.length)+("string"===typeof b.imageUrl&&0<b.imageUrl.length&&!/robohash\.org/.test(b.imageUrl))+("object"===typeof b.resume&&null!==b.resume&&"string"===typeof b.resume.url&&0<b.resume.url.length);return Math.ceil(100*b/8)}}]);angular.module("controllers.lesson").controller("imageQuizPanel",["$scope","lesson","imageQuiz",function(a,b,c){a.attempted=!1;a.correctlyAnswered=!1;a.status="unsubmitted";a.quizReturn=null;a.submitQuiz=function(){a.quizReturn=null;a.status="processing";c.submit()};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Submit Answer"};b.addEventListener("morselChange",function(){a.quizReturn=null;a.attempted=!1;a.correctlyAnswered=!1;a.status="unsubmitted"},{replayLast:!0,
removeOnDestructionOf:a});c.addEventListener("correct",function(b){a.attempted=!0;a.status="correct";a.correctlyAnswered=!0;a.quizReturn={status:"correct",text:b.comment}},{removeOnDestructionOf:a}).addEventListener("incorrect",function(b){a.attempted=!0;a.status="incorrect";a.quizReturn={status:"incorrect",text:b.comment}},{removeOnDestructionOf:a}).addEventListener("error",function(b){a.attempted=!0;a.status="error";a.quizReturn={status:"error",text:b.comment}},{removeOnDestructionOf:a}).addEventListener("recorded",
function(b){a.status="recorded";a.quizReturn={status:"recorded",text:b.comment}})}]);angular.module("udacity.viewer").config(["$routeProvider","tags",function(a,b){a.when("/"+b.course+":courseKey/"+b.lesson+":lessonKey/"+b.exercise+":exerciseKey/"+b.morsel+":morselKey").when("/"+b.course+":courseKey/"+b.lesson+":lessonKey/"+b.morsel+":morselKey").when("/"+b.course+":courseKey/"+b.lesson+":lessonKey").when("/"+b.course+":courseKey")}]);
angular.module("controllers.lesson").constant("videoViewedTimeThreshold",3).constant("tags",{course:"c-",lesson:"l-",exercise:"e-",morsel:"m-"}).constant("typeForTag",{"c-":"course","l-":"lesson","e-":"exercise","m-":"morsel"}).controller("viewer",["$scope","lesson","$location","$q","$routeParams","$route","lessonActivityTracker","$timeout","videoViewedTimeThreshold","youtubeVideoPlayer","viewerSettings","cacheVersion","loadingMessages","lessonPrefetcher","user","tags","congratulatoryMessages","libraryLoader",
"viewerPartialMap","examMode","techDetect",function(a,b,c,d,e,f,g,h,j,l,k,m,n,s,p,r,w,q,z,y,x){function t(){var b;b=_.without(_.union(n.general,n[u]),null,void 0,"");a.viewerLoadingMessage=b[_.random(b.length-1)];a.isViewerLoading=!0}function v(b){a.congratulatoryMessageOccasion=b;var d=_.random(0,w[b].length-1);a.congratulatoryMessage=w[b][d];l.pauseVideo()}function B(a,b){if(a){if(z[a.model])return"/templates/angular/viewer/partials/"+z[a.model]+b+"?"+m;console.error("Unrecognized morsel type"+
a.model)}else return"/templates/angular/viewer/partials/loading"+b+"?"+m}function A(a){return function(){if(l.getCurrentTime()>=j){var d=l.getCurrentTime();l.emitEvent("videoPause",d);l.emitEvent("videoPlay",d+1);b.markMorselAsCompleted(a)}else C=h(A(a),500,!1)}}a.course=null;a.lessons=null;a.lesson=null;a.morsels=null;a.morsel=null;var u=c.path().match("/"+r.course+"([^/]+)");(u=u?u[1]:null)?p.getBaseUser().registered||(window.location.href="/course/"+u):window.location.href="/";b.addEventListener("lessonPermissionDenied",
function(){window.location.href="/course/"+u});b.addEventListener("courseChange",function(a){if((!a.lessons||0===a.lessons.length)&&!a.lastLessonVisited&&!e.lessonKey)window.location.href="/course/"+u}).addEventListener("coursePermissionDenied",function(){e.lessonKey||(window.location.href="/course/"+u)});b.addEventListener("lessonChange",function(a){if(!a.morsels||0===a.morsels.length)window.location.href="/course/"+u});a.isViewerLoading=!0;b.addEventListener("courseChange",function(){q.loadLibraries(["codemirror",
"mathquill"]).then(function(){},function(){console.log("Failed to load some libraries!")})}).addEventListener("morselChange",function(){a.isViewerLoading=!1});a.startCourse=function(){a.isStartingCourse=!1;k.set("autoPlay",!0)};a.isStartingCourse=!1;a.goToMyCourses=function(){window.location.href="/my_courses"};a.goToCourseCatalog=function(){window.location.href="/courses"};a.clearCongratulatoryMessage=function(){a.congratulatoryMessageOccasion=null;a.congratulatoryMessage=null};a.clearCongratulatoryMessage();
b.addEventListener("courseChange",function(b){a.course=b.course;a.lessons=b.lessons},{replayLast:!0}).addEventListener("lessonChange",function(b){a.lesson=b.lesson;a.morsels=b.morsels},{replayLast:!0}).addEventListener("morselChange",function(b){a.morsel=b;h.cancel(C);("Video"===b.model||"SketchVideo"===b.model)&&l.addEventListener("videoPlay",function(){h.cancel(C);C=h(A(b.key),1E3*j,!1)},{removeAfterFired:!0})},{replayLast:!0});b.addEventListener("pendingLessonChange",function(){a.morsels=null;
a.morsel=null});a.$on("$routeChangeSuccess",function(d,c,f){if(!f||!c)d=!1;else{var l=f.pathParams,d=c.pathParams;if(_.keys(l).length===_.keys(d).length)d=!1;else{var h=!0;_.each(d,function(a,b){l[b]!==a&&(h=!1)});d=h}}d&&window.history.back();if((null===a.course||a.course.key!==e.courseKey)&&"none"!==e.courseKey)t(),b.addEventListener("courseChange",function(b){e.lessonKey||(b.hasActivity||(a.isStartingCourse=!0,k.set("autoPlay",!1)),b.lastLessonVisited?a.goToLesson(b.lastLessonVisited.key):a.goToLesson(b.lessons[0].key))},
{removeAfterFired:!0}),b.changeCourse(e.courseKey);if((null===a.lesson||a.lesson.key!==e.lessonKey)&&e.lessonKey)t(),b.addEventListener("lessonChange",function(b){e.morselKey||(b.lastMorselVisited?a.goToMorsel(b.lastMorselVisited):a.goToMorsel(b.morsels[0]))},{removeAfterFired:!0}),b.changeLesson(e.lessonKey);if((null===a.morsel||a.morsel.key!==e.morselKey)&&e.morselKey)g.logNodeVisit(),a.lesson&&a.lesson.key===e.lessonKey?b.changeMorsel(e.morselKey):b.addEventListener("lessonChange",function(){b.changeMorsel(e.morselKey)},
{removeAfterFired:!0})});a.alert=function(a){alert(a)};a.log=function(a){console.log(a)};a.getCurrentMorselType=function(){return a.morsel?a.morsel.model:null};a.getStyleClassesForMorsel=function(b){var d="";if(a.morsel)if("Exercise"===b.model){if(b.completed||b.lecture_ref&&b.lecture_ref.completed)d+="is-viewed";-1!==_.indexOf([b.key,b.lecture_ref&&b.lecture_ref.key,b.quiz_ref&&b.quiz_ref.key,b.answer_ref&&b.answer_ref.key],a.morsel&&a.morsel.key)&&(d+=" is-current")}else b.completed&&(d+="is-viewed"),
a.morsel.key===b.key&&(d+=" is-current");return d};a.getPlayerPartialForCurrentMorsel=function(){return B(a.morsel,"_player.html")};a.getSidePanelPartialForCurrentMorsel=function(){return B(a.morsel,"_side_panel.html")};a.goToMorsel=function(d){(!d||!d.key)&&console.error("Cannot go to invalid morsel "+d);(!a.morsel||d.key!==a.morsel.key)&&h(function(){if("Exercise"===d.model){var a=d.lecture_ref?d.lecture_ref:d.quiz_ref;b.announcePendingMorselChange(a);c.path("/"+r.course+e.courseKey+"/"+r.lesson+
e.lessonKey+"/"+r.exercise+d.key+"/"+r.morsel+a.key)}else b.announcePendingMorselChange(d),d.containingExercise?c.path("/"+r.course+e.courseKey+"/"+r.lesson+e.lessonKey+"/"+r.exercise+d.containingExercise.key+"/"+r.morsel+d.key):c.path("/"+r.course+e.courseKey+"/"+r.lesson+e.lessonKey+"/"+r.morsel+d.key)})};a.goToNextMorsel=function(){var b=a.morsel,d=a.morsels.length;b.containingExercise&&(b=b.containingExercise);b=b.indexInLesson;b<d-1?a.goToMorsel(a.morsels[b+1]):a.lessons&&a.lesson.key===a.lessons[a.lessons.length-
1].key?a.course&&a.course.catalog_entry&&!a.course.catalog_entry.complete?v("endOfIncompleteCourse"):v("endOfCourse"):v("endOfLesson")};a.goToPreviousMorsel=function(){var b=a.morsel;b.containingExercise&&(b=b.containingExercise);b=b.indexInLesson;0<b?a.goToMorsel(a.morsels[b-1]):console.error("Can't go to previous; at beginning of lesson")};a.goToLesson=function(d){if(!a.lesson||d!==a.lesson.key)b.announcePendingLessonChange(),h(function(){c.path("/"+r.course+e.courseKey+"/"+r.lesson+d)})};a.goToNextLesson=
function(){if(a.lessons){var b=a.lessons.length,d=_.find(a.lessons,function(b){return b.key===a.lesson.key}).indexInCourse;0<=d&&d<b-1?a.goToLesson(a.lessons[d+1].key):console.error("Can't go to next; at end of course!")}else console.error("Can't go to next lesson, we're not in a course!")};a.os=x.os(!1);a.isActiveMorsel=function(b){return a.morsel&&a.morsel.key===b};a.getProgressPercentage=function(){return 77};var C}]);angular.module("controllers.lesson").controller("classroomPlayer",["$scope","lesson","$timeout",function(a,b,c){a.isPlayerLoading=!0;a.loadingComplete=function(b){b?c(function(){a.$apply(function(){a.isPlayerLoading=!1})},0,!1):a.isPlayerLoading=!1};b.addEventListener("pendingMorselChange",function(b){a.isPlayerLoading=b.from&&("Video"===b.from.model||"SketchVideo"===b.from.model)&&("Video"===b.to.model||"SketchVideo"===b.to.model)?!1:!0})}]);angular.module("controllers.lesson").controller("programmingQuizPanel",["$scope","lesson","programmingQuiz",function(a,b,c){a.status="unsubmitted";a.quizReturn=null;a.attempted=!1;a.answeredCorrectly=!1;a.submitProgrammingQuiz=function(){c.submit();a.status="processing";a.quizReturn=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Submit"};b.addEventListener("morselChange",function(){a.quizReturn=null;a.attempted=!1;a.answeredCorrectly=!1},{replayLast:!0,removeOnDestructionOf:a});
c.addEventListener("evaluated",function(b){a.status="evaluated";a.attempted=!0;var b=b.result,c=Math.round(100*(b.score.points_earned/b.score.points_possible));a.quizReturn={status:100===c?"correct":"incorrect",text:b.comment};100===c&&(a.answeredCorrectly=!0)},{removeOnDestructionOf:a});c.addEventListener("evaluationError",function(){a.status="error";a.attempted=!0;a.quizReturn={status:"incorrect",text:"There was an error grading your quiz, please try submitting again."}},{removeOnDestructionOf:a})}]);angular.module("services.lesson").constant("loadingMessages",{general:"The instructor is setting up the classroom;Thanks for waiting while we prepare the classroom;Dust off your slide-rule...;Cleaning the whiteboard;Adding duplication fluid to our ditto machine...;Reticulating Splines;Contemplating banana bread recipes;Once you have completed the course, cake will be served;Check the Wiki for each class to find helpful course notes and other information from fellow Udacians!;Did you know you can meet other Udacians on the Forums?".split(";"),
ma006:["We recommend having a pencil and paper handy for this class."],ma008:["We recommend having a pencil and paper handy for this class."],st095:["We recommend having a pencil and paper handy for this class.",'Want to read about some fascinating real-world statistics? Check out Dan Ariely\'s book "Predictably Irrational"!']}).constant("congratulatoryMessages",{endOfLesson:["You made it to the end of the lesson. Great job!"],endOfCourse:["You made it to the end of the last lesson for the course! Fantastic work!"],
endOfIncompleteCourse:["You made it to the end of the lesson. Good work! This is the last lesson available right now, but more will be up soon. We'll send you an email as soon as we add additional content."]});angular.module("controllers.lesson").controller("programmingQuizOutputPanel",["$scope","lesson","programmingQuiz",function(a,b,c){a.status="unsubmitted";a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.run=function(){c.run();a.status="processing";a.stdout=null;a.stderr=null;a.images=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Test Run"};a.reset=function(){window.confirm("Are you sure you want to reset to the original assignment stub?")&&c.reset()};b.addEventListener("morselChange",
function(){a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.status="unsubmitted"},{replayLast:!0,removeOnDestructionOf:a});c.addEventListener("run",function(b){a.status="evaluated";a.stdout=b.result.stdout;a.stderr=b.result.stderr;a.images=b.result.images;if(!a.stdout&&!a.stderr&&(!a.images||0===a.images.length)&&!a.isEmbeddingIframe)a.stdout="Your code didn't display any output"},{removeOnDestructionOf:a});c.addEventListener("runError",function(){a.stderr="The server encountered an error. Please try running again.";
a.status="error"},{removeOnDestructionOf:a});c.addEventListener("ready",function(){a.ready=!0},{removeOnDestructionOf:a})}]);angular.module("controllers.editor").controller("SketchCtrl",["$scope","$timeout","audio",function(a,b,c){a.saving={audio:!1,strokes:!1};a._fullscreen=!1;a.colors={black:"#000000",red:"#FF0000",green:"#00FF00",blue:"#0000FF"};a.activeColor=a.colors.black;a.lineWidth=0.003;a.setColor=function(b){a.activeColor=b};a.fullscreen=function(b){return a._fullscreen?b+" fullscreen":b};a.setFullscreen=function(){if(!a._fullscreen){a._fullscreen=!0;var b=document.getElementById("sketch-recorder"),d=$("#sketch-container"),
c=$(window).width(),f=$(window).height(),l=c-1,g=f-38;1<9*l/(16*g)?(b.width=16*g/9,b.height=g):(b.width=l,b.height=9*l/16);d.width(c);d.height(f);e=Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2))}};a.unsetFullscreen=function(){if(a._fullscreen){a._fullscreen=!1;var b=document.getElementById("sketch-recorder"),d=$("#sketch-container");b.width=640;b.height=360;d.css("width","auto");d.css("height","auto");e=Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2))}};a.$watch("selectedMorsel",function(){a.reset()});
a.reset=function(){a.clear();j=[];a.record=!1;a.stopped=!0;a.down=!1;a.startTime=0;a.sketchTime=0};a.save=function(){a.saving.audio=!0;a.saving.strokes=!0;a.uploadMediaBlob(a.wavBlob(),"audio",function(){a.$apply(function(a){a.saving.audio=!1})});a.uploadMediaBlob(a.strokesBlob(),"strokes",function(){a.$apply(function(a){a.saving.strokes=!1})})};a.load=function(){UY.ajaxREST("GET /nodes/"+a.node.key+"/strokes",{},function(a){j=$.parseJSON(a).visual});a.node._audio_in_progress&&UY.ajaxREST("GET /nodes/"+
a.node.key+"/audio_in_progress",{},function(){});a.node._audio&&UY.ajaxREST("GET /nodes/"+a.node.key+"/audio",{},function(){})};a.$watch(function(){return c.currentTime()},function(){a.audioTime=c.currentTime()});a.startRecording=function(){c.startRecording();a.clear();a.stop();j=[];a.record=!0;a.startTime=(new Date).getTime()};a.stopRecording=function(){c.stopRecording();a.record=!1};a.clear=function(){f.clearRect(0,0,d.width,d.height);a.sketchTime=0;a.stroke=0;a.index=0};a.drawWaveform=function(){h.clearRect(0,
0,g.width,g.height);h.fillStyle="#000000";a.bounds&&h.fillRect(c.waveformIndexFromTime(a.bounds.inpoint),0,c.waveformIndexFromTime(a.bounds.outpoint-a.bounds.inpoint),31);if(c.waveform)for(var b=0;b<c.waveform.length;b++){var d=b+0.5;if(c.waveformCurrentIndex()===b)h.strokeStyle="#000099",h.beginPath(),h.moveTo(d,0),h.lineTo(d,31);else{h.strokeStyle=a.bounds&&b>c.waveformIndexFromTime(a.bounds.inpoint)&&b<c.waveformIndexFromTime(a.bounds.outpoint)?"#55FFFF":"#990000";var e=Math.floor(c.waveform[b]/
0.0667),f=15-e,e=16+e;h.beginPath();h.moveTo(d,f);h.lineTo(d,e)}h.stroke()}};a.stop=function(){a.stopped=!0;c.stop()};a.play=function(){a.stopped=!1;c.play()};a.$watch("audioTime",function(){a.record||a.seek(a.audioTime);a.drawWaveform()});a.seek=function(b){b<a.sketchTime&&a.clear();if(0!==j.length&&!(a.stroke>=j.length)){var c=!0;a.activeColor=j[a.stroke].meta.color;a.lineWidth=j[a.stroke].meta.width;for(0<a.index&&a.index--;a.sketchTime<b;){var l=j[a.stroke].points_and_times[a.index];a.sketchTime=
l[2];0===a.index||c?(c=!1,f.beginPath(),f.strokeStyle=a.activeColor,f.lineWidth=a.lineWidth*e,f.moveTo(l[0]*d.width,l[1]*d.height)):f.lineTo(l[0]*d.width,l[1]*d.height);a.index++;if(a.index===j[a.stroke].points_and_times.length){f.stroke();a.index=0;a.stroke++;if(a.stroke>=j.length)return;a.activeColor=j[a.stroke].meta.color;a.lineWidth=j[a.stroke].meta.width}}f.stroke()}};a.activeColorClass=function(b){return b===a.activeColor?"color-patch active":"color-patch"};a.mouseDown=function(b){if(a.record){var c=
b.offsetX,b=b.offsetY;f.beginPath();f.moveTo(c,b);a.down=!0;a.sketchTime=((new Date).getTime()-a.startTime)/1E3;l=[[c/d.width,b/d.height,a.sketchTime]]}};a.mouseUp=function(b){if(a.record){var c=b.offsetX,b=b.offsetY;a.down=!1;f.stroke();a.sketchTime=((new Date).getTime()-a.startTime)/1E3;l.push([c/d.width,b/d.height,a.sketchTime]);j.push({type:"stroke",meta:{color:a.activeColor,width:a.lineWidth},points_and_times:l})}};a.mouseMove=function(b){if(a.record){var c=b.offsetX,b=b.offsetY;a.down&&(f.lineTo(c,
b),f.strokeStyle=a.activeColor,f.lineWidth=a.lineWidth*e,f.stroke(),f.beginPath(),f.moveTo(c,b),a.sketchTime=((new Date).getTime()-a.startTime)/1E3,l.push([c/d.width,b/d.height,a.sketchTime]))}};a.timelineMouseDown=function(b){var d=document.getElementById("waveform").offsetLeft,b=c.timeFromWaveformIndex(b.clientX-d);b>c.duration()&&(b=c.duration());a.timelineDown=!0;a.bounds={inpoint:b,outpoint:b,start:b};c.seek(b)};a.timelineMouseUp=function(){a.timelineDown=!1;c.seek(a.bounds.inpoint)};a.timelineMouseMove=
function(b){if(a.timelineDown){var d=document.getElementById("waveform").offsetLeft,b=c.timeFromWaveformIndex(b.clientX-d);b>c.duration()&&(b=c.duration());c.seek(b);b<=a.bounds.start?(a.bounds.inpoint=b,a.bounds.outpoint=a.bounds.start):(a.bounds.outpoint=b,a.bounds.inpoint=a.bounds.start)}};a.cut=function(b){if(b){for(var d=b.outpoint-b.inpoint,e=0;e<j.length;e++)for(var f=0;f<j[e].points_and_times.length;f++){var l=j[e].points_and_times[f];l[2]>b.inpoint&&(l[2]=l[2]<b.outpoint?b.inpoint:l[2]-d)}c.cut(b);
a.bounds=void 0;a.drawWaveform()}};a.duration=function(){return c.duration()};a.waveform=function(){return c.waveform};a.playIndex=function(){return c.playIndex};a.strokesBlob=function(){return new Blob([JSON.stringify({visual:j,aspect:d.width/d.height})],{type:"application/json"})};a.wavBlob=function(){return WavEncoder(c.buffer)};a.uploadMediaBlob=function(b,d,c){UY.ajaxREST("GET /nodes/"+a.node.key+"/"+d+"/upload_url?fresh=true",{},function(a){var e=new FormData;e.append("file",b);var f=new XMLHttpRequest;
f.addEventListener("load",function(a){200!==a.srcElement.status?(alert("Error saving "+d+"\n"+a),c("ERROR")):c("COMPLETE")},!1);f.addEventListener("error",function(a){alert("Error saving "+d+"\n"+a);c("ERROR")},!1);f.open("POST",a.url);f.setRequestHeader("X-XSRF-Token",document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2]);f.send(e)})};var d=document.getElementById("sketch-recorder"),e=Math.sqrt(Math.pow(d.width,2)+Math.pow(d.height,2)),f=d.getContext("2d"),g=document.getElementById("waveform"),
h=g.getContext("2d"),j=[],l=[];c.addEventListener("bufferRead",function(){a.$apply(function(a){a.audioTime=c.currentTime()})});c.addEventListener("end",function(){a.$apply(function(a){a.stopped=!0})});document.addEventListener("keypress",function(b){105===b.keyCode&&(a.bounds?a.bounds.inpoint=a.audioTime:a.bounds={inpoint:a.audioTime,outpoint:a.audioTime,start:a.audioTime},a.bounds.inpoint>a.bounds.outpoint&&(a.bounds.outpoint=a.bounds.inpoint),a.drawWaveform());111===b.keyCode&&(a.bounds?a.bounds.outpoint=
a.audioTime:a.bounds={inpoint:a.audioTime,outpoint:a.audioTime,start:a.audioTime},a.bounds.outpoint<a.bounds.inpoint&&(a.bounds.inpoint=a.bounds.outpoint),a.drawWaveform());32===b.keyCode&&(a.stopped?a.play():a.stop());120===b.keyCode&&a.$apply(function(){a.cut(a.bounds)})});a.reset()}]);angular.module("controllers.editor").controller("LessonChooserCtrl",["$scope","$location","localdb",function(a,b,c){window.onbeforeunload=void 0;c.course=void 0;a.newLesson=function(){b.path("/danger_editor/lesson/new")};a.newCourse=function(){b.path("/danger_editor/course/new")};UY.ajaxREST("GET /nodes/lessons?fresh=true",{},function(b){a.$apply(function(){a.data=b;a.courses=b.lessons.filter(function(a){return a.catalog_entry});a.lessons=b.lessons.filter(function(a){return!a.catalog_entry});var c=
function(a,b){return Date.parse(b.last_edit_time)-Date.parse(a.last_edit_time)};a.lessons=a.lessons.sort(c);a.courses=a.courses.sort(c)})})}]).controller("EditorCtrl",["$scope",function(){}]).controller("LessonLayoutCtrl",["$scope","localdb",function(a){a.clickOnNode=function(b,c){c&&c.stopPropagation();a.selectedNode=b}}]).controller("MicroUserInfoCtrl",["$scope","api",function(a,b){a.$watch("userRef",function(){a.userRef&&b.get("/users/"+encodeURIComponent(a.userRef.key)+"?fresh=true").success(function(b){a.user=
b.user}).error(function(){a.user={error:"Invalid User"}})});a.removeUser=function(b){b.preventDefault();a.$emit("removeUser",{key:a.userRef.key})}}]).controller("LessonListCtrl",["$scope","$attrs","localdb",function(a,b,c){a.nodeType=b.nodeType;a.parentNode=a.$parent.node;a.click=function(){a.$emit("selectNode",{node:a.node})};a.dontSelect=function(a){a.stopPropagation();return!1};a.$watch("nodeRef",function(){a.node=a.nodeRef?c.nodes[a.nodeRef.key]:void 0});a.$watch(function(){if(a.nodeRef)return c.nodes[a.nodeRef.key]},
function(){a.nodeRef&&(a.node=c.nodes[a.nodeRef.key])});a.$watch("node",function(){if(a.node){var b=function(a){if(!a)return"-";switch(a.model){case "Exercise":return b(c.getNode(a.lecture_ref))+b(c.getNode(a.quiz_ref))+b(c.getNode(a.answer_ref));case "Video":return a._video?"V":a._video_in_progress?"u":"v";case "ImageFormQuiz":return"CodeGradedEvaluator"===a.evaluator.model||"LegacyCodeGradedEvaluator"===a.evaluator.model?a._background_image&&0<a.evaluator.gae_grading_code.length?"G":"g":"FormQuizEvaluator"===
a.evaluator.model?a._background_image&&a.widgets&&0<a.widgets.length?"Q":"q":"?";case "Sketch":return"S";case "EmbeddedFrame":return 0<a.external_uri.length?"F":"f";case "Lesson":return 0===a.steps_refs.length?"l":"L";case "ProgrammingQuiz":return"ProgramEvaluator"===a.evaluator.model||"LegacyProgramEvaluator"===a.evaluator.model?0<a.initial_code_files[0].text.length&&0<a.evaluator.executor_test_code.length&&0<a.evaluator.gae_grading_code.length?"P":"p":"IFrameEvaluator"===a.evaluator.model?0<a.initial_code_files[0].text.length&&
0<a.evaluator.gae_grading_code.length&&0<a.evaluator.js_application.length&&0<a.evaluator.html_body.length?"H":"h":"?";default:return"?"}};a.subBits="["+b(a.node)+"]"}},!0)}]).controller("VideoCtrl",["$scope",function(a){a.setFile=function(b){a.$apply(function(a){1!==b.files.length?(console.warn("Did not select exactly 1 file, so no file prepped for upload"),a.node.__FILE_video=void 0):a.node.__FILE_video=b.files[0]})};var b=function(){a.ytPlayer&&(a.node._video&&a.node._video.youtube_id)&&a.ytPlayer.cueVideoById(a.node._video.youtube_id)};
a.$watch("node._video.youtube_id",b);a.$watch("ytPlayer",b)}]);angular.module("controllers.editor").controller("ExerciseCtrl",["$scope","localdb",function(a,b){a.$on("selectNode",function(b,c){b.stopPropagation();a.selectedNode=c.node});a.$watch("node",function(){a.selectedNode&&(a.selectedNode=b.getNode(a.selectedNode.key))});a.$on("droppedNode",function(d,c){if(void 0===c.droppedOn){var f=b.nodes[c.droppedKey];if(!f){d.stopPropagation();return}if("lecture"===c.type&&!a.node.lecture_ref&&("Video"===f.model||"Sketch"===f.model||"EmbeddedFrame"===f.model)){a.node.lecture_ref=
{ref:"Node",key:c.droppedKey};a.node.answer_ref&&a.node.answer_ref.key===c.droppedKey&&(a.node.answer_ref=void 0);return}if("answer"===c.type&&!a.node.answer_ref&&("Video"===f.model||"Sketch"===f.model||"EmbeddedFrame"===f.model)){a.node.answer_ref={ref:"Node",key:c.droppedKey};a.node.lecture_ref&&a.node.lecture_ref.key===c.droppedKey&&(a.node.lecture_ref=void 0);return}if("quiz"===c.type&&!a.node.quiz_ref&&("ImageFormQuiz"===f.model||"ProgrammingQuiz"===f.model)){a.node.quiz_ref={ref:"Node",key:c.droppedKey};
return}}d.stopPropagation()});var c=function(){if(a.selectedNode&&(!a.node.lecture_ref||a.node.lecture_ref.key!==a.selectedNode.key)&&(!a.node.quiz_ref||a.node.quiz_ref.key!==a.selectedNode.key)&&(!a.node.answer_ref||a.node.answer_ref.key!==a.selectedNode.key))a.selectedNode=void 0};a.$watch("node.lecture_ref",function(){c()});a.$watch("node.answer_ref",function(){c()});a.$watch("node.quiz_ref",function(){c()});a.isSelected=function(b){return a.selectedNode&&b===a.selectedNode}}]);angular.module("controllers.editor").controller("WidgetCtrl",["$scope",function(a){a.$watch("widget",function(){"MathInputWidget"===a.widget.model&&(a.isMath=!0);if("NumericInputWidget"===a.widget.model){var b=a.evaluatorForMarker(a.widget.marker);b.__upper_bound=String(b.upper_bound);b.__lower_bound=String(b.lower_bound)}});a.$watch("widget.marker",function(){a.updateMarkers()});a.toggleMath=function(){a.widget.model=a.isMath?"MathInputWidget":"TextInputWidget"};a.validateNumeric=function(){a.invalid=
!1;var b=a.evaluatorForMarker(a.widget.marker),c=parseFloat(b.__upper_bound),d=parseFloat(b.__lower_bound);isNaN(c)&&(a.invalid=!0,c=0);isNaN(d)&&(a.invalid=!0,d=0);b.upper_bound=c;b.lower_bound=d;c<d&&(a.invalid=!0)}}]).controller("QuizCtrl",["$scope","localdb","content",function(a,b,c){a.$watch("node",function(){a.updatePrimaryEvaluator()});a.updatePrimaryEvaluator=function(){a.node||(a.evaluator=void 0);for(var b=a.node.evaluator;b.evaluator;)b=b.evaluator;a.evaluator=b};a.$watch("groupSelected",
function(){a.node&&a.groupSelected&&angular.forEach(a.node.widgets,function(b){if("RadioButtonWidget"===b.model){var c=a.groupSelected[b.group]===b.marker;a.evaluatorForMarker(b.marker).answer=c}})},!0);a.groupName=function(){if(!a.groupNames[a.group]){var b=a.groupNames,c=a.group,f=[];angular.forEach(a.groupNames,function(a){f.push(a)});for(var g=0,h=0;h<f.length;h++)"group"+g===f[h]&&(g++,h=-1);b[c]="group"+g}return a.groupNames[a.group]};a.loadExistingWidgets=function(){a.group=0;a.groupNames=
{};a.groupSelected={};var b=0;angular.forEach(a.node.widgets,function(c){if("RadioButtonWidget"===c.model){var f=c.group,g;angular.forEach(a.groupNames,function(a,b){a===f&&(g=b)});g||(a.groupNames[b]=c.group,b++);a.evaluatorForMarker(c.marker).answer&&(a.groupSelected[c.group]=c.marker)}})};a.groupUp=function(){a.group++};a.groupDown=function(){0<a.group&&a.group--};a.evaluatorForMarker=function(b){if("FormQuizEvaluator"===a.evaluator.model)for(var c=a.evaluator.answer_sets[0].widget_graders,f=0;f<
c.length;f++)if(c[f].marker===b)return c[f];console.warn("no matching evaluator")};a.widgetForMarker=function(b){for(var c=0;c<a.node.widgets.length;c++)if(a.node.widgets[c].marker===b)return a.node.widgets[c]};a.updateMarkers=function(){if(a.isGradedQuiz()&&"LegacyCodeGradedEvaluator"!==a.evaluator.model){a.evaluator.markers=[];for(var b=0;b<a.node.widgets.length;b++)a.evaluator.markers.push(a.node.widgets[b].marker)}};a.nextTabIndex=function(){for(var b=1,c=0;c<a.node.widgets.length;c++)a.node.widgets[c].tabindex>=
b&&(b=a.node.widgets[c].tabindex+1);return b};a.addWidget=function(b,c){b.tabindex=a.nextTabIndex();for(var f=0,g=0;g<a.node.widgets.length;g++)a.node.widgets[g].marker===f.toString()&&(f++,g=-1);b.marker=f.toString();a.node.widgets.push(b);c&&"FormQuizEvaluator"===a.evaluator.model?(c.marker=b.marker,a.evaluator.answer_sets[0].widget_graders.push(c)):("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)&&"TextInputWidget"===b.model&&a.evaluator.markers.push(b.marker)};
a.newRadio=function(){var b=new c.RadioButtonWidget;b.group=a.groupName();var e=new c.SelectionEvaluator;a.addWidget(b,e)};a.newCheckbox=function(){var b=new c.CheckboxWidget,e=new c.SelectionEvaluator;a.addWidget(b,e)};a.newNumberField=function(){var b=new c.NumericInputWidget,e=new c.NumericalEvaluator;a.addWidget(b,e)};a.newRegexField=function(){var b=new c.TextInputWidget,e=new c.RegexEvaluator;a.addWidget(b,e)};a.newMultilineRegexField=function(){var b=new c.TextInputWidget;b.text_area=!0;var e=
new c.RegexEvaluator;a.addWidget(b,e)};a.newUnevaluatedTextField=function(){var b=new c.TextInputWidget;a.addWidget(b)};a.newMultilineUnevaluatedTextField=function(){var b=new c.TextInputWidget;b.text_area=!0;a.addWidget(b)};a.deleteWidget=function(b){for(var c=0;c<a.node.widgets.length&&a.node.widgets[c].marker!==b;c++);if(c!==a.node.widgets.length){var c=a.node.widgets.splice(c,1)[0],f;if("FormQuizEvaluator"===a.evaluator.model){var g=a.evaluator.answer_sets[0].widget_graders;for(f=0;f<g.length;f++)g[f].marker===
b&&g.splice(f,1)}else if("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)for(f=0;f<a.evaluator.markers.length;f++)a.evaluator.markers[f]===b&&a.evaluator.markers.splice(f,1);"RadioButtonWidget"===c.model&&a.groupSelected[c.group]===c.marker&&(a.groupSelected[c.group]=void 0)}};a.updateWidgetPosition=function(b,c,f){if(0>c||0>f||1<c||1<f)return confirm("Are you sure you want to delete this widget?")?(a.$apply(function(a){a.deleteWidget(b)}),!0):!1;var g=a.widgetForMarker(b);
g.placement.x=c;g.placement.y=f;return!0};a.isGradedQuiz=function(){return a.node&&a.evaluator&&("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)};a.setFile=function(b){a.$apply(function(a){if(1!==b.files.length)console.warn("Did not select exactly 1 file, so no file prepped for upload"),a.node.__FILE_background_image=void 0,a.node.__URL_background_image=void 0;else{var c=b.files[0];a.node.__FILE_background_image=c;var g=new FileReader;g.onload=function(b){var c=
b.target.result;a.$apply(function(a){a.node.__URL_background_image=c})};g.readAsDataURL(c)}})};a.$watch(function(){return b.nodes[a.node.key]},function(){a.node=b.nodes[a.node.key];a.loadExistingWidgets()})}]);angular.module("controllers.editor").controller("LessonCtrl",["$scope","localdb","$routeParams","$location","content","api",function(a,b,c,d,e,f){f.get("/code_packages?fresh=true").success(function(a){b.codePackages=a.packages;console.log(b.codePackages)}).error(function(){alert("Error fetching Programming quiz template information.  The editor will not workfor programming quizzes.  Try re-loading the page, if this message appears again tell Mike")});a.$on("$locationChangeStart",function(b){a.dirty&&
(window.confirm("You will lose any unsaved changes if you leave this page.  Are you sure?")||b.preventDefault())});b.course?(a.backTo=b.course,a.courseKeyForViewer=b.course.key):a.courseKeyForViewer="none";a.$on("selectNode",function(b,c){a.selectedNode=c.node});a.$on("uploadComplete",function(c,d){console.log("Got event uploadComplete in LessonCtrl");UY.ajaxREST("GET /nodes/"+d.node+"?fresh=true",{},function(c){a.$apply(function(){angular.forEach(c.references.Node,function(a){b.nodes[a.key]=a})})})});
a.$on("droppedNode",function(c,d){var e=b.nodes[d.droppedKey];if(void 0!==d.droppedOn){if(0<=a.nodeIndex(d.droppedOn)){if(d.droppedOn.key===d.droppedKey)return;a.moveToAfter(e,d.droppedOn)}a.selectedNode&&"Exercise"===a.selectedNode.model&&(a.selectedNode.lecture_ref&&a.selectedNode.lecture_ref.key===e.key&&(a.selectedNode.lecture_ref=null),a.selectedNode.quiz_ref&&a.selectedNode.quiz_ref.key===e.key&&(a.selectedNode.quiz_ref=null),a.selectedNode.answer_ref&&a.selectedNode.answer_ref.key===e.key&&
(a.selectedNode.answer_ref=null))}else a.removeStep(e)});a.$watch(function(){return b.nodes},function(){a.nodeJustLoaded?a.nodeJustLoaded=!1:a.justLoaded||(a.dirty=!0,window.onbeforeunload=function(){return"You will lose any unsaved changes if you leave this page."})},!0);a.setLesson=function(c){a.lesson=c;b.lesson=c;"~"!==a.lesson.key.substr(0,1)&&(a.justLoaded=!0)};a.$watch(function(){return b.lesson},function(){a.justLoaded?(a.justLoaded=!1,a.dirty=!1,window.onbeforeunload=!1):(a.dirty=!0,window.onbeforeunload=
function(){return"You will lose any unsaved changes if you leave this page."})},!0);a.nodeIndex=function(a){if(!a)return!1;for(var c=0;c<b.lesson.steps_refs.length;c++)if(b.lesson.steps_refs[c].key===a.key)return c;return-1};a.addStep=function(c,d){if(void 0===d||d>b.lesson.steps_refs.length)d=b.lesson.steps_refs.length;b.lesson.steps_refs.splice(d,0,{ref:"Node",key:c.key});a.dirty=!0};a.removeStep=function(c){for(var d=0;d<b.lesson.steps_refs.length;d++)if(b.lesson.steps_refs[d].key===c.key)return d=
b.lesson.steps_refs.splice(d,1)[0],a.dirty=!0,a.selectedNode===c&&(a.selectedNode=void 0),d};a.clickRemoveNode=function(b){confirm("Are you sure you want to delete this node?")&&a.removeStep(b)};a.moveToAfter=function(b,c){var d=a.nodeIndex(c);if(-1===d)return!1;a.removeStep(b);d=a.nodeIndex(c)+1;a.addStep(b,d)};a.newLesson=function(){a.setLesson(new e.Lesson)};a.uploadMediaFile=function(c,d,e,g){a.mediaFilesFailed||(a.mediaFilesFailed=0);if(void 0===g)g=0,a.mediaFilesToUpload+=1;else{if(3<=g){console.error("Too many retries on "+
d+"/"+e+".  Giving up :(");a.mediaFilesFailed+=1;return}g++;console.warn("Retrying upload of "+d+"/"+e+" for the "+g+" time.")}var h="/nodes/"+d+"/"+e+"/upload_url?fresh=true";a.doNotProcessVideoUploads&&(h+="&process=false");f.get(h).success(function(h){var j=new FormData;j.append("file",c);var s=new XMLHttpRequest;s.upload.addEventListener("progress",function(a){a.lengthComputable&&(a=Math.round(100*a.loaded/a.total),console.log(c.name+" : "+a+"%"))},!1);s.addEventListener("abort",function(){console.error("Aborted "+
c.name);a.$apply(function(a){a.uploadMediaFile(c,d,e,g)})},!1);s.addEventListener("load",function(h){200!==h.srcElement.status?(console.error("Error saving "+e+"\n"+h),a.$apply(function(a){a.uploadMediaFile(c,d,e,g)})):(console.log(c.name+" success!!!!"),a.$apply(function(a){a.mediaFilesUploaded+=1;console.log(a.mediaFilesUploaded+" uploaded");f.get("/nodes/"+d+"?fresh=true").success(function(c){console.log(c);b.nodes[d]=c.references.Node[d];a.nodeJustLoaded=!0;a.selectedNode&&a.selectedNode.key===
d&&(a.selectedNode=b.nodes[d])})}))},!1);s.addEventListener("error",function(b){console.error("Error saving "+c.name+"\n"+b);a.$apply(function(a){a.uploadMediaFile(c,d,e,g)})},!1);s.open("POST",h.url);s.setRequestHeader("X-XSRF-Token",document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2]);s.send(j)}).error(function(b){console.error(b);a.$apply(function(a){a.uploadMediaFile(c,d,e,g)})})};a.$watch("mediaFilesUploaded",function(){a.mediaFilesUploaded===a.mediaFilesToUpload&&(a.mediaFilesToUpload=
0)});var g=function(c){console.log(c);var e,f,g;e=b.lesson.key;for(var h in c.references.Node)if(c.references.Node.hasOwnProperty(h)){var j=c.references.Node[h];b.nodes[j.key]=j}for(g in c.key_changes)if(c.key_changes.hasOwnProperty(g)&&g===e){e=c.key_changes[e];break}e=b.nodes[e];d.path("/danger_editor/lesson/"+e.key);void 0===e&&alert("Error, lesson wasn't returned on save");a.setLesson(e);a.mediaFilesToUpload=0;a.mediaFilesUploaded=0;for(f in c.key_changes)c.key_changes.hasOwnProperty(f)&&(e=c.key_changes[f],
(h=b.nodes[f])&&(h.__FILE_background_image?a.fileUploadData.push({file:h.__FILE_background_image,key:e,type:"background_image"}):h.__FILE_video&&a.fileUploadData.push({file:h.__FILE_video,key:e,type:"video"})));angular.forEach(a.fileUploadData,function(b){a.uploadMediaFile(b.file,b.key,b.type)});if(a.selectedNode){e=f=a.selectedNode.key;for(g in c.key_changes)c.key_changes.hasOwnProperty(g)&&f===g&&(e=c.key_changes[g]);a.selectedNode=b.nodes[e]}a.busyText="";a.dirty=!1},h=function(c){a.failedSaves+=
1;switch(a.failedSaves){case 1:a.busyText="<p>There was an error saving this lesson.  Retrying...</p>";break;case 2:a.busyText="<p>There was an error saving this lesson.  Retrying again...</p>";break;case 3:a.busyText="<p>There was an error saving this lesson.  Retrying for the last time...</p>";break;default:a.busyText="<p>There was an error saving this lesson.  You will have to reload this page.  Some part of your work may have been saved, please report this to Mike.</p><pre>"+c.error+"</pre>"}3>=
a.failedSaves&&a.lesson&&"~"!==a.lesson.key.substr(0,1)&&f.get("/nodes/"+a.lesson.key+"?depth=2&fresh=true").success(function(c){angular.forEach(c.references.Node,function(c){var d=b.nodes[c.key];d&&(d.last_edit_time=c.last_edit_time);c.key===a.lesson.key&&(a.lesson.last_edit_time=c.last_edit_time)});j()})},j=function(){var c;var d={nodes:[]};a.fileUploadData=[];try{for(var e=function(b){d.nodes.push(b);"~"!==b.key.substr(0,1)&&(b.__FILE_background_image?a.fileUploadData.push({file:b.__FILE_background_image,
key:b.key,type:"background_image"}):b.__FILE_video&&a.fileUploadData.push({file:b.__FILE_video,key:b.key,type:"video"}))},j=0;j<b.lesson.steps_refs.length;j++){var s=b.nodes[b.lesson.steps_refs[j].key];if("Exercise"===s.model)for(var p=s,r=["lecture_ref","quiz_ref","answer_ref"],w=0;w<r.length;w++){var q=r[w];p[q]&&e(b.nodes[p[q].key])}e(s)}d.nodes.push(b.lesson);c=d}catch(z){console.log(z),a.busyText="<p>Error saving the lesson. None of your work was saved. Please tell Mike about this error.  If you leave this window open there is a small chance your changes can be recovered.</p><pre>"+
z+"</pre>",c=void 0}c?f.post("/nodes?fresh=true&_debug=true",c).success(g).error(h):a.busyText="<p>Unable to prepare lesson for saving.  Tell Mike!</p><pre>"};a.saveLesson=function(){a.busyText="Saving...";a.failedSaves=0;j()};a.bulkImport=function(c){if(c)a.$apply(function(a){a.bulkFiles=[];for(var b=0;b<c.files.length;b++)a.bulkFiles.push(c.files[b]);0===a.bulkFiles.length&&(a.bulkFiles=void 0)});else{var d=[],e=[];angular.forEach(a.bulkFiles,function(c){var f=c.name,g=f.split("."),l=f,h;1<g.length&&
(h=g[g.length-1].toLowerCase(),l=g.slice(0,g.length-1).join(""));(g=l.match(/^(\d{2,})_([lpqs])_(.*)/))&&(l=g[3].replace(/-/g," "));if("jpg"===h||"jpeg"===h){var j=b.newQuiz();j.title=l;j.__FILE_background_image=c;l=new FileReader;l.onload=function(b){var c=b.target.result;a.$apply(function(){j.__URL_background_image=c})};l.readAsDataURL(c);d.push(j)}else"mp4"===h||"mpeg"===h||"mpg"===h?(f=b.newVideo(),f.title=l,f.__FILE_video=c,d.push(f)):e.push(f)});if(0<e.length){var f="The following file types were not recognized.  Please check that you have only selected video and image files.\n\n";
angular.forEach(e,function(a){f+=a+"\n"});alert(f)}else angular.forEach(d,function(b){a.addStep(b)});a.bulkFiles=void 0}};a.createNewLesson=function(){"/danger_editor/lesson/new"===d.path()?document.location.reload():d.path("/danger_editor/lesson/new")};a.$watch(function(){return c.lessonKey},function(){var b=c.lessonKey;"new"===b.toLowerCase()?a.newLesson():(!a.course||a.course.key!==c.lessonKey)&&a.loadLesson(b)});a.loadLesson=function(c){a.busyText="Loading...";f.get("/nodes/"+c+"?depth=2&fresh=true").success(function(d){console.log(d);
angular.forEach(d.references.Node,function(a){b.nodes[a.key]=a});d=b.nodes[c];"Lesson"!==d.model&&(alert("Node "+c+" is not a Lesson!"),a.busyText="",a.createNewLesson());void 0===d?alert("Error fetching lesson "+c):a.setLesson(d);a.busyText=""}).error(function(b){a.busyText="<p>There was an error loading this lesson.  If you think you should be able to edit this lesson, tell Mike</p><pre>"+b.error+"</pre>"})};a.isSelected=function(b){return a.selectedNode===b};a.isHovered=function(b){return a.hoveredNode===
b};a.addNewNode=function(b){b.affiliate_program_refs=angular.copy(a.lesson.affiliate_program_refs);a.addStep(b);a.selectedNode=b};a.newVideoMorsel=function(){var c=b.newVideo();a.addNewNode(c)};a.newFrameMorsel=function(){var c=b.newFrame();a.addNewNode(c)};a.newSketchMorsel=function(){var c=b.newSketch();a.addNewNode(c)};a.newQuizMorsel=function(){var c=b.newQuiz();a.addNewNode(c)};a.newGradedCodeMorsel=function(){var c=b.newQuiz();c.evaluator=new e.CodeGradedEvaluator;a.addNewNode(c)};a.newProgrammingMorsel=
function(){var c=b.newProgram();a.addNewNode(c)};a.newHTMLMorsel=function(){var c=b.newProgram();c.evaluator=new e.IFrameEvaluator;a.addNewNode(c)};a.newExerciseNode=function(){var c=b.newExercise();a.addNewNode(c)};a.emptyClick=function(b){b&&b.preventDefault();a.selectedNode=void 0};a.$on("dropped",function(){})}]);angular.module("controllers.editor").filter("selected",["$filter",function(){return function(a,b,c){return b?c:a}}]).filter("caseInsensitiveSubstring",["$filter",function(){return function(a,b){return _.filter(a,function(a){return a.name&&-1!==a.name.toLowerCase().indexOf(b.toLowerCase())})}}]).controller("ProgrammingGradingCtrl",["$scope","content","localdb","$filter",function(a,b,c){a.selectedGradingTab="test";a.codePackages=c.codePackages;a.searchText="";a.checked=!1;a.keyToPackage={};angular.forEach(a.codePackages,
function(b){a.keyToPackage[b.key]=b});a.$watch("evaluator",function(){a.tempLegacyTemplateRefs=[];angular.forEach(a.evaluator.legacy_template_refs,function(b){a.tempLegacyTemplateRefs.push(a.keyToPackage[b.key])})});a.updateTemplateRefs=function(){a.evaluator.legacy_template_refs=[];angular.forEach(a.tempLegacyTemplateRefs,function(b){a.evaluator.legacy_template_refs.push({ref:"ProgramTemplate",key:b.key})})};a.clearTemplateRefs=function(){a.evaluator.legacy_template_refs=[];a.tempLegacyTemplateRefs=
[]};a.setTestFile=function(b){a.$apply(function(a){if(0!==b.files.length){var c=new FileReader;c.onload=function(){a.$apply(function(a){a.evaluator.executor_test_code=c.result})};c.readAsText(b.files[0])}})};a.setGradingFile=function(b){a.$apply(function(a){if(0!==b.files.length){var c=new FileReader;c.onload=function(){a.$apply(function(a){a.evaluator.gae_grading_code=c.result})};c.readAsText(b.files[0])}})}}]).controller("IFrameGradingCtrl",["$scope","content","localdb",function(a){a.selectedGradingTab=
"html";a.htmlName="file.html";a.jsName="file.js";a.setGradingFile=function(b){a.$apply(function(a){if(0!==b.files.length){var d=new FileReader;d.onload=function(){a.$apply(function(a){a.evaluator.gae_grading_code=d.result})};d.readAsText(b.files[0])}})};a.setHTMLFile=function(b){a.$apply(function(a){if(0!==b.files.length){var d=new FileReader;d.onload=function(){a.$apply(function(a){a.evaluator.html_body=d.result})};d.readAsText(b.files[0])}})};a.setJSFile=function(b){a.$apply(function(a){if(0!==
b.files.length){var d=new FileReader;d.onload=function(){a.$apply(function(a){a.evaluator.js_application=d.result})};d.readAsText(b.files[0])}})}}]).controller("ProgrammingCtrl",["$scope","content","localdb",function(a,b){a.$watch("node",function(){a.updatePrimaryEvaluator()});a.updatePrimaryEvaluator=function(){a.node||(a.evaluator=void 0);for(var b=a.node.evaluator;b.evaluator;)b=b.evaluator;a.evaluator=b};a.selectedUserTab=0;a.userTabClick=function(b){a.selectedUserTab=b};a.deleteTabClick=function(b){confirm("Are you sure you want to delete this file?")&&
a.node.initial_code_files.splice(b,1)};a.addFile=function(){a.node.initial_code_files.push(new b.FileAttachement)};a.setFile=function(b,d){a.$apply(function(a){if(0!==b.files.length){var f=new FileReader;f.onload=function(){a.$apply(function(a){a.node.initial_code_files[d].text=f.result})};f.readAsText(b.files[0]);a.node.initial_code_files[d].name=b.files[0].name}})}}]);angular.module("controllers.editor").controller("CourseCtrl",["$scope","$routeParams","content","api","$location","localdb",function(a,b,c,d,e,f){a.$on("$locationChangeStart",function(b){if(a.dirty||a.lessonsDirty)window.confirm("You will lose any unsaved changes if you leave this page.  Are you sure?")||b.preventDefault()});a.nodeIndex=function(a){if(!a)return!1;for(var b=0;b<f.course.steps_refs.length;b++)if(f.course.steps_refs[b].key===a.key)return b;return-1};a.addStep=function(a,b){if(void 0===
b||b>f.course.steps_refs.length)b=f.course.steps_refs.length;f.course.steps_refs.splice(b,0,{ref:"Node",key:a.key})};a.removeStep=function(a){for(var b=0;b<f.course.steps_refs.length;b++)if(f.course.steps_refs[b].key===a.key)return f.course.steps_refs.splice(b,1)[0]};a.clickRemoveNode=function(b){confirm("Are you sure you want to delete this node?")&&a.removeStep(b)};a.moveToAfter=function(b,c){var d=a.nodeIndex(c);if(-1===d)return!1;a.removeStep(b);d=a.nodeIndex(c)+1;a.addStep(b,d)};a.$on("droppedNode",
function(b,c){c.droppedOn.key!==c.droppedKey&&a.moveToAfter(f.nodes[c.droppedKey],c.droppedOn)});a.setCourse=function(b){a.course=b;f.course=b;"~"!==a.course.key.substr(0,1)&&(a.justLoaded=!0)};a.newLesson=function(){var b=f.newLesson();b.affiliate_program_refs=angular.copy(a.course.affiliate_program_refs);a.course.steps_refs.push({ref:"Node",key:b.key})};a.addLesson=function(){alert("This feature is temporary disabled")};a.$watch(function(){return b.courseKey},function(){(!a.course||a.course.key!==
b.courseKey)&&a.loadFromKey(b.courseKey)});a.$watch(function(){return f.nodes},function(){a.justLoaded||(a.lessonsDirty=!0,a.dirty=!0,window.onbeforeunload=function(){return"You will lose any unsaved changes if you leave this page."})},!0);a.setAffiliation=function(b){console.log(b);a.course.affiliate_program_refs=[{ref:"AffiliateProgram",key:b}]};a.removeAffiliation=function(b){for(var c=0;c<a.course.affiliate_program_refs.length;c++)if(a.course.affiliate_program_refs[c].key===b){a.course.affiliate_program_refs.splice(c,
1);break}};a.createMasteryIfEmpty=function(){return!a.course.catalog_entry.mastery_spec?(a.course.catalog_entry.mastery_spec=new c.MasterySpec,alert("Course did not have a Mastery Spec defined, adding one.  You will need to save this Course."),!0):5!==a.course.catalog_entry.mastery_spec.badge_thresholds.length?(a.course.catalog_entry.mastery_spec.badge_thresholds.unshift(0),alert("Course mastery had to be updated to a new format.  Make sure the levels below appear correct and save changes."),!0):
!1};a.$watch("course",function(){var b=function(){a.dirty=!0;window.onbeforeunload=function(){return"You will lose any unsaved changes if you leave this page."}};a.justLoaded?(a.justLoaded=!1,a.createMasteryIfEmpty()?b():(a.dirty=!1,a.lessonsDirty=!1,window.onbeforeunload=void 0)):b()},!0);a.loadFromKey=function(e){a.busyText="Loading Course "+e;"new"===e.toLowerCase()?(a.setCourse(new c.Lesson),f[a.course.key]=void 0,a.course.catalog_entry=new c.CatalogEntry,a.course.title="New Course",a.busyText=
""):d.get("/nodes/"+e+"?depth=1&fresh=true").success(function(c){console.log(c);var d=c.references.Node[e];if(d.catalog_entry){a.setCourse(d);for(var g in c.references.Node)g!==b.courseKey&&(f.nodes[g]=c.references.Node[g]);a.busyText=""}else alert("This doesn't appear to be a valid course")}).error(function(b){a.busyText="<p>There was an error loading this course.  If you think you should be able to edit this course, tell Mike.</p><pre>"+b.error+"</pre>"})};var g=function(b){console.log(b);var c=
a.course.key;b.key_changes[c]&&(c=b.key_changes[c],e.path("/danger_editor/course/"+c));a.setCourse(b.references.Node[c]);for(var d in b.references.Node)d!==a.course.key&&(f.nodes[d]=b.references.Node[d]);a.busyText=""},h=function(b){a.failedSaves+=1;switch(a.failedSaves){case 1:a.busyText="<p>There was an error saving this course.  Retrying...</p>";break;case 2:a.busyText="<p>There was an error saving this course.  Retrying again...</p>";break;case 3:a.busyText="<p>There was an error saving this course.  Retrying for the last time...</p>";
break;default:a.busyText="<p>There was an error saving this course.  You will have to reload this page.  Some part of your work may have been saved, please report this to Mike.</p><pre>"+b.error+"</pre>"}3>=a.failedSaves&&a.course&&"~"!==a.course.key.substr(0,1)&&d.get("/nodes/"+a.course.key+"?depth=1&fresh=true").success(function(b){angular.forEach(b.references.Node,function(b){var c=f.nodes[b.key];c&&(c.last_edit_time=b.last_edit_time);a.course.key===b.key&&(console.log("updating course edit time"),
a.course.last_edit_time=b.last_edit_time)});j()})},j=function(){var b={nodes:[]};b.nodes.push(a.course);if(a.lessonsDirty){a.lessonsDirty=!1;console.log("saving lesson data as well");for(var c in f.nodes)if(f.nodes.hasOwnProperty(c))for(var e=0;e<a.course.steps_refs.length;e++)c===a.course.steps_refs[e].key&&b.nodes.push(f.nodes[c])}b?d.post("/nodes?fresh=true",b).success(g).error(h):a.busyText="<p>Unable to prepare course for saving.  Tell Mike!</p><pre>"};a.save=function(){a.busyText="Saving Course...";
a.failedSaves=0;j()};a.$on("removeUser",function(a,b){var c;if(confirm("Are you sure you want to remove this Instructor from the Course?")){for(c=0;c<f.course.catalog_entry.instructor_refs.length;c++)b.key===f.course.catalog_entry.instructor_refs[c].key&&f.course.catalog_entry.instructor_refs.splice(c,1);for(c=0;c<f.course.catalog_entry.assistant_refs.length;c++)b.key===f.course.catalog_entry.assistant_refs[c].key&&f.course.catalog_entry.assistant_refs.splice(c,1)}});a.newInstructor=function(a){var b=
prompt("Enter the instructor's e-mail address");b&&(a?f.course.catalog_entry.assistant_refs.push({ref:"User",key:b}):f.course.catalog_entry.instructor_refs.push({ref:"User",key:b}))};a.updateMastery=function(a){var b=parseFloat(f.course.catalog_entry.mastery_spec.badge_thresholds[a]);isNaN(b)&&(b=0);f.course.catalog_entry.mastery_spec.badge_thresholds[a]=b};a.addMasteryWeight=function(){f.course.catalog_entry.mastery_spec.weights.push({node_ref:{ref:"Node",key:"1"},points:1})};a.masteryInfo=function(a){for(var b,
c=0;c<f.course.steps_refs.length;c++)for(var d=f.nodes[f.course.steps_refs[c].key],e=0;e<d.steps_refs.length;e++)d.steps_refs[e].key===a&&(b=d.title+" - ");return b?b=(a=f.getNode(a,!0))&&a.title?b+a.title:b+"(loading...)":"Node key is not in this course."}}]);angular.module("services.utility").factory("callbackList",function(){return{create:function(){var a=[],b,c=!1,d={add:function(e,f,g){a.push(e);c&&f?(e(b),g&&d.remove(e)):g&&(e._removeOnFire=!0);return d},remove:function(b){for(var c=a.length,g=0;g<c;g++)a[g]===b&&(a.splice(g,1),g-=1);return d},fire:function(e){var f,g=a.length;for(f=0;f<g;f++)try{a[f](e)}catch(h){console.error("Exception encountered in callback:"+h.message)}b=e;c=!0;for(f=0;f<a.length;f++)!0===a[f]._removeOnFire&&(d.remove(a[f]),
f-=1);return d},_getCallbacks:function(){return a}};return d}}});angular.module("services.user").factory("user",["api","mixin","basicUser",function(a,b,c){for(var d="bio email emailPreferences employerSharing enrollments facebookId firstName googleId enrollments badges hasPassword imageUrl key lastName linkedinUrl location nickname occupation principals registered resume sitePreferences websiteUrl".split(" "),e=function(a,b){var c={},d;for(d in b)if(b.hasOwnProperty(d))if("object"===typeof b[d]){if("undefined"!==typeof a[d]&&null!==a[d]){var f=e(a[d],b[d][1]);
f!=={}&&(c[b[d][0]]=f)}}else c[b[d]]="undefined"!==typeof a[d]?a[d]:null;return c},f=function(a){a=e(a,{first_name:"firstName",last_name:"lastName",registered:"registered",image_url:"imageUrl",key:"key",has_password:"hasPassword",employer_sharing:"employerSharing",nickname:"nickname",email:["email",{verified:"verified",verification_code_sent:"verificationCodeSent",address:"address"}],email_preferences:["emailPreferences",{master_ok:"masterOK",ok_course:"okCourse"}],site_preferences:["sitePreferences",
{use_html5_player:"useHtml5Player",auto_advance:"autoAdvance",playback_rate:"playbackRate",video_quality:"videoQuality"}],enrollments:"enrollments",bio:"bio",occupation:"occupation",location:["location",{display_place:"displayPlace",places:"places",coordinates:"coordinates"}],linkedin_url:"linkedinUrl",website_url:"websiteUrl",facebook_id:"facebookId",google_id:"googleId",resume:["resume",{processing_state:"processingState",uri:"url",size:"size",last_upload_time:"lastUploadTime"}],_badges:"badges",
principals:"principals"});a.hasOwnProperty("emailPreferences")||(a.emailPreferences={masterOK:!0});return a},g=f(c),h={},c=0;c<d.length;c++)h[d[c]]=null;var j=b.eventEmission({userIsLoggedIn:function(){return g.registered},unsetUser:function(){for(var a=0;a<d.length;a++)h[d[a]]=null;j.emitEvent("userUnset",{user:h});j.emitEvent("userChanged",{user:h})},getUser:function(){return h},getBaseUser:function(){return g},setUser:function(a){for(var b=0;b<d.length;b++)a.hasOwnProperty(d[b])&&(h[d[b]]=a[d[b]]);
g=angular.copy(h);j.emitEvent("userSet",{user:h});j.emitEvent("userChanged",{user:h})},getUserProp:function(a){return h.hasOwnProperty(a)?h[a]:null},translateUserFromApi:f,isEnrolledIn:function(a){return 0<_.filter(h.enrollments,function(b){return b.node_key===a&&b.is_enrolled}).length},isCourseEmailSubscribed:function(a){return 0<_.filter(h.enrollments,function(b){return b.node_key===a&&b.email_ok}).length},changeEnrollment:function(b,c){var d={},e=c?"node_keys_to_join":"node_keys_to_leave";d[e]=
[b];a.post("/users/me/enrollments",d).success(function(a){h.enrollments=a.enrollments;a={action:"unenroll"};"node_keys_to_join"===e&&(a.action="enroll");UY.pushTrackingEvent("Enrollment",c?"Enroll":"Unenroll",b);j.emitEvent("changeEnrollmentComplete",a)}).error(function(){console.warn("Failed to join/leave course");j.emitEvent("changeEnrollmentComplete")})},changeEnrollmentSettings:function(b,c){a.post("/users/me/enrollments/"+encodeURIComponent(b)+"/settings",c).success(function(a){h.enrollments=
a.enrollments;j.emitEvent("changeEnrollmentSettingsComplete",a)}).error(function(){console.warn("Failed to change enrollment settings")})},requestPasswordReset:function(b){a.post("/users/send_password_reset_email",{email_address:b}).success(function(a,b,c,d){j.emitEvent("requestPasswordResetSuccess",{status:b,data:a,config:d,headers:c})}).error(function(a,b,c,d){j.emitEvent("requestPasswordResetFailure",{status:b,data:a,config:d,headers:c})})},requestUnsubscribe:function(b){a.post("/users/unsubscribe",
{email_address:b}).success(function(a,b,c,d){j.emitEvent("requestUnsubscribeSuccess",{status:b,data:a,config:d,headers:c})}).error(function(a,b,c,d){j.emitEvent("requestUnsubscribeFailure",{status:b,data:a,config:d,headers:c})})},resetPassword:function(b,c,d){a.post("/users/"+c+"/reset_password",{password:b,code:d}).success(function(a,b,c,d){j.emitEvent("resetPasswordSuccess",{status:b,data:a,config:d,headers:c})}).error(function(a,b,c,d){j.emitEvent("resetPasswordFailure",{status:b,data:a,config:d,
headers:c})})}},"userChanged userSet userUnset changeEnrollmentComplete changeEnrollmentSettingsComplete requestPasswordResetSuccess requestPasswordResetFailure requestUnsubscribeSuccess requestUnsubscribeFailure resetPasswordSuccess resetPasswordFailure".split(" "));return j}]);angular.module("services.lesson").factory("sketch",["$http","mixin",function(a,b){function c(a){a=a||0;p=[];r=[];w=[];for(var b=0;b<n.length;b++)n[b].drawnUpTo=0;for(b=0;b<n.length;b++)if(n[b].start>a){p=n.slice(b);r=n.slice(0,b);return}p=[];r=n.slice(0,n.length)}function d(a){for(var b=p.length,c=[],d=0;d<b&&!(p[d].start>a);d++)r.push(p[d]),c.push(d);for(b=c.length-1;0<=b;b--)p.splice(c[b],1);c=[];for(b=0;b<r.length;b++)if(d=r[b],"background"===d.type)e(d),w.push(d),c.push(b);else if(d.points_and_times[d.drawnUpTo][2]<
a){var f;f=d;var g=a;t.beginPath();t.lineWidth=f.meta.width;t.globalAlpha=f.meta.alpha;"erase"===f.type?t.globalCompositeOperation="destination-out":(t.strokeStyle=f.meta.color,t.globalCompositeOperation="source-over");for(var h=!0,j=f.drawnUpTo;j<f.points_and_times.length;j++)if(f.points_and_times[j][2]>g){f.drawnUpTo=j;break}else if(t.lineCap="round",h=!0,m)if(0===j)if(t.moveTo(f.points_and_times[f.drawnUpTo][0],f.points_and_times[f.drawnUpTo][1]),0<f.points_and_times.length){var k=l(f.points_and_times[0],
f.points_and_times[1]);t.lineTo(k[0],k[1])}else t.fillStyle=f.meta.color,t.arc(f.points_and_times[j][0],f.points_and_times[j][1],f.meta.width/2,0,2*Math.PI,!1),t.fill(),h=!1;else if(j===f.points_and_times.length-1)t.moveTo(f.points_and_times[j-1][0],f.points_and_times[j-1][1]),t.lineTo(f.points_and_times[j][0],f.points_and_times[j][1]);else{var k=l(f.points_and_times[j-1],f.points_and_times[j]),q=l(f.points_and_times[j],f.points_and_times[j+1]);t.moveTo(k[0],k[1]);1>t.globalAlpha&&(t.lineCap="butt");
t.quadraticCurveTo(f.points_and_times[j][0],f.points_and_times[j][1],q[0],q[1])}else 0===j?1===f.points_and_times.length&&(t.fillStyle=f.meta.color,t.arc(f.points_and_times[j][0],f.points_and_times[j][1],f.meta.width/2,0,2*Math.PI,!1),t.fill(),h=!1):(t.moveTo(f.points_and_times[j-1][0],f.points_and_times[j-1][1]),t.lineTo(f.points_and_times[j][0],f.points_and_times[j][1]));h&&t.stroke();f=j===f.points_and_times.length?!0:!1;!0===f&&(w.push(d),c.push(b))}for(a=c.length-1;0<=a;a--)r.splice(c[a],1)}
function e(a){if("color"===a.meta.type)B.fillStyle=a.meta.data,B.fillRect(0,0,v.width,v.height);else if("image"===a.meta.type){var b=new Image;b.onload=function(){B.drawImage(this,0,0,v.width,v.height)};b.src=a.meta.url}}function f(a){for(var b,c=x.width,d=x.height,e=Math.sqrt(c*c+d*d),f=0;f<a.length;f++)if(b=a[f],"omit"===b.type)a.splice(f,1),f--;else{b.start=b.points_and_times[0][2];b.end=b.points_and_times[b.points_and_times.length-1][2];b.drawnUpTo=0;if("stroke"===b.type||"erase"===b.type)b.meta.width=
1<b.meta.width?Math.ceil(b.meta.width/1129.235*e):Math.ceil(b.meta.width*e),"undefined"===typeof b.meta.alpha&&(b.meta.alpha=1);for(var g=0;g<b.points_and_times.length;g++)b.points_and_times[g][0]*=c,b.points_and_times[g][1]*=d}}function g(){d(q.currentTime);q.currentTime===q.duration?(z&&clearTimeout(z),h(A.ENDED)):z=setTimeout(g,30)}function h(a){k=a;u.emitEvent("stateChange",k)}function j(a){var b={};if("object"===typeof a){"undefined"!==typeof a.length&&(b=[]);for(var c in a)"object"===typeof a[c]?
b[c]=j(a[c]):"number"===typeof a[c]?b[c]=a[c]:"string"===typeof a[c]?b[c]=a[c]:"boolean"===typeof a[c]&&(b[c]=!0===a[c]?!0:!1)}return b}function l(a,b){return[(b[0]-a[0])/2+a[0],(b[1]-a[1])/2+a[1],(b[2]-a[2])/2+a[2]]}var k=-2,m=!0,n=[],s=[],p=[],r=[],w=[],q,z,y,x,t,v,B,A={UNLOADED:-2,UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2},u=b.eventEmission({attach:function(b,c){a.get(b._strokes.uri).success(function(a){var d=b._audio.transcodings,e=[{type:"audio/mpeg",src:"http://devel.knowitdevel.appspot.com/api/nodes/143004/audio/transcoding/mp3"},
{type:"audio/ogg",src:"http://devel.knowitdevel.appspot.com/api/nodes/143004/audio/transcoding/ogg"}];if(d&&(void 0!==d.mp3||void 0!==d.ogg))e=[{type:"audio/mpeg",src:d.mp3},{type:"audio/ogg",src:d.ogg}];u.init(a.visual,e,{components:c})})},init:function(a,b,e){h(A.UNLOADED);if(a&&b){s=a;n=j(a);e="undefined"!==typeof e?e:{};if("object"===typeof e.parent){e.size="undefined"!==typeof e.size?e.size:{width:960,height:500};e.oversample="undefined"!==typeof e.oversample?e.oversample:1;var a=e.parent,g=
e.size,e=e.oversample;q=x=v=y=void 0;for(var e="number"===typeof e?e:1,k=a.childNodes.length,l=0;l<k;l++)a.removeChild(a.firstChild);y=document.createElement("div");y.id="canvasroom-container";y.style.cssText="position: relative; height: "+g.height+"px; width: "+g.width+"px";k="position: absolute; top: 0; left: 0; z-index: 1; width: "+g.width+"px; height: "+g.height+"px;";v=document.createElement("canvas");v.id="canvasroom-background";v.width=g.width*e;v.height=g.height*e;v.setAttribute("style",k);
y.appendChild(v);x=document.createElement("canvas");x.id="canvasroom";y.appendChild(x);x.width=g.width*e;x.height=g.height*e;x.setAttribute("style",k);q=document.createElement("audio");q.id="canvasroomAudio";y.appendChild(q);a.appendChild(y)}else if("object"===typeof e.components.container&&"object"===typeof e.components.backgroundCanvas&&"object"===typeof e.components.canvas&&"object"===typeof e.components.audioEl)y=e.components.container,v=e.components.backgroundCanvas,x=e.components.canvas,q=e.components.audioEl;
else{console.error("You must pass in options.parent or options.components!");return}x.getContext&&v.getContext?(t=x.getContext("2d"),B=v.getContext("2d"),t.clearRect(0,0,x.width,x.height),t.lineCap="round",B.clearRect(0,0,v.width,v.height),f(n)):console.error("canvas with ID canvas-room not supported!");a=y;q&&a.removeChild(q);q=new Audio;q.id="canvasroom-audio";for(g=0;g<b.length;g++)e=document.createElement("source"),e.type=b[g].type,e.src=b[g].src,console.log("adding audio source with src= "+b[g].src),
q.appendChild(e);a.appendChild(q);q.load();c(0);d(0);h(A.UNSTARTED);u.emitEvent("ready")}else console.error("DIDN'T GIVE A STROKE OBJECT OR DIDN'T GIVE AN AUDIO OBJECT!")},resize:function(a,b,c){var d=!q.paused;u.pause();var e=q.currentTime;"number"!==typeof a||"number"!==typeof b?console.warn("RESIZE FUNCTION WAS NOT GIVEN PROPER SIZE OPTIONS"):(c="number"===typeof c?c:1,y.style.width=a+"px",y.style.height=b+"px",v.width=a*c,v.height=b*c,v.style.height=b+"px",v.style.width=a+"px",x.width=a*c,x.height=
b*c,x.style.height=b+"px",x.style.width=a+"px",n=j(s),f(n),u.jump(e),d&&u.play())},play:function(){q.paused&&(q.play(),g(),h(A.PLAYING),u.emitEvent("playChange","play"))},pause:function(){q.paused||(q.pause(),z&&clearTimeout(z),h(A.PAUSED),u.emitEvent("playChange","pause"))},jump:function(a){var b=!q.paused;u.pause();t.clearRect(0,0,x.width,x.height);c(a);d(a);q.currentTime=a;b&&u.play();u.emitEvent("scrub",a)},jumpPercent:function(a){u.jump(q.duration*a);u.emitEvent("scrubPercent",a)},highQuality:function(a){if(0===
arguments.length||"undefined"===typeof a)return m;"boolean"===typeof a?m=a:console.warn("highQuality only accepts booleans. You passed in the following type: "+typeof a)},mute:function(){!0!==q.muted&&(q.muted=!0,u.emitEvent("muteChange",!0))},unMute:function(){!1!==q.muted&&(q.muted=!1,u.emitEvent("muteChange",!1))},isMuted:function(){return q.muted},setVolume:function(a){0<=a&&1>=a&&(q.volume=a,u.emitEvent("volumeChange",a))},getVolume:function(){return q.volume},PlayerState:A,getPlayerState:function(){return k},
getCurrentTime:function(){return q.currentTime},currentPosition:function(){return q.currentTime/q.duration},showLists:function(){console.log("baseStrokes");console.log(n);console.log("toDrawList");console.log(p);console.log("drawingList");console.log(r);console.log("drawnList");console.log(w)},showStroke:function(a){console.log(n[a])}},"ready stateChange playChange scrub scrubPercent muteChange volumeChange".split(" "));return u}]);angular.module("services.blogFeed").factory("blogFeed",["$http","$q",function(a,b){var c=b.defer();a.jsonp("//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=5&callback=JSON_CALLBACK&q="+encodeURIComponent("http://blog.udacity.com/feeds/posts/default")).success(function(a){var b=[];_.each(a.responseData.feed.entries,function(a){b.push({date:a.publishedDate.slice(0,16),title:a.title,link:a.link})});c.resolve(b)});return{posts:c.promise}}]);angular.module("services.lesson").service("codeMirror",["mixin","libraryLoader",function(a,b){var c=null,d,e={python:{name:"python",version:2,singleLineStringErrors:!1},c:"text/x-csrc",cuda:"text/x-cudasrc",cpp:"text/x-c++src",css:"text/css",java:"text/x-java",javascript:"text/javascript",html:{name:"xml",htmlMode:!0},specman:"text/x-specmansrc"},f=function(a){for(var b={},a=a.split(" "),c=0;c<a.length;++c)b[a[c]]=!0;return b},g=function(a,b){return b.startOfLine?(a.skipToEnd(),"meta"):!1};b.loadLibraries(["codemirror"]).then(function(){CodeMirror.defineMIME("text/x-cudasrc",
{name:"clike",keywords:f("auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile inline wchar_t"),builtin:f("__global__ __constant__ __shared__ threadIdx blockIdx gridDim blockDim __device__ __host__ __syncthreads"),blockKeywords:f("do else for if struct switch while"),atoms:f("true false null"),hooks:{"#":g}});CodeMirror.defineMIME("text/x-specmansrc",
{name:"clike",keywords:f("all also as_a assert assume an and attribute bit bits bool break byte case check change compute computed cover continue cross cycle default define delay detach do down each edges else emit empty event exec expect export extend fail fall file first for force from gen global if ifdef ifndef in index int inline is instance item keep keeping key like line list machine matching me nand new nor not now of on only or out pass prev print range ranges release repeat return reverse rise routine select soft start state step string struct sync sys that then time to transition true try type undefined uint unit until using var when while with")})});
var h={attach:function(a,f){b.loadLibraries(["codemirror"]).then(function(){if(!_.isElement(a))throw"Must attach code mirror to a DOM element!";c&&(c=null);var b=angular.bind(this,function(){h.emitEvent("contentChanged")}),g=window.CodeMirror;c=g(a,{mode:e[f.language],theme:f.theme||"default",autofocus:f.autofocus,onChange:b,lineNumbers:!0,matchBrackets:!0,indentUnit:4,extraKeys:{Tab:"indentMore"}});d=f.language;h.emitEvent("attached")})},detach:function(){c=null},getAvailableLanguages:function(){return _.keys(e)},
setActiveLanguage:function(a){d=a;c.setOption("mode",e[a]);h.emitEvent("languageChanged",{to:a})},getActiveLanguage:function(){return d},setOptions:function(a){_.each(a,function(a,b){c.setOption(b,a)})},getContents:function(){return c?c.getValue():null},setContents:function(a){c.setValue(a)}};return a.eventEmission(h,["attached","languageChanged","contentChanged"])}]);angular.module("services.lesson").factory("imageQuiz",["mixin","api","dateTime","lesson","lessonContentContext",function(a,b,c,d,e){function f(a,b){a&&_.each(b.widgets,function(b){var c=_.find(a.parts,function(a){return a.marker===b.marker});c&&("RadioButtonWidget"===b.model?c.content&&(k.radioGroupAnswers[b.group]=c.marker):k.answers[b.marker]=c.content)})}var g=null,h=null,j=null,l;d.addEventListener("morselChange",function(a){l=a},{replayLast:!0});var k={answers:null,radioGroupAnswers:null,setQuiz:function(a){g=
a;var c=Math.round((new Date).getTime());h=c;k.answers={};_.each(g.widgets,function(a){k.answers[a.marker]=a.initial_value});k.radioGroupAnswers={};g.hasOwnProperty("lastSubmission")?(f(g.lastSubmission,g),k.emitEvent("ready")):b.get("/nodes/"+a.key+"/state").success(function(a){l.key===g.key&&c===h&&(a=a.nodestates[0]?a.nodestates[0].last_submission_data:null,f(a,g),d.updateLastSubmissionForMorsel(g.key,a),k.emitEvent("ready"))}).error(function(a){console.error("Error fetching quiz progress data");
console.error(a)})},getQuiz:function(){return g},submit:function(){_.each(g.widgets,function(a){"RadioButtonWidget"===a.model&&(k.answers[a.marker]=k.radioGroupAnswers[a.group]===a.marker)});if(g.evaluator){var a=Math.round((new Date).getTime()),f=g.key;j=a;var h=e.getCurrent(),p=c.getCurrentAsUTC(),r={model:"Submission",operation:"GRADE",parts:_.map(k.answers,function(a,b){return{model:"SubmissionPart",marker:b,content:a}})},w={submission:r};d.updateLastSubmissionForMorsel(g.key,r);b.post("/nodes/"+
g.key+"/evaluation?_method=GET",w).success(function(b){k.emitEvent("evaluation",{evaluation:b.evaluation,submission:r,context:h,timestamp:p});f===l.key&&a===j&&(b.evaluation?!0===b.evaluation.passed?(d.markMorselAsCompleted(f),g.containingExercise&&d.markMorselAsCompleted(g.containingExercise.key),k.emitEvent("correct",{morselId:g.key,comment:b.evaluation.comment})):!1===b.evaluation.passed?k.emitEvent("incorrect",{morselId:g.key,comment:b.evaluation.comment}):null===b.evaluation.passed?k.emitEvent("recorded",
{morselId:g.key,comment:b.evaluation.comment}):console.error("invalid evaluation.passed value:"+b.evaluation.passed):k.emitEvent("error",{morselId:g.key,comment:"We encountered an error. Please try submitting again."}))}).error(function(){k.emitEvent("error",{morselId:g.key,comment:"We encountered an error. Please try submitting again."})})}else _.reduce(g.widgets,function(a,b){return a&&k.answers[b.marker]===b.correct_value},!0)?k.emitEvent("correct",{morselId:g.key}):k.emitEvent("incorrect",{morselId:g.key})}};
return a.eventEmission(k,"ready incorrect correct recorded error evaluation".split(" "))}]);angular.module("services.lesson").constant("viewerPartialMap",{Video:"video",SketchVideo:"video",ProgrammingQuiz:"programming_quiz",ImageFormQuiz:"image_quiz",Sketch:"sketch",EmbeddedFrame:"iframe"});angular.module("services.lesson").service("executor",["mixin","$http","dateTime","lessonContentContext","lesson","iframeEvaluator",function(a,b,c,d,e,f){var g={submitFiles:function(a,j,l){var k=l.operation||"TEST",m=d.getCurrent(),n=c.getCurrentAsUTC(),s={model:"Submission",operation:k,parts:_.map(a,function(a){return{model:"SubmissionPart",marker:a.name,content:a.content}})},p={submission:s},r=function(a){g.emitEvent("evaluation",{evaluation:a.data.evaluation,submission:s,context:m,timestamp:n});
return a};g.emitEvent("submit");e.updateLastSubmissionForMorsel(j,s);return l.useIframe?f.evaluate(s,j,l.iframeUrl).then(function(a){p.submission.client_execution=a.execution;p.submission.client_execution.raw_result=JSON.stringify(a.execution.raw_result);return b.post("/api/nodes/"+j+"/evaluation?_method=GET",p,{timeout:3E4}).then(r)},function(){p.execution={model:"SubmissionExecution",raw_result:"",status:"te"};return b.post("/api/nodes/"+j+"/evaluation?_method=GET",p,{timeout:3E4}).then(r)}):b.post("/api/nodes/"+
j+"/evaluation?_method=GET",p,{timeout:3E4}).then(r)}};return a.eventEmission(g,["update","submit","evaluation"])}]);angular.module("services.auth").factory("auth",["api","user","mixin","urlParams",function(a,b,c,d){b.setUser(b.getBaseUser());b.getBaseUser().registered&&a.get("/users/me").success(function(a){var c=b.translateUserFromApi(a.user);c.enrollments=a.user.enrollments;b.setUser(c)}).error(function(a,b,c,d){console.warn("The initial user fetch failed...");console.log({status:b,data:a,config:d})});var e=c.eventEmission({logInHelper:function(b,c,d,j,l,k){e.emitEvent("logIn");var m={};c&&(m={udacity:{username:b,
password:c}});j&&(m.facebook={signed_request:j},m.connect=k);l&&(m.google={token:l},m.connect=k);a.post("/session",m).success(function(){e.emitEvent("logInSuccess")}).error(d)},logInAndConnect:function(a,b,c,d){e.logInHelper(a,b,function(a,b,c,d){e.emitEvent("logInFailure",{status:b,data:a,config:d,headers:c})},c,d,!(!c&&!d))},logUserOut:function(){e.emitEvent("logOut");a.deleteRequest("/session").success(function(a,b,c,d){console.log("user logged out");console.log({status:b,data:a,config:d});e.emitEvent("logOutSuccess")}).error(function(a,
b,c,d){console.warn("User tried to log out and failed!");console.log("Debug data:");console.log({status:b,data:a,config:d});e.emitEvent("logOutFailure")})},signUserUp:function(c,g,h,j,l,k,m,n){a.post("/users",{first_name:c,last_name:g,email_address:h,password:j,facebook:k?{signed_request:k}:null,google:m?{token:m}:null,tos_accepted:n}).success(function(a){if(null===a.user)console.log('Got back a null user! You are null, and while not valid in this language, I\'m going to call you "void" too.');else{var c=
d.getDecodedURIComponent("enroll");c?UY.pushTrackingEvent("SignUp","Enroll",c):UY.pushTrackingEvent("SignUp","Direct","");a=b.translateUserFromApi(a.user);b.setUser(a);e.emitEvent("signUpSuccess")}}).error(function(a,b,c,d){e.emitEvent("signUpFailure",{status:b,data:a,config:d,headers:c})})},logUserInSocial:function(a,b,c){e.logInHelper(null,null,function(a,b,d,f){502===b?(console.log("something failed with Facebook or the signed request"),e.emitEvent("logInFailure",{status:b,data:a,config:f,headers:d})):
403===b?c():console.log("unknown failure "+b)},a,b,!1)},getFacebookSignedRequest:function(){return d.getUrlQueryParams().fsr},getGoogleTokenCode:function(){return d.getUrlQueryParams().gtc},socialAccountNotFoundRedirect:function(a,b,c){var e={next:d.getDecodedURIComponent("next")||window.location.href};d.getDecodedURIComponent("enroll")&&(e.enroll=d.getDecodedURIComponent("enroll"));a&&(e.fsr=a);b&&(e.gtc=b);window.location.href="signin"===c?"/account/signin_connect?"+$.param(e):"/account/signup_connect?"+
$.param(e)},loggedInAction:function(){var a=function(){var a=d.getDecodedURIComponent("next");a?window.location.href=a:window.location.reload()},c=d.getDecodedURIComponent("enroll");c?(b.addEventListener("changeEnrollmentComplete",a),b.changeEnrollment(c,!0)):a()}},"logIn logInSuccess logInFailure logInValidation signUp signUpSuccess signUpFailure signUpValidation logOut logOutSuccess logOutFailure".split(" "));return e}]);angular.module("services.utility").factory("libraryLoader",["$q","$rootScope","cacheVersion",function(a,b,c){var d={codemirror:"/media/js/standalone/libs/codemirror/codemirror-custom.min.js?"+c,mathquill:"/media/js/standalone/libs/mathquill.min.js?"+c,jshint:"/media/js/standalone/libs/jshint/jshint-1.0.0.min.js"},e={};return{loadLibraries:function(c){return a.all(_.map(c,function(c){var f=d[c]?d[c]:c,j=a.defer();e[c]?c=e[c]:(e[c]=j.promise,jQuery.ajax({dataType:"script",cache:!0,url:f}).success(function(){j.resolve();
b.$apply()}).error(function(){j.reject();b.$apply()}),c=j.promise);return c}))}}}]);angular.module("services.utility").factory("validator",[function(){var a={valid:!0,errorText:""},b={noop:function(){return a},required:function(b,d){return"string"===typeof b&&""===b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")||"undefined"===typeof b||"boolean"===typeof b&&!b?{valid:!1,errorText:d+" is required."}:a},strLen:function(b,d,e){("string"!==typeof b||"string"!==typeof d||"object"!==typeof e||2!==e.length)&&console.error("Wrong parameters passed to strLen validator for "+d);var b=b.length,
f=e[0],e=e[1];if("number"===typeof f&&"number"===typeof e){if(b<f||b>e)return{valid:!1,errorText:d+" has to be between "+f+" and "+e+" characters long."}}else{if("number"===typeof f&&b<f)return{valid:!1,errorText:d+" has to be more than "+f+(1>=f?" character":" characters")+" long."};if("number"===typeof e&&b>e)return{valid:!1,errorText:d+" has to be "+(1>=e?"less than 1 character":"fewer than "+e+" characters")+" long."}}return a},email:function(b,d){("string"!==typeof b||"string"!==typeof d)&&console.error("Wrong parameters passed to email validator for "+
d);return/^[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i.test(b)?a:{valid:!1,errorText:d+" has to be a valid email address"}},equal:function(b,d,e){("string"!==typeof b&&"number"!==typeof b&&"boolean"!==typeof b||"object"!==typeof e||2!==e.length)&&console.error("Wrong parameters passed to equal validator for "+d);"string"!==typeof b&&("number"!==typeof b&&"boolean"!==typeof b)&&console.error('Validator "Equal" only works for strings, numbers, and booleans. Tried '+
typeof b+" for "+d);return b===e[0]?a:{valid:!1,errorText:d+" and "+e[1]+" have to be the same."}}};return{check:function(a){var d,e={valid:!0,errorText:{}},f,g;for(g in a)if(a.hasOwnProperty(g)){d=a[g];for(var h=0;h<d.validators.length;h++)if(f=d.validators[h],"undefined"===typeof f.disabled||!1===f.disabled)if("function"===typeof b[f.type]){var j=d.value,l=d.pretty,k=b[f.type](j,l,f.args||[]);k.valid?f.hasOwnProperty("chained")&&(k={},k[g]={pretty:l,value:j,validators:f.chained},f=this.check(k),
!1===f.valid&&(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g]=e.errorText[g].concat(f.errorText[g]))):(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g].push("undefined"===typeof f.failMsg?k.errorText.charAt(0).toUpperCase()+k.errorText.slice(1):f.failMsg))}else console.warn("You tried to use a validator that doesn't exist! The name you tried to use was: "+f.type)}return e}}}]);angular.module("services.lesson").factory("programmingQuiz",["$http","mixin","codeEditor","executor","lesson",function(a,b,c,d,e){function f(a){return _.map(a,function(a){return{name:a.name,content:a.text}})}function g(a){return _.map(a,function(a){var b={name:a.name};a._content&&"text/plain"===a._content._content_type?(b.text=a._content._plaintext,b.kind="plaintext"):a._content&&-1!==a._content._content_type.indexOf("image")&&(b.servingUrl=a._content._serving_url,b.kind="image");return b})}function h(a,
b){a&&_.each(b,function(b){var c=_.find(a.parts,function(a){return a.marker===b.name});c&&(b.text=c.content)})}var j=null,l=null,k=null,m;e.addEventListener("morselChange",function(a){m=a},{replayLast:!0});var n=null,s=null,p=null,r=null,w={init:function(b){var d=Math.round((new Date).getTime()),f=b.key;j=d;s=g(b.initial_code_files);n=g(b.initial_code_files);p=b.key;r=b;b.hasOwnProperty("lastSubmission")?(h(b.lastSubmission,n),c.loadFiles(n).then(function(){w.emitEvent("ready")})):a.get("/api/nodes/"+
b.key+"/state").success(function(a){f===m.key&&d===j&&(a=a.nodestates[0]?a.nodestates[0].last_submission_data:null,h(a,n),e.updateLastSubmissionForMorsel(p,a),c.loadFiles(n),w.emitEvent("ready"))}).error(function(a){console.error("Error fetching programming quiz progress data");console.error(a)})},submit:function(){var a=Math.round((new Date).getTime()),b=m.key;l=a;d.submitFiles(f(c.getAllFiles()),p,{operation:"GRADE",useIframe:m.evaluator&&"IFrameEvaluator"===m.evaluator.model,iframeUrl:m.evaluator&&
m.evaluator.external_uri}).then(function(c){c=c.data;a===l&&b===m.key&&(c.evaluation.passed&&(e.markMorselAsCompleted(b),r.containingExercise&&e.markMorselAsCompleted(r.containingExercise.key)),c.evaluation.comment&&c.evaluation.comment.indexOf("est case input")&&(w.emitEvent("run",{morselId:b,result:{stdout:c.evaluation.comment,stderr:null,images:null}}),c.evaluation.comment="Please see detailed feedback in the output area below."),w.emitEvent("evaluated",{result:c.evaluation}))},function(a){w.emitEvent("evaluationError",
a.data)})},run:function(){var a=Math.round((new Date).getTime()),b=m.key;k=a;d.submitFiles(f(c.getAllFiles()),p,{operation:"TEST",useIframe:m.evaluator&&"IFrameEvaluator"===m.evaluator.model,iframeUrl:m.evaluator&&m.evaluator.external_uri}).then(function(c){c=c.data;if(a===k&&b===m.key){var d={};c.execution&&c.execution._output_attachments&&(c=c.execution._output_attachments,d=g(c),d={stdout:c.stdout?c.stdout._content._plaintext:null,stderr:c.stderr?c.stderr._content._plaintext:null,images:_.filter(d,
function(a){return"image"===a.kind})});w.emitEvent("run",{morselId:b,result:d})}},function(a){w.emitEvent("runError",a.data)})},reset:function(){c.loadFiles(s)}};return b.eventEmission(w,["evaluated","evaluationError","run","runError","ready"])}]);angular.module("services.lesson").factory("lessonContentContext",["$routeParams","tags",function(a,b){return{getCurrent:function(){return _.without(_.map(["course","lesson","exercise","morsel"],function(c){if(a[c+"Key"]&&"none"!==a[c+"Key"])return{tag:b[c],node_key:a[c+"Key"]}}),void 0,null)}}}]);angular.module("services.lesson").factory("viewerSettings",["mixin",function(a){var b={autoPlay:!0},c={set:function(a,e){if(b.hasOwnProperty(a)){var f=b[a];b[a]=e;c.emitEvent("change",{name:a,oldValue:f,newValue:e})}else console.error("can't set invalid setting: "+a)},get:function(a){if(b.hasOwnProperty(a))return b[a];console.error("Can't get invalid setting: "+a)}};return a.eventEmission(c,["change"])}]);angular.module("services.lesson").factory("lessonActivityTracker",["$http","lesson","lessonContentContext","youtubeVideoPlayer","dateTime","imageQuiz","executor","mixin","$routeParams",function(a,b,c,d,e,f,g,h,j){function l(a){function b(a){_.find(a.context,function(a){return"m-"===a.tag})||alert("A severe bug has occurred that we are trying to track down!  If you can please contact nicolas@udacity.com immediately, that would be very helpful. If not, please know that your last submission was lost and please resubmit again. Refreshing the page may help, but will lose your latest submission, so please copy it down before refreshing. We are very sorry about this! \n\nDebug Information, please include this in your email if you send one:\n"+
JSON.stringify(j,2)+"\n___\n"+JSON.stringify(c.getCurrent(),2)+"\n___\n"+window.location.href+"\n____\n"+JSON.stringify(a.evaluation,2)+"\n____\n"+new Date);return n(_.map(_.without([a.submission,a.evaluation],null,void 0),function(b){return{context:a.context,data:b}}),{chain:!0,timestamp:a.timestamp})}function d(){e+=1;3>e?b(a).then(function(){},d):s.emitEvent("quizActivityLogFailure",{context:a.context})}var e=0;a.evaluation&&(a.evaluation.model="SubmissionEvaluation");b(a).then(function(){},d)}
var k=null,m=null,n=function(b,c){var c=c||{},d={items:_.map(b,function(a){return{occurrence_time:c.timestamp||e.getCurrentAsUTC(),content_context:_.without(a.context,null,void 0,"none"),data:a.data}})},f="/api/activity";c.chain&&(f+="?related_chain=true");return a.post(f,d).then(function(a){200!==a.status&&(console.error("Error when trying to post activity. Response:"),console.error(a))})};d.addEventListener("videoPlay",function(a){k=a},{replayLast:!0});d.addEventListener("videoPause",function(a){null!==
k&&(null!==a&&void 0!==a)&&(m=a,n([{context:c.getCurrent(),data:{model:"PlayableView",start:k,stop:m}}]));k=m=null},{replayLast:!0});f.addEventListener("evaluation",l,{replayLast:!0});g.addEventListener("evaluation",l,{replayLast:!0});var s={logNodeVisit:function(){n([{context:c.getCurrent(),data:{model:"NodeVisit"}}])}};return h.eventEmission(s,["quizActivityLogFailure"])}]);angular.module("services.lesson").factory("iframeEvaluator",["mixin","$q","$timeout","isTrustedDomain",function(a,b,c,d){var e=null,f=null,g=null,h={evaluate:function(a,d,k){var m=b.defer();e=m;f=a;g=k;h.emitEvent("newEvaluation",{nodeId:d,iframeUrl:k});c(function(){m.reject("timeout")},6E4);return m.promise}};window.addEventListener("message",function(a){if(d(a.origin)){var b;a=a.data;try{b=JSON.parse(a)}catch(k){b=a}"ready"===b.messageType?h.emitEvent("postMessageRequest",{submission:f,iframeUrl:g}):
"execution"===b.messageType&&c(function(){e.resolve(b.result)})}},!1);return a.eventEmission(h,["newEvaluation","postMessageRequest"])}]);angular.module("services.lesson").factory("lesson",["$http","$q","mixin","lessonContentContext","typeForTag","freshContent",function(a,b,c,d,e,f){function g(a,b){var c=_.find(a,function(a){for(var c=b.length-1;0<=c;c--){var d=a.content_context[c];if(!d||d.node_ref.key!==b[c].node_key||d.tag!==b[c].tag)return!1}return!0});c&&(c=_.object(_.map(c.content_context,function(a){return[e[a.tag]+"Key",a.node_ref.key]})));return c}var h=null,j=null,l=null,k=null,m=null,n=null,s=null,p={announcePendingCourseChange:function(){p.emitEvent("pendingCourseChange",
{course:h})},changeCourse:function(c){var e=Math.round((new Date).getTime());s=e;b.all([a.get("/api/nodes/"+c+"?depth=1&fresh="+(!0===f)+"&required_behavior=view"),a.get("/api/nodes/"+c+"/state?fresh=true")]).then(function(a){var b=a[0].data,f=a[1].data,k=a=null;if(e===s){h=b.references.Node[c];j=b.references.Node;h.steps_refs=_.reject(h.steps_refs,function(a){return!j[a.key]});if(b=_.find(f.nodestates,function(a){return a.node_ref.key===c}))(k=g(b.last_interactions,d.getCurrent()))&&k.lessonKey&&
(a=j[k.lessonKey]);p.emitEvent("courseChange",{course:h,lessons:_.map(h.steps_refs,function(a,b){var c=j[a.key];c.indexInCourse=b;return c}),lastLessonVisited:a,hasActivity:null!==k})}},function(a){e===s&&a.status&&403===a.status&&p.emitEvent("coursePermissionDenied",c)})},announcePendingLessonChange:function(){p.emitEvent("pendingLessonChange",{lesson:l})},changeLesson:function(c){var e=Math.round((new Date).getTime());n=e;b.all([a.get("/api/nodes/"+c+"?depth=2&fresh="+(!0===f)+"&required_behavior=view"),
a.get("/api/nodes/"+c+"/state?fresh=true")]).then(function(a){if(e===n){var b=a[0].data,f=a[1].data,a=null;l=b.references.Node[c];k=b.references.Node;l.steps_refs=_.reject(l.steps_refs,function(a){return!k[a.key]});_.each(l.steps_refs,function(a,b){var c=k[a.key];if(!c)throw Error("Expected a morsel but got "+JSON.stringify(c,2));"Exercise"===c.model&&_.each(["lecture_ref","quiz_ref","answer_ref"],function(a){c[a]&&(c[a]=k[c[a].key],c[a]&&(c[a].containingExercise=c))});k[a.key].indexInLesson=b});
if(b=_.find(f.nodestates,function(a){return a.node_ref.key===c}))_.each(b.completed_descendant_node_refs,function(a){p.markMorselAsCompleted(a.key)}),(b=g(b.last_interactions,d.getCurrent()))&&b.morselKey&&(a=k[b.morselKey]);p.emitEvent("lessonChange",{lesson:l,morsels:_.map(l.steps_refs,function(a){return k[a.key]}),lastMorselVisited:a})}},function(a){e===n&&a&&(a.status&&403===a.status)&&p.emitEvent("lessonPermissionDenied",c)})},announcePendingMorselChange:function(a){p.emitEvent("pendingMorselChange",
{from:m,to:a})},changeMorsel:function(a){m=k[a];p.emitEvent("morselChange",m)},markMorselAsCompleted:function(a){k[a]?k[a].completed=!0:console.error("Can't find morsel #"+a+" to mark it as completed")},updateProgressForMorsel:function(a,b){k[a]&&k[b]?k[a].progressNodeId=b:console.error("Can't find container morsel #"+a+" or perhaps progress morsel #"+b+" to update progress")},updateLastSubmissionForMorsel:function(a,b){k[a]?k[a].lastSubmission=b:console.error("Can't find morsel #"+a+"to update activity")}};
return c.eventEmission(p,"pendingCourseChange courseChange pendingLessonChange lessonChange pendingMorselChange morselChange lessonPermissionDenied coursePermissionDenied".split(" "))}]);angular.module("services.lesson").factory("lessonPrefetcher",["$http","$timeout","lesson",function(a,b,c){var d=null;c.addEventListener("courseChange",function(a){d=a.lessons},{replayLast:!0});c.addEventListener("courseChange",function(){c.addEventListener("lessonChange",function(c){var f=_.find(d,function(a){return a.key===c.lesson.key}).indexInCourse;if(0<f){var g=d[f-1].key;b(function(){a.get("/api/nodes/"+g+"?depth=2&fresh=false&required_behavior=view")},1E4,!1)}if(0<=f&&f<d.length-1){var h=d[f+
1].key;b(function(){a.get("/api/nodes/"+h+"?depth=2&fresh=false&required_behavior=view")},7E3,!1)}},{replayLast:!0})},{removeAfterFired:!0,replayLast:!0});c.addEventListener("morselChange",function(b){if(("Video"===b.model||"SketchVideo"===b.model)&&b.containingExercise&&b.containingExercise.lecture_ref&&b.containingExercise.lecture_ref.key===b.key&&b.containingExercise.quiz_ref&&!b.containingExercise.quiz_ref.lastSubmission){var d=b.containingExercise.quiz_ref;a.get("/api/nodes/"+d.key+"/state").success(function(a){d.lastSubmission||
c.updateLastSubmissionForMorsel(d.key,a.nodestates[0]?a.nodestates[0].last_submission_data:null)}).error(function(){console.error("Failed to prefetch last submission for quiz with id "+d.key)})}});return{}}]);angular.module("services.lesson").factory("codeEditor",["mixin","codeMirror","libraryLoader",function(a,b,c){function d(a){return-1!==a.indexOf(".cu")?"cuda":-1!==a.indexOf(".py")?"python":-1!==a.indexOf(".js")?"javascript":-1!==a.indexOf(".html")?"html":-1!==a.indexOf(".css")?"css":-1!==a.indexOf(".cpp")?"cpp":-1!==a.indexOf(".java")?"java":-1!==a.indexOf(".json")?"javascript":-1!==a.indexOf(".e")?"specman":"plaintext"}function e(a){a&&(g=a,b.setActiveLanguage(d(a.name)),b.setContents(a.text),"javascript"===
d(a.name)?c.loadLibraries(["codemirror","jshint"]).then(function(){b.setOptions({gutters:["CodeMirror-lint-markers"],lintWith:CodeMirror.javascriptValidator})}):b.setOptions({gutters:[],lintWith:null}),h.emitEvent("activeFileChanged",{newActiveFile:a}))}var f=null,g=null,h={loadFiles:function(a){var b=!0;_.each(a,function(a){if(!_.isObject(a)||!a.name||!a.hasOwnProperty("text"))b=!1,console.error("Failed to load files. Invalid file: ",a)});if(b)return c.loadLibraries(["codemirror"]).then(function(){f=
a;e(f[0]);h.emitEvent("filesLoaded",{files:f})})},getAllFiles:function(){g.text=b.getContents();return f},switchToFile:function(a){g.text=b.getContents();e(_.find(f,function(b){return b.name===a}))}};return a.eventEmission(h,["filesLoaded","activeFileChanged"])}]);angular.module("services.reviews").factory("reviews",["api",function(a){return{getReviews:function(b,c,d,e,f){return a.post("/reviews?_method=GET",{entity_key:b,offset:c*d,limit:d,sort_order:e,cursor_map:f},{})},vote:function(b,c){var d={score_type:"thumbs",score_str:c};return a.post("/users/me/reviews/"+encodeURIComponent(b),d)}}}]);angular.module("services.forum").factory("forumService",["$http","$q",function(a,b){return{getPosts:function(c){var d=b.defer();window.FORUM_JSONP_CALLBACK=function(a){for(var b=[],c=0;c<a.length;++c)b[c]={},b[c].title=a[c].title,b[c].href=a[c].href,b[c].date=a[c].date,b[c].score=a[c].score,b[c].answer_count=a[c].answer_count,b[c].views=a[c].views;d.resolve(b)};a.jsonp("https://forums.udacity.com/tags/"+c+"/interesting/?callback=FORUM_JSONP_CALLBACK").success(function(a){return a}).error(function(){});
return d.promise}}}]);angular.module("services.content").factory("content",["api","mixin","$q","dummyData",function(a,b,c){var d=b.eventEmission({nodes:{},states:{},loadNodes:function(b,f,g){var h=f[0],b=_.filter(b,function(a){return!d.nodes.hasOwnProperty(a)});if(0===b.length)return d.emitEvent("loadNodesComplete",{nohttp:!0}),null;var j=Math.min(3,b.length),l=Math.ceil(b.length/j);c.all(_.flatten(_.map(_.range(j),function(c){var c=c*l,d=b.slice(c,c+l),c=JSON.stringify({keys:d,fresh:!1,depth:0}),d=JSON.stringify({node_keys:d,
user_key:h});return[a.get("/nodes?json="+c),a.get("/nodes/state?json="+d)]}))).then(function(a){function c(a){d.states[h][a.node_ref.key]=a}function f(a){d.states[h].hasOwnProperty(a)||(d.states[h][a]={})}for(var l=0;l<2*j;l+=2){var p=a[l+1].data;$.extend(d.nodes,a[l].data.references.Node);d.states.hasOwnProperty(h)||(d.states[h]={});$.extend(d.states[h],{});_.each(p.nodestates,c);_.each(b,f)}void 0!==g&&d.setMasteryPoints(g,h,b);d.emitEvent("loadNodesComplete",{nohttp:!1})})},setMasteryPoints:function(a,
b,c){try{void 0===c&&(c=[]);c.push(a);var h=d.states[b][a].mastery_points_summary;_.each(c,function(a){h.hasOwnProperty(a)?(d.states[b][a].points_possible=h[a].points_possible,d.states[b][a].points_earned=h[a].points_earned):(d.states[b][a].points_possible=0,d.states[b][a].points_earned=0)})}catch(j){return null}}},["loadNodesComplete","loadNodesPartial","loadStateComplete","aggregationMasteryPointsComplete"]);d.getNodeProperty=function(a,b){return d.nodes.hasOwnProperty(a)?d.nodes[a][b]:null};d.getChildrenKeys=
function(a){var b=[];d.nodes.hasOwnProperty(a)&&(b=_.map(d.nodes[a].steps_refs,function(a){return a.key}));return b};d.getDifficultyLevel=function(a){return d.nodes.hasOwnProperty(a)?d.nodes[a].catalog_entry.level:null};d.getLevelMasteryPoints=function(a,b){try{return d.nodes[a].catalog_entry.mastery_spec.badge_thresholds[b]}catch(c){return 0}};d.getMasteryPoints=function(a,b,c){try{return d.states[b][a][c]}catch(h){return 0}};d.getLastChild=function(a,b){try{for(var c=0;c<d.states[b][a].last_interactions.length;c++){var h=
d.states[b][a].last_interactions[c];if(1<h.content_context.length&&"c-"===h.content_context[0].tag&&h.content_context[0].node_ref.key===a)return h.content_context[1].node_ref.key}return null}catch(j){return null}};d.getLastInteractionDate=function(a,b){try{var c=_.map(d.states[b][a].last_interactions,function(a){return Date.parse(a.time)});return Math.max.apply(Math,c)}catch(h){return null}};d.getMasteryLevel=function(a,b){try{for(var c=d.nodes[a].catalog_entry.mastery_spec.badge_thresholds,h=d.getMasteryPoints(a,
b,"points_earned"),j=0,l=0;l<c.length&&!(j=l,h<=c[l]);l++);return j}catch(k){return 0}};d.getNotAvailableMessage=function(a){try{return d.nodes[a].catalog_entry.not_available_message}catch(b){return null}};d.getProgress=function(a,b){try{return Math.min(d.states[b][a].completed_morsel_count/d.nodes[a]._synopsis.morsel_count,1)}catch(c){return 0}};d.getRemainingDuration=function(a,b){try{return Math.max(Math.round((d.nodes[a]._synopsis.duration-d.states[b][a].completed_duration)/60),0)}catch(c){return 0}};
d.getRemainingEvaluables=function(a,b){try{return Math.max(d.nodes[a]._synopsis.quiz_count-d.states[b][a].completed_quiz_count,0)}catch(c){return 0}};d.getRemainingMasteryPoints=function(a,b,c){c=d.getLevelMasteryPoints(a,c);a=d.getEarnedMasteryPoints(a,b);a=c-a;0>a&&(a=0);return a};d.hasBehavior=function(a,b){try{var c=_.values(d.nodes[a].guard.allowed_behaviors);return _.contains(c,b)}catch(h){return!1}};d.isAvailable=function(a){try{return d.nodes[a]._available}catch(b){return!1}};d.isMorsel=function(a){return"Lesson"!==
a.model&&"Course"!==a.model};d.getMasteryMorselKeys=function(a){try{return _.map(d.nodes[a].catalog_entry.mastery_spec.weights,function(a){return a.node_ref.key})}catch(b){return[]}};d.getLessonKeys=function(a){return _.map(d.nodes[a].steps_refs,function(a){return a.key})};return d}]);angular.module("services.utility").service("mixin",["callbackList",function(a){return{eventEmission:function(b,c){var d=_.object(_.map(c,function(b){return[b,a.create()]}));if(!_.isArray(c)||!_.all(c,function(a){return _.isString(a)}))throw"eventNames must be an array of strings";if(!_.isObject(b))throw"targetObject must be an object to mix into";var e=function(a,c,e){if(d[a])e();else throw c;return b};if(_.intersection(_.keys(b),["addEventListener","removeEventListener","emitEvent"]).length)throw"Can't add event methods--they already exist!";
b.addEventListener=function(a,c,h){var h=h||{},j=_.without(_.keys(h),"replayLast","removeOnDestructionOf","removeAfterFired");if(j.length)throw Error("Unsupported options "+j+" when adding event listener");return e(a,'Cannot listen for non-emitted event "'+a+'"',function(){if(!_.isFunction(c))throw Error('You must provide a callback to run when the "'+a+'" event is emitted');d[a].add(c,h.replayLast,h.removeAfterFired);_.isObject(h.removeOnDestructionOf)&&h.removeOnDestructionOf.$on&&h.removeOnDestructionOf.$on("$destroy",
function(){b.removeEventListener(a,c)})})};b.removeEventListener=function(a,b){return e(a,'Cannot remove listener from non-emitted event "'+a+'"',function(){d[a].remove(b)})};b.emitEvent=function(a,b){return e(a,"Cannot emit invalid event "+a+". Add to exposed events when mixing in.",function(){if(void 0===b||null===b)b={};d[a].fire(b)})};return b}}}]);angular.module("udacity.core").run(function(){window.PRODUCTION&&(console.log=function(){},console.warn=function(){},console.error=function(){})});angular.module("services.utility").factory("markdownConverter",[function(){return new window.Markdown.getSanitizingConverter}]);angular.module("services.dummyData").factory("dummyData",[function(){return{getNodes:function(){return{Node:{"0":{key:"0",model:"Lesson",title:"Web Development",subtitle:"Better Living Through Weavistry",id:"cs253",duration:10,mastery_points:7,mastery_levels:[0,1,3,5,7],difficulty_level:"intermediate",quiz_count:2,node_references:["00","01"]},1:{key:"1",model:"Lesson",title:"Artisanal Pencil Sharpening",subtitle:"The craft of pencil",id:"ap301",duration:20,mastery_points:5,mastery_levels:[0,1,3,4,
5],difficulty_level:"advanced",quiz_count:0,node_references:["10"]},"00":{key:"00",model:"Lesson",title:"How the Web Works",duration:10,mastery_points:7,quiz_count:1,node_references:["000","001"]},"01":{key:"01",model:"Lesson",title:"How to Have Users",duration:0,mastery_points:0,quiz_count:1,node_references:["010"]},10:{key:"10",model:"Lesson",title:"Single Razor Pocket Sharpeners",duration:20,quiz_count:0,mastery_points:5,node_references:["100"]},"000":{key:"000",model:"Video",title:"BYOBaskets",
duration:10,mastery_points:0,quiz_count:0},"001":{key:"001",model:"ImageFormQuiz",title:"How big is your basket?",duration:0,mastery_points:7,quiz_count:1},"010":{key:"010",model:"ImageFormQuiz",title:"50 Shades of Basket",duration:0,mastery_points:0,quiz_count:1},100:{key:"100",model:"Video",title:"Single Razor",duration:20,mastery_points:5,quiz_count:0}},NodeState:{"0":{progress:0.3,mastery_points_earned:3,mastery_level_achieved:2,viewed_playable_duration:1,completed_evaluable_count:1,last_child_key:"01"},
1:{progress:0.7,mastery_points_earned:1,mastery_level_achieved:1,viewed_playable_duration:15,completed_evaluable_count:0,last_child_key:"10"},"00":{progress:0.5,mastery_points_earned:3,viewed_playable_duration:1,completed_evaluable_count:0,last_child_key:"001"},"01":{progress:0.2,mastery_points_earned:0,viewed_playable_duration:0,completed_evaluable_count:1,last_child_key:"010"},10:{progress:0.5,mastery_points_earned:1,viewed_playable_duration:15,completed_evaluable_count:0,last_child_key:"100"},
"000":{progress:0.5,mastery_points_earned:0,viewed_playable_duration:1,completed_evaluable_count:0},"001":{progress:0.5,mastery_points_earned:3,viewed_playable_duration:0,completed_evaluable_count:1},"010":{progress:0.5,mastery_points_earned:0,viewed_playable_duration:0,completed_evaluable_count:0},100:{progress:0.5,mastery_points_earned:5,viewed_playable_duration:15,completed_evaluable_count:0}}}},currentCourseKeys:["0","1"],pastCourseKeys:[],userKey:3,badgeUrls:{1:{medium:"http://foursquare.com/img/badge/swarm_big.png"},
2:{medium:"http://www.newtownhistoric.org/images/HeritageWalk/HistoryDetectiveBadge.jpg"},4:{medium:"https://foursquare.com/img/badge/barista_big.png"}}}}]);angular.module("udacity.editor").config(["$routeProvider","$locationProvider","cacheVersion",function(a,b,c){a.when("/danger_editor",{templateUrl:"/templates/angular/editor/chooser.html?"+c,controller:"LessonChooserCtrl"}).when("/danger_editor/lesson/:lessonKey",{templateUrl:"/templates/angular/editor/lesson.html?"+c,controller:"LessonCtrl"}).when("/danger_editor/course/:courseKey",{templateUrl:"/templates/angular/editor/course.html?"+c,controller:"CourseCtrl"}).when("/danger_editor/course/:courseKey/lesson/:lessonKey",
{templateUrl:"/templates/angular/editor/lesson.html?"+c,controller:"LessonCtrl"});b.html5Mode(!0)}]);
angular.module("services.editor").factory("localdb",["content","api",function(a){return{nodes:{},lesson:void 0,course:void 0,newVideo:function(){var b=new a.VideoMorsel;return this.nodes[b.key]=b},newFrame:function(){var b=new a.FrameMorsel;return this.nodes[b.key]=b},newQuiz:function(){var b=new a.QuizMorsel;return this.nodes[b.key]=b},newSketch:function(){var b=new a.SketchMorsel;return this.nodes[b.key]=b},newProgram:function(){var b=new a.ProgrammingMorsel;return this.nodes[b.key]=b},newExercise:function(){var b=
new a.ExerciseNode;return this.nodes[b.key]=b},newLesson:function(){var b=new a.Lesson;return this.nodes[b.key]=b},getNode:function(a){if(a){var c=a;a.hasOwnProperty("key")&&a.hasOwnProperty("ref")&&(c="Node"===a.ref?a.key:void 0);if(a=this.nodes[c])return a}}}}]).factory("content",function(){var a={nodeKey:0,getNewKey:function(){a.nodeKey++;return"~"+a.nodeKey},Lesson:function(){this.title="New Lesson";this.key=a.getNewKey();this.model="Lesson";this.inherit_read_permissions=!1;this.steps_refs=[];
this.affiliate_program_refs=[]},CatalogEntry:function(){this.model="CatalogEntry";this.subtitle="";this.level="beginner";this.accredited=!1;this.mastery_spec=new a.MasterySpec;this.instructor_refs=[];this.assistant_refs=[];this.expected_learning=this.required_knowledge=this.summary=""},MasterySpec:function(){this.model="MasterySpec";this.badge_thresholds=[0,1,1,1,1];this.weights=[]},MasteryWeightAssignment:function(){this.model="MasteryWeightAssignment";this.node_ref=void 0;this.points=1},VideoMorsel:function(){this.title=
"Video";this.key=a.getNewKey();this.model="Video";this.inherit_read_permissions=!1;this.affiliate_program_refs=[]},FrameMorsel:function(){this.title="Frame";this.key=a.getNewKey();this.model="EmbeddedFrame";this.inherit_read_permissions=!1;this.affiliate_program_refs=[];this.external_uri=""},SketchMorsel:function(){this.title="Sketch";this.key=a.getNewKey();this.model="Sketch";this.inherit_read_permissions=!1;this.affiliate_program_refs=[]},QuizMorsel:function(){this.title="Quiz";this.key=a.getNewKey();
this.model="ImageFormQuiz";this.inherit_read_permissions=!1;this.widgets=[];this.evaluator=new a.FormQuizEvaluator;this.affiliate_program_refs=[]},RadioButtonWidget:function(){this.model="RadioButtonWidget";this.placement={x:0,y:0,width:0,height:0};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value=!1;this.group="none"},CheckboxWidget:function(){this.model="CheckboxWidget";this.placement={x:0,y:0,width:0,height:0};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value=
!1},NumericInputWidget:function(){this.model="NumericInputWidget";this.placement={x:0,y:0,width:0.15,height:0.06};this.tabindex=0;this.label="Empty";this.marker="none"},TextInputWidget:function(){this.model="TextInputWidget";this.placement={x:0,y:0,width:0.15,height:0.06};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value="";this.text_area=!1},ProgrammingMorsel:function(){this.title="Program";this.key=a.getNewKey();this.model="ProgrammingQuiz";this.inherit_read_permissions=!1;
this.initial_code_files=[new a.FileAttachement];this.evaluator=new a.ProgramEvaluator;this.affiliate_program_refs=[]},ExerciseNode:function(){this.title="Exercise";this.key=a.getNewKey();this.model="Exercise";this.inherit_read_permissions=!1;this.answer_ref=this.quiz_ref=this.lecture_ref=void 0;this.affiliate_program_refs=[]},ProgramEvaluator:function(){this.model="ProgramEvaluator";this.requires_gpu=!1;this.deadline_seconds=10;this.execution_language="python";this.legacy_template_refs=[];this.gae_grading_code=
this.executor_test_code=""},CodeGradedEvaluator:function(){this.model="CodeGradedEvaluator";this.requires_gpu=!1;this.deadline_seconds=10;this.execution_language="python";this.legacy_template_refs=[];this.gae_grading_code=this.executor_test_code="";this.markers=[]},IFrameEvaluator:function(){this.model="IFrameEvaluator";this.external_uri=this.js_application=this.html_body=this.gae_grading_code=""},FormQuizEvaluator:function(){this.model="FormQuizEvaluator";this.answer_sets=[new a.WidgetGroupEvaluator]},
WidgetGroupEvaluator:function(){this.model="WidgetGroupEvaluator";this.widget_graders=[];this.evaluation_matched_comment="Good job!";this.is_correct=!0},SelectionEvaluator:function(){this.model="SelectionEvaluator";this.marker="";this.answer=!1},NumericalEvaluator:function(){this.model="NumericalEvaluator";this.marker="";this.upper_bound=this.lower_bound=0},RegexEvaluator:function(){this.model="RegexEvaluator";this.answer=this.marker=""},FileAttachement:function(){this.name="exercise.py";this.text=
"";this.blob_key=void 0}};return a}).factory("audio",["mixin",function(a){var b={sampleRate:44100,bufferSize:1024,waveformScale:1,recording:!1,ready:!1,buffer:void 0,stream:void 0,error:void 0,context:void 0,inputSource:void 0,recordProcessor:void 0,playProcessor:void 0,initialize:function(){navigator.webkitGetUserMedia&&(b.resetBuffers(),navigator.webkitGetUserMedia({audio:!0},function(a){b.stream=a;b.context=new window.webkitAudioContext;b.inputSource=b.context.createMediaStreamSource(b.stream);
b.recordProcessor=b.context.createScriptProcessor(b.bufferSize,2,2);b.recordProcessor.onaudioprocess=b.recordDataHandler;b.playProcessor=b.context.createScriptProcessor(b.bufferSize,0,2);b.playProcessor.onaudioprocess=b.playDataHandler;b.ready=!0},function(){b.error="Unable to initialize audio input"}))},startRecording:function(){if(!this.ready)return!1;b.resetBuffers();b.inputSource.connect(b.recordProcessor);b.recordProcessor.connect(b.context.destination);b.recording=!0;b.playIndex=0;return!0},
stopRecording:function(){b.recording=!1;b.inputSource.disconnect();b.recordProcessor.disconnect();b.createWaveform()},play:function(){b.playIndex>b.buffer.left.length&&(b.playIndex=0);!b.recording&&0<b.buffer.left.length&&b.playProcessor.connect(b.context.destination)},stop:function(){b.playProcessor.disconnect()},seek:function(a){0>a&&(a=0);b.playIndex=a>=b.duration()?b.buffer.left.length+1:b.bufferIndexFromTime(a)},resetBuffers:function(){b.buffer={left:[],right:[]};b.waveform=void 0},playIndex:0,
playDataHandler:function(a){var d=a.outputBuffer.getChannelData(0),a=a.outputBuffer.getChannelData(1);b.playIndex===b.buffer.left.length?(d.set(new Float32Array(b.bufferSize)),a.set(new Float32Array(b.bufferSize)),b.playIndex++):b.playIndex>b.buffer.left.length?(b.playProcessor.disconnect(),b.emitEvent("end")):(d.set(b.buffer.left[b.playIndex]),a.set(b.buffer.right[b.playIndex]),b.playIndex++,0===b.playIndex%1&&b.emitEvent("bufferRead"))},recordDataHandler:function(a){b.recording&&(a.inputBuffer.getChannelData(0),
a.inputBuffer.getChannelData(1),b.buffer.left=b.buffer.left.concat(new Float32Array(a.inputBuffer.getChannelData(0))),b.buffer.right=b.buffer.right.concat(new Float32Array(a.inputBuffer.getChannelData(1))),b.playIndex++,0===b.playIndex%5&&(b.createWaveform(),b.emitEvent("bufferRead")))},cut:function(a){for(var d=[],e=[],f=b.bufferIndexFromTime(a.inpoint),g=b.bufferIndexFromTime(a.outpoint),h=0;h<b.buffer.left.length;h++)if(h<f||h>g)d.push(b.buffer.left[h]),e.push(b.buffer.right[h]);b.buffer.left=
d;b.buffer.right=e;b.seek(a.inpoint);b.waveform=void 0;b.createWaveform(!0)},duration:function(){return 0===b.buffer.left.length?0:((b.buffer.left.length-1)*b.bufferSize+b.buffer.left[b.buffer.left.length-1].length)/b.sampleRate},timeFromWaveformIndex:function(a){return b.timeFromBufferIndex(a*b.waveformScale)},timeFromBufferIndex:function(a){return a*b.bufferSize/b.sampleRate},waveformIndexFromTime:function(a){return Math.floor(b.bufferIndexFromTime(a)/b.waveformScale)},bufferIndexFromTime:function(a){return Math.floor(a*
b.sampleRate/b.bufferSize)},currentTime:function(){return b.recording?b.duration():b.timeFromBufferIndex(b.playIndex)},waveformCurrentIndex:function(){return Math.floor(b.playIndex/b.waveformScale)},createWaveform:function(a){b.waveform||(b.bufferMeans=[],b.waveform=[],b.max=1E-10,b.waveformBuildIndex=0,b.waveformSampleIndex=0);if(a||635<b.waveform.length)b.waveform=[],b.waveformSampleIndex=0,b.waveformScale=Math.max(1,b.buffer.left.length/640);b.recording||(b.waveform=[],b.waveformSampleIndex=0);
for(;b.waveformBuildIndex<b.buffer.left.length;){for(var d=a=0;d<b.buffer.left[b.waveformBuildIndex].length;d++)a+=Math.abs(b.buffer.left[b.waveformBuildIndex][d]);a/=b.buffer.left[b.waveformBuildIndex].length;a>b.max&&(b.max=a);b.bufferMeans.push(a);b.waveformBuildIndex++}for(a=b.bufferMeans.length/b.waveformScale;b.waveformSampleIndex<a;)b.waveform.push(b.bufferMeans[Math.floor(b.waveformSampleIndex*b.waveformScale)]/b.max),b.waveformSampleIndex++}};b.initialize();a.eventEmission(b,["bufferRead",
"end"]);return b}]);angular.module("youtube").run(function(){var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}).service("youtubeVideoPlayer",["mixin","user",function(a,b){var c={},d=null,e=b.getUserProp("sitePreferences"),f=e?e.playbackRate:1,g=e?e.videoQuality:"default",h=e?e.useHtml5Player:!0,j={small:0,medium:1,large:2,hd720:3,hd1080:4,highres:5};window.onYouTubeIframeAPIReady=function(){c.attach=function(a,
b,e){if(!_.isElement(a))throw"Must attach youtube player to a DOM element!";d&&(d=null);b={height:"523",width:"930",videoId:b,playerVars:{autoplay:e.autoPlay||0,color:"red",rel:0,showinfo:0,fs:1,theme:"light",wmode:"opaque"},events:{onReady:function(){c.emitEvent("ready");c.setPlaybackRate(f);c.setPlaybackQuality(g)},onPlaybackRateChange:function(a){f=a.data;c.emitEvent("playbackRateChange",a.data)},onPlaybackQualityChange:function(a){var b=d.getAvailableQualityLevels();j[a.data]>j[g]?g=a.data:j[a.data]<
j[b[0]]&&(g=a.data);c.emitEvent("playbackQualityChange",a.data)},onStateChange:function(a){a.data===YT.PlayerState.ENDED?c.emitEvent("videoEnd"):a.data===YT.PlayerState.PAUSED?c.emitEvent("videoPause",Math.floor(d.getCurrentTime())):a.data===YT.PlayerState.PLAYING&&c.emitEvent("videoPlay",Math.floor(d.getCurrentTime()))}}};h&&(b.playerVars.html5=1);d=new YT.Player(a,b)};c.emitEvent("apiReady")};c.getAvailablePlaybackRates=function(){return d.getAvailablePlaybackRates()};c.getCurrentPlaybackRate=function(){return d&&
d.getPlaybackRate?d.getPlaybackRate():f};c.setPlaybackRate=function(a){f=a;d.setPlaybackRate(a)};c.setPlaybackQuality=function(a){f=a;d.setPlaybackQuality(a)};c.playVideo=function(){d&&d.playVideo?d.playVideo():console.error("The video player isn't ready or there is no video player on this page!")};c.pauseVideo=function(){d&&d.pauseVideo&&(d.pauseVideo(),c.emitEvent("videoPause",Math.floor(d.getCurrentTime())))};c.stopVideo=function(){d.stopVideo()};c.destroyVideo=function(){d.stopVideo();d.destroy()};
c.loadVideo=function(a,b,e){d.loadVideoById?(d.loadVideoById(a,b||0,e||g),c.setPlaybackRate(f),c.setPlaybackQuality(g)):c.addEventListener("ready",function(){d.loadVideoById(a,b||0,e||g)},{removeAfterFired:!0})};c.getCurrentTime=function(){return d&&d.getCurrentTime?Math.floor(d.getCurrentTime()):null};return a.eventEmission(c,"apiReady ready videoEnd videoPlay videoPause playbackRateChange playbackQualityChange".split(" "))}]);angular.module("services.utility").factory("$utils",[function(){return{mergeObject:function(){var a={},b=arguments,c=b.length,d;for(d=0;d<c;d+=1)_.extend(a,b[d],!0);return a}}}]);angular.module("services.utility").factory("urlParams",function(){return{getUrlQueryParams:UY.getUrlQueryParams,getDecodedURIComponent:UY.getDecodedURIComponent}});angular.module("services.utility").factory("techDetect",["mixin",function(a){var b,c,d=function(){c={browser:null,version:null,browserDim:null,cookies:null,flash:null,os:null,screenDim:null,screenColorDepth:null,ua:navigator.userAgent||"unspecified UA",lang:navigator.language||"unspecified language"}};d();var e=function(a){for(var c=0;c<a.length;c++){var d=a[c].string,e=a[c].prop;b=a[c].versionSearch||a[c].identity;if(d){if(-1!==d.indexOf(a[c].subString))return a[c].identity}else if(e)return a[c].identity}},
f=function(a){var c=a.indexOf(b);if(-1!==c)return parseFloat(a.substring(c+b.length+1))},g=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.userAgent,subString:"Safari",identity:"Safari",versionSearch:"Version"},{prop:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),identity:"UIWebView",versionSearch:"OS"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},
{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,
subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],h=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"iPod",identity:"iOS"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],j=function(a){if(null===c.browser||a)c.browser=e(g)||"An unknown browser";
return c.browser},l=function(a){if(null===c.version||a)c.version=f(navigator.userAgent)||f(navigator.appVersion)||"an unknown version";return c.version},k=function(a){if(null===c.os||a)c.os=e(h)||"an unknown OS";return c.os},m=function(a){if(null===c.cookies||a)document.cookie="cookietest=1",c.cookies=-1!==document.cookie.indexOf("cookietest="),document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";return c.cookies},n=function(a){if(null===c.flash||a)try{c.flash=!!(navigator.mimeTypes["application/x-shockwave-flash"]||
window.ActiveXObject&&new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(b){c.flash=!1}return c.flash},s=function(a){if(null===c.browserDim||a)c.browserDim=[$(window).width(),$(window).height()];return c.browserDim},p=function(a){if(null===c.screenDim||a)c.screenDim=[screen.width,screen.height];return c.screenDim},r=function(a){if(null===c.screenColorDepth||a)c.screenColorDepth=screen.colorDepth;return c.screenColorDepth};return a.eventEmission({browserSize:s,browserType:j,browserVersion:l,
cookiesEnabled:m,flashEnabled:n,os:k,screenSize:p,screenColorDepth:r,ua:function(){return c.ua},language:function(){return c.lang},flushCache:d,browserStats:function(a){return{browser:j(a),version:l(a),os:k(a)}},getAllTech:function(a){a=!!a;j(a);l(a);k(a);m(a);n(a);s(a);p(a);r(a);return c}},["browserDetected"])}]);angular.module("services.utility").factory("api",["$http",function(a){var b={get:function(c,d,e){var f=(new Date).getTime();return b.timeRequest(a.get("/api"+c,d,e),f)},post:function(c,d,e){var f=(new Date).getTime();return b.timeRequest(a.post("/api"+c,d,e),f)},deleteRequest:function(c,d,e){var f=(new Date).getTime();return b.timeRequest(a["delete"]("/api"+c,d,e),f)},timeRequest:function(a,b){return a.success(function(a,c,g){a=g("X-Udacity-Trail");c=(new Date).getTime()-b;g=window.location.pathname+
window.location.hash;0<=c&&36E5>c&&_gaq&&_gaq.push(["_trackTiming",a,"request",c,g])})}};return b}]);angular.module("services.utility").factory("$cookieJar",["$utils",function(a){var b=function(a,b,c,g){a=encodeURIComponent(a)+"="+(c?encodeURIComponent(b):b);angular.isObject(g)&&(angular.isDate(g.expires)&&(a+="; expires="+g.expires.toUTCString()),angular.isString(g.path)&&""!==g.path&&(a+="; path="+g.path),angular.isString(g.domain)&&""!==g.domain&&(a+="; domain="+g.domain),!0===g.secure&&(a+="; secure"));return a},c=function(a,b){var c={};if(angular.isString(a)&&0<a.length)for(var g=a.split(/;\s/g),
h=null,j=null,l=null,k=0,m=g.length;k<m;k++){l=g[k].match(/([^=]+)=/i);if(angular.isArray(l))try{h=decodeURIComponent(l[1]),j=!1===b?g[k].substring(l[1].length+1):decodeURIComponent(g[k].substring(l[1].length+1))}catch(n){}else h=decodeURIComponent(g[k]),j="";c[h]=j}return c};return{exists:function(a){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.exists(): Cookie name must be a non-empty string.");return c(document.cookie,!0).hasOwnProperty(a)},get:function(a,b){var b=angular.isObject(b)?
b:{},f=c(document.cookie,!b.raw);if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.get(): Cookie name must be a non-empty string.");return angular.isUndefined(f[a])?null:angular.isFunction(b.converter)?b.converter(f[a]):f[a]},getSub:function(a,b,c){a=this.getSubs(a);if(null!==a){if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.getSub(): Subcookie name must be a non-empty string.");return angular.isUndefined(a[b])?null:angular.isFunction(c)?c(a[b]):a[b]}return null},getSubs:function(a){if(!angular.isString(a)||
""===a)throw new TypeError("$cookieJar.getSubs(): Cookie name must be a non-empty string.");var b=c(document.cookie,!1);if(angular.isString(b[a])){var f=b[a],a=f.split("&"),b=null,g={};if(0<f.length)for(var f=0,h=a.length;f<h;f++)b=a[f].split("="),g[decodeURIComponent(b[0])]=decodeURIComponent(b[1]);return g}return null},remove:function(b,c){if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.remove(): Cookie name must be a non-empty string.");c=a.mergeObject(c||{},{expires:new Date(0)});
return this.set(b,"",c)},removeSub:function(a,b,c){c=c||{};if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.removeSub(): Cookie name must be a non-empty string.");if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.removeSub(): Subcookie name must be a non-empty string.");var g=this.getSubs(a);if(angular.isObject(g)&&g.hasOwnProperty(b)){delete g[b];if(c.removeIfEmpty){for(var h in g)if(g.hasOwnProperty(h)&&!angular.isFunction(g[h])&&!angular.isUndefined(g[h]))return this.setSubs(a,
g,c);return this.remove(a,c)}return this.setSubs(a,g,c)}return""},set:function(a,c,f){f=f||{};if(!angular.isString(a))throw new TypeError("$cookieJar.set(): Cookie name must be a string.");if(angular.isUndefined(c))throw new TypeError("$cookieJar.set(): Value cannot be undefined.");a=b(a,c,!f.raw,f);return document.cookie=a},setSub:function(a,b,c,g){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.setSub(): Cookie name must be a non-empty string.");if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.setSub(): Subcookie name must be a non-empty string.");
if(angular.isUndefined(c))throw new TypeError("$cookieJar.setSub(): Subcookie value cannot be undefined.");var h=this.getSubs(a),h=angular.isObject(h)?h:{};h[b]=c;return this.setSubs(a,h,g)},setSubs:function(a,c,f){if(!angular.isString(a))throw new TypeError("$cookieJar.setSubs(): Cookie name must be a string.");if(!angular.isObject(c))throw new TypeError("$cookieJar.setSubs(): Cookie value must be an object.");if(!angular.isObject(c))throw new TypeError("createCookieHashString(): Argument must be an object.");
var g=[],h;for(h in c)c.hasOwnProperty(h)&&(!angular.isFunction(c[h])&&!angular.isUndefined(c[h]))&&g.push(encodeURIComponent(h)+"="+encodeURIComponent(String(c[h])));c=g.join("&");a=b(a,c,!1,f);return document.cookie=a}}}]);angular.module("services.utility").factory("dateTime",["$filter",function(a){return{getCurrentAsUTC:function(){var b=new Date,b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds());return a("date")(b,"yyyy-MM-ddTHH:mm:ss.000")+"Z"}}}]);angular.module("services.utility").factory("isTrustedDomain",[function(){return function(a){return"https://www.udacity.com"===a||"http://localhost:8080"===a||"http://localhost:8087"===a||"https://assignments-dot-udacity-extras.appspot.com"===a}}]);(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)})(function(a){var b=0;a.ajaxTransport("iframe",function(c){if(c.async&&("POST"===c.type||"GET"===c.type)){var d,e;return{send:function(f,g){d=a('<form style="display:none;"></form>');d.attr("accept-charset",c.formAcceptCharset);e=a('<iframe src="javascript:false;" name="iframe-transport-'+(b+=1)+'"></iframe>').bind("load",function(){var b,f=a.isArray(c.paramName)?c.paramName:[c.paramName];e.unbind("load").bind("load",
function(){var b;try{if(b=e.contents(),!b.length||!b[0].firstChild)throw Error();}catch(c){b=void 0}g(200,"success",{iframe:b});a('<iframe src="javascript:false;"></iframe>').appendTo(d);d.remove()});d.prop("target",e.prop("name")).prop("action",c.url).prop("method",c.type);c.formData&&a.each(c.formData,function(b,c){a('<input type="hidden"/>').prop("name",c.name).val(c.value).appendTo(d)});c.fileInput&&(c.fileInput.length&&"POST"===c.type)&&(b=c.fileInput.clone(),c.fileInput.after(function(a){return b[a]}),
c.paramName&&c.fileInput.each(function(b){a(this).prop("name",f[b]||c.paramName)}),d.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"));d.submit();b&&b.length&&c.fileInput.each(function(c,d){var e=a(b[c]);a(d).prop("name",e.prop("name"));e.replaceWith(d)})});d.append(e).appendTo(document.body)},abort:function(){e&&e.unbind("load").prop("src","javascript".concat(":false;"));d&&d.remove()}}}});a.ajaxSetup({converters:{"iframe text":function(b){return b&&
a(b[0].body).text()},"iframe json":function(b){var d=/^\s*(\[|\{[^\{])/,e=/[\}\]]\s*$/,f=/^\)\]\}',?\n/,b=b&&a(b[0].body).text();"string"===typeof b&&(b=b.replace(f,""),d.test(b)&&e.test(b)&&(b="string"===typeof b?JSON.parse(b):b));return b},"iframe html":function(b){return b&&a(b[0].body).html()},"iframe script":function(b){return b&&a.globalEval(a(b[0].body).text())}}})});
(function(a){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],a):a(window.jQuery)})(function(a){a.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader);a.support.xhrFormDataFileUpload=!!window.FormData;a.widget("blueimp.fileupload",{options:{dropZone:a(document),pasteZone:a(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,
redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(a){return a.serializeArray()},add:function(a,c){c.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.bitrate=this.loaded=0;this.getBitrate=function(a,c,d){var e=
a-this.timestamp;if(!this.bitrate||!d||e>d)this.bitrate=8*(c-this.loaded)*(1E3/e),this.loaded=c,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(b){return!b.forceIframeTransport&&(!b.multipart&&a.support.xhrFileUpload||a.support.xhrFormDataFileUpload)},_getFormData:function(b){var c;return"function"===typeof b.formData?b.formData(b.form):a.isArray(b.formData)?b.formData:b.formData?(c=[],a.each(b.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(b){var c=0;a.each(b,
function(a,b){c+=b.size||1});return c},_onProgress:function(a,c){if(a.lengthComputable){var d=+new Date,e,f;if(!c._time||!c.progressInterval||!(d-c._time<c.progressInterval&&a.loaded!==a.total))c._time=d,e=c.total||this._getTotal(c.files),f=parseInt(a.loaded/a.total*(c.chunkSize||e),10)+(c.uploadedBytes||0),this._loaded+=f-(c.loaded||c.uploadedBytes||0),c.lengthComputable=!0,c.loaded=f,c.total=e,c.bitrate=c._bitrateTimer.getBitrate(d,f,c.bitrateInterval),this._trigger("progress",a,c),this._trigger("progressall",
a,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(d,this._loaded,c.bitrateInterval)})}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();d.upload&&(a(d.upload).bind("progress",function(a){var d=a.originalEvent;a.lengthComputable=d.lengthComputable;a.loaded=d.loaded;a.total=d.total;c._onProgress(a,b)}),b.xhr=function(){return d})},_initXHRData:function(b){var c,d=b.files[0],e=b.multipart||!a.support.xhrFileUpload,f=b.paramName[0];
b.headers=b.headers||{};b.contentRange&&(b.headers["Content-Range"]=b.contentRange);e?a.support.xhrFormDataFileUpload&&(b.postMessage?(c=this._getFormData(b),b.blob?c.push({name:f,value:b.blob}):a.each(b.files,function(a,d){c.push({name:b.paramName[a]||f,value:d})})):(b.formData instanceof FormData?c=b.formData:(c=new FormData,a.each(this._getFormData(b),function(a,b){c.append(b.name,b.value)})),b.blob?(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"',c.append(f,b.blob,
d.name)):a.each(b.files,function(a,d){if(window.Blob&&d instanceof Blob||window.File&&d instanceof File)c.append(b.paramName[a]||f,d,d.name)})),b.data=c):(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"',b.contentType=d.type,b.data=b.blob||d);b.blob=null},_initIframeSettings:function(b){b.dataType="iframe "+(b.dataType||"");b.formData=this._getFormData(b);b.redirect&&a("<a></a>").prop("href",b.url).prop("host")!==location.host&&b.formData.push({name:b.redirectParamName||
"redirect",value:b.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a,"iframe")},_getParamName:function(b){var c=a(b.fileInput),d=b.paramName;d?a.isArray(d)||(d=[d]):(d=[],c.each(function(){for(var b=a(this),c=b.prop("name")||"files[]",b=(b.prop("files")||[1]).length;b;)d.push(c),b-=1}),d.length||(d=[c.prop("name")||
"files[]"]));return d},_initFormSettings:function(b){if(!b.form||!b.form.length)b.form=a(b.fileInput.prop("form")),b.form.length||(b.form=a(this.options.fileInput.prop("form")));b.paramName=this._getParamName(b);b.url||(b.url=b.form.prop("action")||location.href);b.type=(b.type||b.form.prop("method")||"").toUpperCase();"POST"!==b.type&&"PUT"!==b.type&&(b.type="POST");b.formAcceptCharset||(b.formAcceptCharset=b.form.attr("accept-charset"))},_getAJAXSettings:function(b){b=a.extend({},this.options,b);
this._initFormSettings(b);this._initDataSettings(b);return b},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(b,c,d){var e=a.Deferred(),f=e.promise(),c=c||this.options.context||f;!0===b?e.resolveWith(c,d):!1===b&&e.rejectWith(c,d);f.abort=e.promise;return this._enhancePromise(f)},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(b,
c){var d=this,e=b.files[0],f=e.size,g=b.uploadedBytes=b.uploadedBytes||0,h=b.maxChunkSize||f,j=e.slice||e.webkitSlice||e.mozSlice,l=a.Deferred(),k=l.promise(),m,n;if(!this._isXHRUpload(b)||(!j||!(g||h<f))||b.data)return!1;if(c)return!0;if(g>=f)return e.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,b.context,[null,"error",e.error]);n=function(){var c=a.extend({},b);c.blob=j.call(e,g,g+h,e.type);c.chunkSize=c.blob.size;c.contentRange="bytes "+g+"-"+(g+c.chunkSize-1)+"/"+f;d._initXHRData(c);
d._initProgressListener(c);m=(a.ajax(c)||d._getXHRPromise(!1,c.context)).done(function(e,h,j){g=d._getUploadedBytes(j)||g+c.chunkSize;c.loaded||d._onProgress(a.Event("progress",{lengthComputable:!0,loaded:g-c.uploadedBytes,total:g-c.uploadedBytes}),c);b.uploadedBytes=c.uploadedBytes=g;g<f?n():l.resolveWith(c.context,[e,h,j])}).fail(function(a,b,d){l.rejectWith(c.context,[a,b,d])})};this._enhancePromise(k);k.abort=function(){return m.abort()};n();return k},_beforeSend:function(a,c){0===this._active&&
(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer);this._active+=1;this._loaded+=c.uploadedBytes||0;this._total+=this._getTotal(c.files)},_onDone:function(b,c,d,e){this._isXHRUpload(e)||this._onProgress(a.Event("progress",{lengthComputable:!0,loaded:1,total:1}),e);e.result=b;e.textStatus=c;e.jqXHR=d;this._trigger("done",null,e)},_onFail:function(a,c,d,e){e.jqXHR=a;e.textStatus=c;e.errorThrown=d;this._trigger("fail",null,e);e.recalculateProgress&&(this._loaded-=e.loaded||e.uploadedBytes||
0,this._total-=e.total||this._getTotal(e.files))},_onAlways:function(a,c,d,e){this._active-=1;e.textStatus=c;d&&d.always?(e.jqXHR=d,e.result=a):(e.jqXHR=a,e.errorThrown=d);this._trigger("always",null,e);0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(b,c){var d=this,e,f,g,h,j=d._getAJAXSettings(c),l=function(){d._sending+=1;j._bitrateTimer=new d._BitrateTimer;return e=e||((f||!1===d._trigger("send",b,j))&&d._getXHRPromise(!1,j.context,
f)||d._chunkedUpload(j)||a.ajax(j)).done(function(a,b,c){d._onDone(a,b,c,j)}).fail(function(a,b,c){d._onFail(a,b,c,j)}).always(function(a,b,c){d._sending-=1;d._onAlways(a,b,c,j);if(j.limitConcurrentUploads&&j.limitConcurrentUploads>d._sending)for(a=d._slots.shift();a;){if(b=a.state?"pending"===a.state():!a.isRejected()){a.resolve();break}a=d._slots.shift()}})};this._beforeSend(b,j);return this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?
(1<this.options.limitConcurrentUploads?(g=a.Deferred(),this._slots.push(g),h=g.pipe(l)):h=this._sequence=this._sequence.pipe(l,l),h.abort=function(){f=[void 0,"abort","abort"];return!e?(g&&g.rejectWith(j.context,f),l()):e.abort()},this._enhancePromise(h)):l()},_onAdd:function(b,c){var d=this,e=!0,f=a.extend({},this.options,c),g=f.limitMultiFileUploads,h=this._getParamName(f),j,l,k;if(!f.singleFileUploads&&!g||!this._isXHRUpload(f))l=[c.files],j=[h];else if(!f.singleFileUploads&&g){l=[];j=[];for(k=
0;k<c.files.length;k+=g)l.push(c.files.slice(k,k+g)),f=h.slice(k,k+g),f.length||(f=h),j.push(f)}else j=h;c.originalFiles=c.files;a.each(l||c.files,function(f,g){var h=a.extend({},c);h.files=l?g:[g];h.paramName=j[f];h.submit=function(){return h.jqXHR=this.jqXHR=!1!==d._trigger("submit",b,this)&&d._onSend(b,this)};return e=d._trigger("add",b,h)});return e},_replaceFileInput:function(b){var c=b.clone(!0);a("<form></form>").append(c)[0].reset();b.after(c).detach();a.cleanData(b.unbind("remove"));this.options.fileInput=
this.options.fileInput.map(function(a,e){return e===b[0]?c[0]:e});b[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(b,c){var d=this,e=a.Deferred(),f=function(a){a&&!a.entry&&(a.entry=b);e.resolve([a])},g,c=c||"";b.isFile?b._file?(b._file.relativePath=c,e.resolve(b._file)):b.file(function(a){a.relativePath=c;e.resolve(a)},f):b.isDirectory?(g=b.createReader(),g.readEntries(function(a){d._handleFileTreeEntries(a,c+b.name+"/").done(function(a){e.resolve(a)}).fail(f)},f)):e.resolve([]);
return e.promise()},_handleFileTreeEntries:function(b,c){var d=this;return a.when.apply(a,a.map(b,function(a){return d._handleFileTreeEntry(a,c)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(b){var b=b||{},c=b.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(a.map(c,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):a.Deferred().resolve(a.makeArray(b.files)).promise()},
_getSingleFileInputFiles:function(b){var b=a(b),c=b.prop("webkitEntries")||b.prop("entries");if(c&&c.length)return this._handleFileTreeEntries(c);c=a.makeArray(b.prop("files"));if(c.length)void 0===c[0].name&&c[0].fileName&&a.each(c,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{b=b.prop("value");if(!b)return a.Deferred().resolve([]).promise();c=[{name:b.replace(/^.*\\/,"")}]}return a.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){return!(b instanceof a)||1===b.length?this._getSingleFileInputFiles(b):
a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(b){var c=this,d={fileInput:a(b.target),form:a(b.target.form)};this._getFileInputFiles(d.fileInput).always(function(a){d.files=a;c.options.replaceFileInput&&c._replaceFileInput(d.fileInput);!1!==c._trigger("change",b,d)&&c._onAdd(b,d)})},_onPaste:function(b){var c=b.originalEvent.clipboardData,d={files:[]};a.each(c&&c.items||[],function(a,b){var c=b.getAsFile&&
b.getAsFile();c&&d.files.push(c)});if(!1===this._trigger("paste",b,d)||!1===this._onAdd(b,d))return!1},_onDrop:function(a){var c=this,d=a.dataTransfer=a.originalEvent.dataTransfer,e={};d&&(d.files&&d.files.length)&&a.preventDefault();this._getDroppedFiles(d).always(function(d){e.files=d;!1!==c._trigger("drop",a,e)&&c._onAdd(a,e)})},_onDragOver:function(b){var c=b.dataTransfer=b.originalEvent.dataTransfer;if(!1===this._trigger("dragover",b))return!1;c&&-1!==a.inArray("Files",c.types)&&(c.dropEffect=
"copy",b.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(b,c){var d=-1!==a.inArray(b,this._refreshOptionsList);
d&&this._destroyEventHandlers();this._super(b,c);d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var b=this.options;void 0===b.fileInput?b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):b.fileInput instanceof a||(b.fileInput=a(b.fileInput));b.dropZone instanceof a||(b.dropZone=a(b.dropZone));b.pasteZone instanceof a||(b.pasteZone=a(b.pasteZone))},_create:function(){a.extend(this.options,a(this.element[0].cloneNode(!1)).data());
this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(b){var c=this;b&&!this.options.disabled&&(b.fileInput&&!b.files?this._getFileInputFiles(b.fileInput).always(function(a){b.files=a;c._onAdd(null,b)}):(b.files=a.makeArray(b.files),this._onAdd(null,b)))},send:function(b){if(b&&!this.options.disabled){if(b.fileInput&&!b.files){var c=
this,d=a.Deferred(),e=d.promise(),f,g;e.abort=function(){g=!0;if(f)return f.abort();d.reject(null,"abort","abort");return e};this._getFileInputFiles(b.fileInput).always(function(a){g||(b.files=a,f=c._onSend(null,b).then(function(a,b,c){d.resolve(a,b,c)},function(a,b,c){d.reject(a,b,c)}))});return this._enhancePromise(e)}b.files=a.makeArray(b.files);if(b.files.length)return this._onSend(null,b)}return this._getXHRPromise(!1,b&&b.context)}})});window.UYSocial={};
(function(a){var b={client_id:"620121594665.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"};a.runWhenReadyFacebook=function(b){a.facebookLoaded?b():(a.facebookLoadedCallbacks=a.facebookLoadedCallbacks||[],a.facebookLoadedCallbacks.push(b))};a.runWhenReadyTwitter=function(b){a.twitterLoaded?b():(a.twitterLoadedCallbacks=a.twitterLoadedCallbacks||[],a.twitterLoadedCallbacks.push(b))};a.runWhenReadyGoogle=function(b){a.googleLoaded?
b():(a.googleLoadedCallbacks=a.googleLoadedCallbacks||[],a.googleLoadedCallbacks.push(b))};a.getFacebookAuthResponse=function(b){a.runWhenReadyFacebook(function(){var a=window.FB.getAuthResponse();a?b(a):window.FB.login(function(a){a.authResponse&&b(a.authResponse)},{scope:"email"})})};a.getFacebookMeResponse=function(b){a.runWhenReadyFacebook(function(){window.FB.getLoginStatus(function(){window.FB.api("/me",function(a){b(a)})})})};a.getGoogleToken=function(c,e){a.runWhenReadyGoogle(function(){window.gapi.auth.authorize($.extend({response_type:"code",
immediate:c},b),function(a){a.code&&e(a)})})};a.getGoogleMeResponse=function(c){a.runWhenReadyGoogle(function(){window.gapi.auth.authorize($.extend({immediate:!0},b),function(){window.gapi.client.load("oauth2","v2",function(){window.gapi.client.oauth2.userinfo.get().execute(function(a){c(a)})})})})};var c=function(){if(a.googlePlusoneLoaded&&a.googleAuthLoaded&&(a.googleLoaded=!0,a.googleLoadedCallbacks))for(var b=0;b<a.googleLoadedCallbacks.length;b++)a.googleLoadedCallbacks[b]()};setTimeout(function(){if(!a.facebookLoaded){$("body").append('<div id="fb-root"></div>');
window.fbAsyncInit=function(){window.FB.init({appId:365362206864879,channelUrl:"//"+window.location.host+"/facebookChannel.html",status:!0,cookie:!0,xfbml:!0});a.facebookLoaded=!0;if(a.facebookLoadedCallbacks)for(var b=0;b<a.facebookLoadedCallbacks.length;b++)a.facebookLoadedCallbacks[b]()};var b,c=document.getElementsByTagName("script")[0];document.getElementById("facebook-jssdk")||(b=document.createElement("script"),b.id="facebook-jssdk",b.async=!0,b.src="//connect.facebook.net/en_US/all.js",c.parentNode.insertBefore(b,
c))}},200);setTimeout(function(){a.twitterLoaded||UY.getScriptCached("//platform.twitter.com/widgets.js",function(){if(window.twttr&&(a.twitterLoaded=!0,a.twitterLoadedCallbacks))for(var b=0;b<a.twitterLoadedCallbacks.length;b++)a.twitterLoadedCallbacks[b]()})},200);setTimeout(function(){a.googlePlusoneLoaded||UY.getScriptCached("https://apis.google.com/js/plusone.js",function(){window.gapi&&window.gapi.plusone&&(a.googlePlusoneLoaded=!0,c())})},200);setTimeout(function(){!1!==window.initGoogleAuth&&
(window.initGoogleAuth=function(){window.gapi.auth.init(function(){window.initGoogleAuth=!1;a.googleAuthLoaded=!0;c()})},UY.getScriptCached("https://apis.google.com/js/client.js?onload=initGoogleAuth"))},200)})(window.UYSocial);function WavDecoder(){}
function WavEncoder(a){function b(a,b){for(var c=new Float32Array(b),d=0,e=0;e<a.length;e++)c.set(a[e],d),d+=a[e].length;return c}function c(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))}sampleRate=44100;var d=0;for(i in a.left)d+=a.left[i].length;for(var e=b(a.left,d),d=b(a.right,d),f=e.length+d.length,a=new Float32Array(f),g=0,h=0;g<f;)a[g++]=e[h],a[g++]=d[h],h++;e=new ArrayBuffer(44+2*a.length);e=new DataView(e);c(e,0,"RIFF");e.setUint32(4,32+2*a.length,!0);c(e,8,"WAVE");c(e,
12,"fmt ");e.setUint32(16,16,!0);e.setUint16(20,1,!0);e.setUint16(22,2,!0);e.setUint32(24,sampleRate,!0);e.setUint32(28,4*sampleRate,!0);e.setUint16(32,4,!0);e.setUint16(34,16,!0);c(e,36,"data");e.setUint32(40,2*a.length,!0);d=44;for(f=0;f<a.length;f++,d+=2)g=Math.max(-1,Math.min(1,a[f])),e.setInt16(d,0>g?32768*g:32767*g,!0);return new Blob([e],{type:"audio/wav"})};
